---
title: ggplotting power curves from simr package
author: ''
date: '2023-06-27'
slug: ggplotting-power-curves-from-simr-package
categories:
  - R
tags:
  - power analysis
  - statistical power
  - simr
  - research methods
  - visualisation
  - s
subtitle: ''
summary: ''
authors: []
featured: no
draft: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---



<p>The R package ‘simr’ has greatly facilitated power analysis for mixed-effects models using Monte Carlo simulation (i.e., hundreds or thousands of tests under slight variations of the data). The <code>powerCurve</code> function is used to estimate the statistical power for various sample sizes in one go. Since it runs serially, it can take a VERY long time to finish; approximately, the time it takes to run the model supplied once (say, a few hours) <em>times</em> the number of simulations (<code>nsim</code>, which should be higher than 200) <em>times</em> the number of different sample sizes examined. While there isn’t a built-in parallel method, the power curves for different sample size can be run separately, and the results can be combined (see <a href="/2021/parallelizing-simr-powercurve">tutorial</a>). The power curves produced by <code>simr</code> are so good they deserve ‘ggplot2’ rendering. So, here’s a function for it.</p>
<script src="https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2Fpablobernabeu%2FLanguage-and-vision-in-conceptual-processing-Multilevel-analysis-and-statistical-power%2Fblob%2Fmain%2FR_functions%2FpowercurvePlot.R&style=default&type=code&showBorder=on&showLineNumbers=on&showFileMeta=on&showFullPath=on&showCopy=on"></script>
<div id="a-usage-example" class="section level1">
<h1>A usage example</h1>
<pre class="r"><code>library(lme4)
library(simr)
library(ggplot2)

# Toy model with data from &#39;simr&#39; package
fit = lmer(y ~ x + (x | g), data = simdata)

# Extend sample size of `g`
fit_extended_g = extend(fit, along = &#39;g&#39;, n = 12)

fit_powercurve = 
  powerCurve(fit_extended_g, fixed(&#39;x&#39;), 
             along = &#39;g&#39;, breaks = c(4, 6, 8, 10, 12), 
             nsim = 50, seed = 123, progress = FALSE)

# Read in custom function to ggplot results from simr::powerCurve

source(&#39;https://raw.githubusercontent.com/pablobernabeu/powercurvePlot/main/powercurvePlot.R&#39;)

powercurvePlot(fit_powercurve, number_x_axis_levels = 6) +
  
  # Increase size of all text
  theme(plot.title = element_blank(),
        axis.title.x = element_text(size = 14), 
        axis.title.y = element_text(size = 14), 
        axis.text = element_text(size = 13))</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
