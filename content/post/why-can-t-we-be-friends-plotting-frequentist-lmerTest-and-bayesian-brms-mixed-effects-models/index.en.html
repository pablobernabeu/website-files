---
title: "Why can't we be friends? Plotting frequentist (lmerTest) and Bayesian (brms) mixed-effects models"
author: ''
date: '2022-12-23'
slug: why-can-t-we-be-friends-plotting-frequentist-lmerTest-and-bayesian-brms-mixed-effects-models
categories: 
  - R
  - statistics
tags: 
  - statistics
  - Bayesian statistics
  - frequentist statistics
  - linear-mixed effects models
  - lmerTest
  - lme4
  - brms
  - plotting
  - data visualisation
  - s
subtitle: ''
summary: 'Frequentist and Bayesian statistics are sometimes regarded as fundamentally different philosophies. Indeed, can both qualify as philosophies or is one of them just a pointless ritual? Is frequentist statistics only about $p$ values? Are frequentist estimates diametrically opposed to Bayesian posterior distributions? Are confidence intervals and credible intervals irreconcilable? Will R crash if lmerTest and brms are simultaneously loaded?'
authors: []
lastmod: 
featured: no
draft: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

<script src="{{< blogdown/postref >}}index.en_files/clipboard/clipboard.min.js"></script>
<link href="{{< blogdown/postref >}}index.en_files/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index.en_files/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>


<p>Frequentist and Bayesian statistics are sometimes regarded as fundamentally different philosophies. Indeed, can both methods qualify as philosophies, or is one of them just a pointless ritual? Is frequentist statistics about <span class="math inline">\(p\)</span> values only? Are frequentist estimates diametrically opposed to Bayesian posterior distributions? Are confidence intervals and credible intervals irreconcilable? Will R crash if <a href="https://cran.r-project.org/web/packages/lmerTest/lmerTest.pdf"><code>lmerTest</code></a> and <a href="https://cran.r-project.org/web/packages/brms/brms.pdf"><code>brms</code></a> are simultaneously loaded? If only we could fit frequentist and Bayesian models to the same data and plot the results together, we might get a glimpse into these puzzles.</p>
<p>All the analyses shown below can be reproduced using the materials at <a href="https://osf.io/gt5uf" class="uri">https://osf.io/gt5uf</a>. The combination of the frequentist and the Bayesian estimates in the same plot is achieved using the following custom function from <a href="/publication/pablo-bernabeu-2022-phd-thesis">Bernabeu (2022)</a>.</p>
<div id="visualising-frequentist-and-bayesian-estimates-in-one-plot" class="section level3">
<h3>Visualising frequentist and Bayesian estimates in one plot</h3>
<p>Both frequentist and Bayesian statistics offer the options of hypothesis testing and parameter estimation (Cumming, 2014; Kruschke &amp; Liddell, 2018; Rouder et al., 2018; Schmalz et al., 2022; Tendeiro &amp; Kiers, 2019, 2022; van Ravenzwaaij &amp; Wagenmakers, 2022). In the statistical analyses conducted by Bernabeu (2022), hypothesis testing was performed within the frequentist framework, whereas parameter estimation was performed within both the frequentist and the Bayesian frameworks (for other examples of the <em>estimation</em> approach, see Milek et al., 2018; Pregla et al., 2021; Rodríguez-Ferreiro et al., 2020).</p>
<script src="https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2Fpablobernabeu%2Flanguage-sensorimotor-simulation-PhD-thesis%2Fblob%2Fmain%2FR_functions%2Ffrequentist_bayesian_plot.R&style=a11y-dark&type=code&showBorder=off&showLineNumbers=on&showFileMeta=on&showFullPath=on&showCopy=on"></script>
<p><br></p>
<p>Let’s load the function from GitHub and put it to the test.</p>
<div style="height: 800px; border: 0.5px dotted grey; padding: 10px; resize: both; overflow: auto;">
<pre class="r"><code># Presenting the frequentist and the Bayesian estimates in the same plot. 
# For this purpose, the frequentist results are merged into a plot from 
# brms::mcmc_plot()

source(&#39;https://raw.githubusercontent.com/pablobernabeu/language-sensorimotor-simulation-PhD-thesis/main/R_functions/frequentist_bayesian_plot.R&#39;)

# install.packages(&#39;devtools&#39;)
# library(devtools)
# install_version(&#39;tidyverse&#39;, &#39;1.3.1&#39;)  # Due to breaking changes, Version 1.3.1 is required.
# install_version(&#39;ggplot2&#39;, &#39;5.3.5&#39;)  # Due to breaking changes, Version 5.3.5 is required.
library(tidyverse)
library(ggplot2)
library(Cairo)

# Load frequentist coefficients (estimates and confidence intervals)

KR_summary_semanticpriming_lmerTest =
  readRDS(gzcon(url(&#39;https://github.com/pablobernabeu/language-sensorimotor-simulation-PhD-thesis/blob/main/semanticpriming/frequentist_analysis/results/KR_summary_semanticpriming_lmerTest.rds?raw=true&#39;)))

confint_semanticpriming_lmerTest =
  readRDS(gzcon(url(&#39;https://github.com/pablobernabeu/language-sensorimotor-simulation-PhD-thesis/blob/main/semanticpriming/frequentist_analysis/results/confint_semanticpriming_lmerTest.rds?raw=true&#39;)))

# Below are the default names of the effects
# rownames(KR_summary_semanticpriming_lmerTest$coefficients)
# rownames(confint_semanticpriming_lmerTest)

# Load Bayesian posterior distributions

semanticpriming_posteriordistributions_weaklyinformativepriors_exgaussian = 
  readRDS(gzcon(url(&#39;https://github.com/pablobernabeu/language-sensorimotor-simulation-PhD-thesis/blob/main/semanticpriming/bayesian_analysis/results/semanticpriming_posteriordistributions_weaklyinformativepriors_exgaussian.rds?raw=true&#39;)))

# Below are the default names of the effects
# levels(semanticpriming_posteriordistributions_weaklyinformativepriors_exgaussian$data$parameter)


# Reorder the components of interactions in the frequentist results to match 
# with the order present in the Bayesian results.

rownames(KR_summary_semanticpriming_lmerTest$coefficients) =
  rownames(KR_summary_semanticpriming_lmerTest$coefficients) %&gt;%
  str_replace(pattern = &#39;z_recoded_interstimulus_interval:z_cosine_similarity&#39;, 
              replacement = &#39;z_cosine_similarity:z_recoded_interstimulus_interval&#39;) %&gt;%
  str_replace(pattern = &#39;z_recoded_interstimulus_interval:z_visual_rating_diff&#39;, 
              replacement = &#39;z_visual_rating_diff:z_recoded_interstimulus_interval&#39;)

rownames(confint_semanticpriming_lmerTest)  = 
  rownames(confint_semanticpriming_lmerTest) %&gt;%
  str_replace(pattern = &#39;z_recoded_interstimulus_interval:z_cosine_similarity&#39;, 
              replacement = &#39;z_cosine_similarity:z_recoded_interstimulus_interval&#39;) %&gt;%
  str_replace(pattern = &#39;z_recoded_interstimulus_interval:z_visual_rating_diff&#39;, 
              replacement = &#39;z_visual_rating_diff:z_recoded_interstimulus_interval&#39;)


# Create a vector containing the names of the effects. This vector will be passed 
# to the plotting function.

new_labels = 
  
  semanticpriming_posteriordistributions_weaklyinformativepriors_exgaussian$data$parameter %&gt;% 
  unique %&gt;%
  
  # Remove the default &#39;b_&#39; from the beginning of each effect
  str_remove(&#39;^b_&#39;) %&gt;%
  
  # Put Intercept in parentheses
  str_replace(pattern = &#39;Intercept&#39;, replacement = &#39;(Intercept)&#39;) %&gt;%
  
  # First, adjust names of variables (both in main effects and in interactions)
  str_replace(pattern = &#39;z_target_word_frequency&#39;,
              replacement = &#39;Target-word frequency&#39;) %&gt;%
  str_replace(pattern = &#39;z_target_number_syllables&#39;,
              replacement = &#39;Number of target-word syllables&#39;) %&gt;%
  str_replace(pattern = &#39;z_word_concreteness_diff&#39;,
              replacement = &#39;Word-concreteness difference&#39;) %&gt;%
  str_replace(pattern = &#39;z_cosine_similarity&#39;,
              replacement = &#39;Language-based similarity&#39;) %&gt;%
  str_replace(pattern = &#39;z_visual_rating_diff&#39;,
              replacement = &#39;Visual-strength difference&#39;) %&gt;%
  str_replace(pattern = &#39;z_attentional_control&#39;,
              replacement = &#39;Attentional control&#39;) %&gt;%
  str_replace(pattern = &#39;z_vocabulary_size&#39;,
              replacement = &#39;Vocabulary size&#39;) %&gt;%
  str_replace(pattern = &#39;z_recoded_participant_gender&#39;,
              replacement = &#39;Gender&#39;) %&gt;%
  str_replace(pattern = &#39;z_recoded_interstimulus_interval&#39;,
              replacement = &#39;SOA&#39;) %&gt;%
  # Show acronym in main effect of SOA
  str_replace(pattern = &#39;^SOA$&#39;,
              replacement = &#39;Stimulus onset asynchrony (SOA)&#39;) %&gt;%
  
  # Second, adjust order of effects in interactions. In the output from the model, 
  # the word-level variables of interest (i.e., &#39;z_cosine_similarity&#39; and 
  # &#39;z_visual_rating_diff&#39;) sometimes appeared second in their interactions. For 
  # better consistency, the code below moves those word-level variables (with 
  # their new names) to the first position in their interactions. Note that the 
  # order does not affect the results in any way.
  sub(&#39;(\\w+.*):(Language-based similarity|Visual-strength difference)&#39;, 
      &#39;\\2:\\1&#39;, 
      .) %&gt;%
  
  # Replace colons denoting interactions with times symbols
  str_replace(pattern = &#39;:&#39;, replacement = &#39; &amp;times; &#39;)


# Create plot
plot_semanticpriming_frequentist_bayesian_plot_weaklyinformativepriors_exgaussian =
  frequentist_bayesian_plot(KR_summary_semanticpriming_lmerTest,
                            confint_semanticpriming_lmerTest,
                            semanticpriming_posteriordistributions_weaklyinformativepriors_exgaussian,
                            labels = new_labels, interaction_symbol_x = TRUE,
                            vertical_line_at_x = 0, x_title = &#39;Effect size (&amp;beta;)&#39;,
                            legend_ncol = 1) + 
  theme(legend.position = &#39;bottom&#39;)</code></pre>
</div>
<p><br></p>
<pre class="r"><code>plot_semanticpriming_frequentist_bayesian_plot_weaklyinformativepriors_exgaussian</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Frequentist and Bayesian estimates are not so polar opposites, are they? What is more, the larger differences between some estimates are the result of the priors that were set on the corresponding effects. With uninformative priors, the frequentist and the Bayesian estimates are virtually identical.</p>
<script src='https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2Fpablobernabeu%2Flanguage-sensorimotor-simulation-PhD-thesis%2Fblob%2Fmain%2Fsemanticpriming%2Fbayesian_analysis%2Fsemanticpriming_brms_weaklyinformativepriors_exgaussian.R%23L16-L35&style=a11y-dark&type=code&showBorder=on&showLineNumbers=on&showFileMeta=on&showFullPath=on&showCopy=on'></script>
<p>Now it’s time to consider in earnest:</p>
<blockquote>
<p>Is frequentist statistics about <span class="math inline">\(p\)</span> values only? Are frequentist estimates diametrically opposed to Bayesian posterior distributions? Are confidence intervals and credible intervals irreconcilable? Will R crash if <a href="https://cran.r-project.org/web/packages/lmerTest/lmerTest.pdf"><code>lmerTest</code></a> and <a href="https://cran.r-project.org/web/packages/brms/brms.pdf"><code>brms</code></a> are simultaneously loaded?</p>
</blockquote>
</div>
<div id="session-info" class="section level3">
<h3>Session info</h3>
<p>If you encounter any blockers while reproducing the above analyses using the materials at <a href="https://osf.io/gt5uf" class="uri">https://osf.io/gt5uf</a>, my current session info may be useful. For instance, the legend of the plot may not show if the latest versions of the <code>ggplot2</code> and the <code>tidyverse</code> packages are used. Instead, <code>ggplot2 3.3.5</code> and <code>tidyverse 1.3.1</code> should be installed using <code>install_version('ggplot2', '3.3.5')</code> and <code>install_version('tidyverse', '1.3.1')</code>.</p>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.2.3 (2023-03-15 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 22621)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United Kingdom.utf8 
## [2] LC_CTYPE=English_United Kingdom.utf8   
## [3] LC_MONETARY=English_United Kingdom.utf8
## [4] LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.utf8    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ggtext_0.1.2        Cairo_1.6-0         forcats_1.0.0      
##  [4] stringr_1.5.0       dplyr_1.1.1         purrr_1.0.1        
##  [7] readr_2.1.4         tidyr_1.3.0         tibble_3.2.1       
## [10] ggplot2_3.3.5       tidyverse_1.3.1     knitr_1.42         
## [13] xaringanExtra_0.7.0
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.10      lubridate_1.9.2  digest_0.6.31    utf8_1.2.3      
##  [5] plyr_1.8.8       R6_2.5.1         cellranger_1.1.0 ggridges_0.5.4  
##  [9] backports_1.4.1  reprex_2.0.2     evaluate_0.21    highr_0.10      
## [13] httr_1.4.6       blogdown_1.16    pillar_1.9.0     rlang_1.1.0     
## [17] uuid_1.1-0       readxl_1.4.2     rstudioapi_0.14  jquerylib_0.1.4 
## [21] rmarkdown_2.21   labeling_0.4.2   munsell_0.5.0    gridtext_0.1.5  
## [25] broom_1.0.4      compiler_4.2.3   modelr_0.1.11    xfun_0.38       
## [29] pkgconfig_2.0.3  htmltools_0.5.5  tidyselect_1.2.0 bookdown_0.33.3 
## [33] fansi_1.0.4      crayon_1.5.2     tzdb_0.4.0       dbplyr_2.3.2    
## [37] withr_2.5.0      commonmark_1.9.0 grid_4.2.3       jsonlite_1.8.4  
## [41] gtable_0.3.3     lifecycle_1.0.3  DBI_1.1.3        magrittr_2.0.3  
## [45] scales_1.2.1     cli_3.4.1        stringi_1.7.12   cachem_1.0.7    
## [49] farver_2.1.1     fs_1.6.1         xml2_1.3.3       bslib_0.4.2     
## [53] generics_0.1.3   vctrs_0.6.1      tools_4.2.3      glue_1.6.2      
## [57] markdown_1.5     hms_1.1.3        fastmap_1.1.1    yaml_2.3.7      
## [61] timechange_0.2.0 colorspace_2.1-0 rvest_1.0.3      haven_2.5.2     
## [65] sass_0.4.6</code></pre>
</div>
<div id="references" class="section level3">
<h3>References</h3>
<div style="text-indent:-2em; margin-left:2em;">
<p>Bernabeu, P. (2022). <em>Language and sensorimotor simulation in conceptual processing: Multilevel analysis and statistical power</em>. Lancaster University. <a href="https://doi.org/10.17635/lancaster/thesis/1795" class="uri">https://doi.org/10.17635/lancaster/thesis/1795</a></p>
<p>Cumming, G. (2014). The new statistics: Why and how. <em>Psychological Science, 25</em>(1), 7–29. <a href="https://doi.org/10.1177/0956797613504966" class="uri">https://doi.org/10.1177/0956797613504966</a></p>
<p>Kruschke, J. K., &amp; Liddell, T. M. (2018). The Bayesian New Statistics: Hypothesis testing, estimation, meta-analysis, and power analysis from a Bayesian perspective. <em>Psychonomic Bulletin &amp; Review, 25</em>(1), 178–206.</p>
<p>Milek, A., Butler, E. A., Tackman, A. M., Kaplan, D. M., Raison, C. L., Sbarra, D. A., Vazire, S., &amp; Mehl, M. R. (2018). “Eavesdropping on happiness” revisited: A pooled, multisample replication of the association between life satisfaction and observed daily conversation quantity and quality. <em>Psychological Science, 29</em>(9), 1451–1462. <a href="https://doi.org/10.1177/0956797618774252" class="uri">https://doi.org/10.1177/0956797618774252</a></p>
<p>Pregla, D., Lissón, P., Vasishth, S., Burchert, F., &amp; Stadie, N. (2021). Variability in sentence comprehension in aphasia in German. <em>Brain and Language, 222</em>, 105008. <a href="https://doi.org/10.1016/j.bandl.2021.105008" class="uri">https://doi.org/10.1016/j.bandl.2021.105008</a></p>
<p>Rodríguez-Ferreiro, J., Aguilera, M., &amp; Davies, R. (2020). Semantic priming and schizotypal personality: Reassessing the link between thought disorder and enhanced spreading of semantic activation. <em>PeerJ, 8</em>, e9511. <a href="https://doi.org/10.7717/peerj.9511" class="uri">https://doi.org/10.7717/peerj.9511</a></p>
<p>Rouder, J. N., Haaf, J. M., &amp; Vandekerckhove, J. (2018). Bayesian inference for psychology, part IV: Parameter estimation and Bayes factors. <em>Psychonomic Bulletin &amp; Review, 25</em>(1), 102–113. <a href="https://doi.org/10.3758/s13423-017-1420-7" class="uri">https://doi.org/10.3758/s13423-017-1420-7</a></p>
<p>Schmalz, X., Biurrun Manresa, J., &amp; Zhang, L. (2021). What is a Bayes factor? <em>Psychological Methods</em>. <a href="https://doi.org/10.1037/met0000421" class="uri">https://doi.org/10.1037/met0000421</a></p>
<p>Tendeiro, J. N., &amp; Kiers, H. A. L. (2019). A review of issues about null hypothesis Bayesian testing. <em>Psychological Methods, 24</em>(6), 774–795. <a href="https://doi.org/10.1037/met0000221" class="uri">https://doi.org/10.1037/met0000221</a></p>
<p>Tendeiro, J. N., &amp; Kiers, H. A. L. (2022). On the white, the black, and the many shades of gray in between: Our reply to van Ravenzwaaij and Wagenmakers (2021). <em>Psychological Methods, 27</em>(3), 466–475. <a href="https://doi.org/10.1037/met0000505" class="uri">https://doi.org/10.1037/met0000505</a></p>
<p>van Ravenzwaaij, D., &amp; Wagenmakers, E.-J. (2022). Advantages masquerading as “issues” in Bayesian hypothesis testing: A commentary on Tendeiro and Kiers (2019). <em>Psychological Methods, 27</em>(3), 451–465. <a href="https://doi.org/10.1037/met0000415" class="uri">https://doi.org/10.1037/met0000415</a></p>
</div>
</div>
