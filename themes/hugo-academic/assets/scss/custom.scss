

// Override this file to add your own SCSS styling.

// Responsive base font size - scales with viewport, slightly larger on big screens
html {
  font-size: #{"clamp(15px, 0.9vw + 0.2rem, 16px)"} !important;
}

// Font size levels controlled by data attribute (user toggle overrides)
html[data-font-size="0"] { font-size: 12px !important; }
html[data-font-size="1"] { font-size: 13px !important; }
html[data-font-size="2"] { font-size: 14px !important; }
html[data-font-size="3"] { font-size: 15px !important; }
html[data-font-size="4"] { font-size: #{"clamp(15px, 0.9vw + 0.2rem, 16px)"} !important; } // default with scaling
html[data-font-size="5"] { font-size: 17px !important; }
html[data-font-size="6"] { font-size: 18px !important; }
html[data-font-size="7"] { font-size: 19px !important; }
html[data-font-size="8"] { font-size: 20px !important; }

// Ensure seamless theme transitions
html, body {
  transition: color 0.3s ease, background-color 0.3s ease !important;
}

// Override text color for light theme
body:not(.dark) {
  color: rgba(0,0,0,0.8) !important;
}

// Override text color for dark theme
body.dark {
  color: rgba(255,255,255,0.8) !important;
}

// Font size toggle dropdown menu
// Font size toggle dropdown menu
.font-size-menu {
  display: none;
  position: absolute;
  left: 50%;
  right: auto;
  transform: translateX(-50%) !important;
  top: 100%;
  margin-top: 0;
  background: #1e293b !important;
  border: 1px solid rgba(255,255,255,0.15) !important;
  border-radius: 0.25rem;
  box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.175);
  z-index: 9999 !important;
  width: fit-content;
  white-space: nowrap;
  min-width: 0 !important;
  max-width: fit-content !important;
  transition: none !important;
}

// Mobile viewport - center dropdown under icon
@media (max-width: 991px) {
  .font-size-menu {
    position: absolute !important;
    left: 50% !important;
    right: auto !important;
    transform: translateX(-50%) !important;
    margin-top: 0 !important;
  }
}

// Desktop large viewport adjustments
@media (min-width: 992px) {
  .font-size-menu {
    margin-top: 0.5rem;
  }
}

.font-size-menu.show {
  display: block;
}

// Keep menu visible when hovering over the icon or the menu itself
.nav-item.dropdown:hover .font-size-menu,
.font-size-menu:hover {
  display: block !important;
}

.font-size-menu .dropdown-item {
  padding: 0.5rem !important;
  cursor: pointer;
  color: #cbd5e1 !important;
  white-space: nowrap;
  transition: background-color 0.15s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.15rem !important;
  min-width: auto !important;
  width: auto !important;
}

.font-size-menu .dropdown-item:hover {
  background-color: #334155 !important;
}

.font-size-menu .dropdown-item i {
  width: 1rem;
  flex-shrink: 0;
  margin-right: 0.25rem;
}

.font-size-menu .js-font-increase i,
.font-size-menu .js-font-reset i,
.font-size-menu .js-font-decrease i {
  margin-right: 0.3rem !important;
}

.js-font-size-toggle {
  cursor: pointer;
}

// Theme menu styling - same as font-size-menu
.theme-menu {
  display: none;
  position: absolute;
  left: 50%;
  right: auto;
  transform: translateX(-50%) !important;
  top: 100%;
  margin-top: 0;
  background: #1e293b !important;
  border: 1px solid rgba(255,255,255,0.15) !important;
  border-radius: 0.25rem;
  box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.175);
  z-index: 9999 !important;
  width: fit-content;
  white-space: nowrap;
  min-width: 0 !important;
  max-width: fit-content !important;
  transition: none !important;
}

// Mobile viewport - center dropdown under icon
@media (max-width: 991px) {
  .theme-menu {
    position: absolute !important;
    left: 50% !important;
    right: auto !important;
    transform: translateX(-50%) !important;
    margin-top: 0 !important;
  }
}

@media (min-width: 992px) {
  .theme-menu {
    margin-top: 0.5rem;
  }
}

.theme-menu.show {
  display: block;
  pointer-events: auto !important;
}

.nav-item.dropdown:hover .theme-menu,
.theme-menu:hover {
  display: block !important;
  pointer-events: auto !important;
}

.theme-menu .dropdown-item {
  padding: 0.5rem !important;
  cursor: pointer;
  color: #cbd5e1 !important;
  white-space: nowrap;
  transition: background-color 0.15s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.15rem !important;
  min-width: auto !important;
  width: auto !important;
  pointer-events: auto !important;
}

.theme-menu .dropdown-item:hover {
  background-color: #334155 !important;
}

.theme-menu .dropdown-item i {
  width: 1rem;
  flex-shrink: 0;
  margin-right: 0.3rem;
}

// Desktop: reduce icon margin
@media (min-width: 992px) {
  .theme-menu .dropdown-item i {
    margin-right: 0.2rem;
  }
}

// Mobile: increase icon right margin
@media (max-width: 991px) {
  .theme-menu .dropdown-item i {
    margin-right: 0.6rem;
  }
  
  #navbar-main > div > ul > li.nav-item.dropdown.theme-dropdown > div > a.dropdown-item.js-set-theme-light > i {
    margin-right: 0.55rem !important;
  }
  
  // Increase right margin for theme dropdown to prevent occlusion
  #navbar-main > div > ul > li.nav-item.dropdown.theme-dropdown > div {
    margin-right: 0.75rem !important;
  }
  
  // Increase right padding for theme dropdown items to prevent occlusion
  #navbar-main > div > ul > li.nav-item.dropdown.theme-dropdown > div > a.dropdown-item.js-set-theme-dark,
  #navbar-main > div > ul > li.nav-item.dropdown.theme-dropdown > div > a.dropdown-item.js-set-theme-light {
    padding-right: 1rem !important;
  }
}

// Desktop: decrease icon right margin for dark theme
@media (min-width: 992px) {
  #navbar-main > div > ul > li.nav-item.dropdown.theme-dropdown > div > a.dropdown-item.js-set-theme-dark > i {
    margin-right: 0.25rem !important;
  }
}

// Show only opposite theme option based on current theme
body:not(.dark) .theme-menu .js-set-theme-light {
  display: none !important;
}

body.dark .theme-menu .js-set-theme-dark {
  display: none !important;
}

.js-theme-toggle {
  cursor: pointer;
}

// Font size toggle should use same colors as search and dark toggle
.navbar-nav .nav-link.js-font-size-toggle,
.navbar-nav .nav-link.js-theme-toggle {
  color: var(--nav-text) !important;
}

.navbar-nav .nav-link.js-font-size-toggle:hover {
  color: var(--nav-hover-text) !important;
}

body.dark .navbar-nav .nav-link.js-font-size-toggle {
  color: var(--nav-text) !important;
}

body.dark .navbar-nav .nav-link.js-font-size-toggle:hover {
  color: var(--nav-hover-text) !important;
}

// Remove underline on font size toggle hover
.navbar-nav .nav-link.js-font-size-toggle:hover::after {
  display: none !important;
}

// Article header caption links - always white
.article-header-caption a,
.article-header-caption a:link,
.article-header-caption a:visited,
.article-header-caption a:hover,
// Article header caption links - dark theme only
body.dark .article-header-caption a,
body.dark .article-header-caption a:link,
body.dark .article-header-caption a:visited,
body.dark .article-header-caption a:hover,
body.dark .article-header-caption a:active,
body.dark #top > article > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 > div > span > a,
body.dark #top > article > div.article-header > div > span > a,
body.dark #top > div.pub > div.article-header > div > span > a,
body.dark .featured-image-wrapper .article-header-caption a,
body.dark .article-header .article-header-caption a {
  color: #fff !important;
  background: none !important;
  background-color: transparent !important;
  background-image: none !important;
  text-decoration: none !important;
}

// Widget subtitle links - use site link styling with green underlines
.home-section .col-lg-12 > p a,
.home-section .section-heading > p a,
.home-section .col-12 > p a,
.home-section .col-lg-12 > p div a,
.home-section .section-heading > p div a,
.home-section .col-12 > p div a,
#top > div:nth-child(4) > div:nth-child(1) > h2 > a,
#top > div > div > h2 > a,
#blog > div > div > div.col-12.section-heading > p > span a,
#applications-and-dashboards > div > div > div.col-12.section-heading > p a,
#skills > div > div > div > table > tbody a,
#multimedia > div > div > div > div:nth-child(3) > div:nth-child(2) a,
#multimedia > div > div > div > div > div > a,
#top > div.universal-wrapper.pt-3 a,
#top div.universal-wrapper a {
  color: #000;
  text-decoration: underline;
  text-decoration-color: #bbf7d0;
  text-decoration-thickness: 1px;
  text-underline-offset: 2px;
  
  &:hover {
    text-decoration: underline;
    text-decoration-color: #22c55e;
    text-decoration-thickness: 2px;
    text-underline-offset: 2px;
    background-color: var(--bg-highlight);
  }
}

// Increase bottom margin for multimedia video containers
#multimedia > div > div > div > div > div {
  margin-bottom: 0.5rem !important;
}

// Remove extra top margin from first video in multimedia section
#multimedia > div > div > div:nth-child(2) > div:nth-child(1) {
  margin-top: 0 !important;
}

body.dark .home-section .col-lg-12 > p a,
body.dark .home-section .section-heading > p a,
body.dark .home-section .col-12 > p a,
body.dark .home-section .col-lg-12 > p div a,
body.dark .home-section .section-heading > p div a,
body.dark .home-section .col-12 > p div a,
body.dark #top > div:nth-child(4) > div:nth-child(1) > h2 > a,
body.dark #top > div > div > h2 > a,
body.dark #blog > div > div > div.col-12.section-heading > p > span a,
body.dark #applications-and-dashboards > div > div > div.col-12.section-heading > p a,
body.dark #skills > div > div > div > table > tbody a,
body.dark #multimedia > div > div > div > div:nth-child(3) > div:nth-child(2) a,
body.dark #multimedia > div > div > div > div > div > a,
body.dark #top > div.universal-wrapper.pt-3 a,
body.dark #top div.universal-wrapper a {
  color: #fff;
  text-decoration: underline;
  text-decoration-color: #bbf7d0;
  text-decoration-thickness: 1px;
  text-underline-offset: 2px;
  
  &:hover {
    text-decoration: underline;
    text-decoration-color: #22c55e;
    text-decoration-thickness: 2px;
    text-underline-offset: 2px;
    background-color: var(--bg-highlight);
  }
}

// Increase bottom margin for blog section heading paragraph
#blog > div > div > div.col-12.section-heading > p {
  margin-bottom: 1rem !important;
}

// Reduce bottom margin for blog entries
#blog > div > div > div:nth-child(2) > div {
  margin-bottom: 1rem !important;
}

// Make blog link full width with centred text
#blog > div > div > div:nth-child(2) > div > div.media-body > a {
  display: block !important;
  width: 100% !important;
  text-align: center !important;
}

// Reduce font size for specific h2 links
#top > div > div > h2 > a {
  font-size: 0.9em;
}

body.dark #top > div > div > h2 > a {
  font-size: 0.9em;
}

// Make all text in pub-list-item white in dark theme
.dark .pub-list-item,
.dark .pub-list-item * {
  color: #e2e8f0 !important;
}

.dark .pub-list-item a {
  color: #e2e8f0 !important;
}

// Dark theme: light font for media-body h3 links and article-metadata
.dark #top > div > div > div.media-body > h3,
.dark #top > div > div > div.media-body > h3 > a,
.dark .article-metadata,
.dark .article-metadata * {
  color: #e2e8f0 !important;
}

// Dark theme: collapsed summary gradient blends seamlessly with background
.dark details > summary::after,
.dark details[open] > summary::after {
  background: linear-gradient(to bottom, rgba(15, 23, 42, 0), rgba(15, 23, 42, 0.8), #0f172a) !important;
}

// Prevent scroll blocking and spurious scrollbars - no forced vertical scrollbar
html {
  scroll-behavior: auto !important;
  scroll-padding-top: 60px !important;
  overflow-x: hidden !important;
  overflow-y: auto !important;
  max-width: 100vw !important;
  width: 100% !important;
}

// Prevent horizontal scrolling and spurious scrollbars
html, body {
  overflow-x: hidden !important;
  max-width: 100vw !important;
  width: 100% !important;
}

body {
  position: relative !important;
  overflow-x: hidden !important;
  overflow-y: auto !important;
  padding-top: 75px !important;
}

// Ensure all major containers respect viewport width
.container,
.container-fluid,
section,
.home-section {
  max-width: 100vw !important;
  overflow-x: hidden !important;
  overflow-y: hidden !important;
  height: auto !important;
  max-height: none !important;
}

// Prevent any wrapper divs from creating scrollable contexts
#top,
body > *,
body > div {
  overflow-y: visible !important;
  max-height: none !important;
  height: auto !important;
}

// Reduce top and bottom padding of all home sections
.home-section {
  padding-top: 0.8rem !important;
  padding-bottom: 4rem !important;
}

// Prevent spurious scrollbars on home page columns - maximum specificity
.home-section .row,
.home-section .col-12,
.home-section .col-lg-8,
.home-section .col-lg-4,
.home-section > .container > .row,
.home-section > .container > .row > .col-12,
.home-section > .container > .row > .col-lg-8,
.home-section > .container > .row > .col-lg-4,
section.home-section .row,
section.home-section .col-12,
section.home-section .col-lg-8,
section.home-section .col-lg-4 {
  overflow: visible !important;
  overflow-x: visible !important;
  overflow-y: visible !important;
  max-height: none !important;
  height: auto !important;
  min-height: 0 !important;
}

/* Exception for tags section - constrain height */
#tags,
#tags.home-section,
#tags > .container > .row,
#tags > .container > .row > .col-12,
#tags > .container > .row > .col-lg-8 {
  max-height: none !important;
}

/* Hide all scrollbars on home page sections */

/* Full width tag cloud with minimal margins */
#tags {
  overflow: visible !important;
  min-height: auto !important;
  max-height: none !important;
  margin-bottom: 2rem !important;
  padding-bottom: 1rem !important;
}

#tags.home-section {
  overflow: visible !important;
  padding-bottom: 1rem !important;
  min-height: auto !important;
  max-height: none !important;
}

/* Mobile adjustments - constrain height and reduce spacing */
@media (max-width: 768px) {
  #tags {
    margin-bottom: 2rem !important;
    padding-bottom: 2rem !important;
    min-height: auto !important;
  }
  
  #tags.home-section {
    padding-bottom: 2rem !important;
    min-height: auto !important;
  }
  
  #tags .tag-cloud {
    font-size: #{"clamp(0.6rem, 1vw, 0.75rem)"} !important;
    max-height: none;
    overflow-y: hidden;
    overflow-x: hidden;
    padding-bottom: 0.5rem;
  }
}

#tags .container {
  max-width: 1200px !important;
  margin-left: auto !important;
  margin-right: auto !important;
  padding-left: 0.5rem !important;
  padding-right: 0.5rem !important;
  overflow: visible !important;
  min-height: auto !important;
  max-height: none !important;
  padding-bottom: 2rem !important;
  margin-bottom: 2rem !important;
}

#tags .tag-cloud {
  text-align: center !important;
  line-height: #{"clamp(1.3, 1.5 + 0.5vh, 1.8)"} !important;
  font-size: #{"clamp(0.65rem, 1.2vw, 0.85rem)"} !important;
  position: relative;
  overflow: visible !important;
  min-height: auto !important;
  max-height: none !important;
  padding-bottom: 2rem !important;
  margin-bottom: 2rem !important;
}

/* Mobile adjustments - constrain height and reduce spacing */
@media (max-width: 768px) {
  #tags .container {
    min-height: auto !important;
    padding-bottom: 2rem !important;
    max-width: 100% !important;
    padding-left: 0.25rem !important;
    padding-right: 0.25rem !important;
  }
  
  #tags .tag-cloud {
    font-size: #{"clamp(0.6rem, 1vw, 0.75rem)"} !important;
    max-height: none;
    min-height: auto !important;
    overflow-y: hidden;
    overflow-x: hidden;
    padding-bottom: 1rem !important;
  }
}

#tags .tag-cloud a {
  display: inline-block !important;
  margin: 0.3rem 0.3rem 0.5rem 0.3rem !important;
  position: relative;
  padding: 0;
  white-space: nowrap;  /* Prevent multi-word tags from breaking across lines */
  transform: none !important;  /* Disable academic.css transform: scale(1.2) to prevent shrinking bug */
  transition: none !important;  /* Disable transform transitions */
  vertical-align: top !important;
}

/* Instant CSS-based hover outline - always visible immediately */
#tags .tag-cloud a:hover {
  outline: 2px solid currentColor !important;
  outline-offset: 2px !important;
  border-radius: 0.3em !important;
  opacity: 1 !important;
  transform: none !important;  /* Override academic.css transform: scale(1.2) */
}

/* Footer tag cloud - simpler version without network */
.footer-tag-cloud-section {
  padding: 1.5rem 0;
  margin-top: 2rem;
  margin-bottom: 1rem;
  border-top: 1px solid rgba(128, 128, 128, 0.2);
  overflow-x: hidden !important;
  overflow-y: visible !important;
}

/* Site footer spacing to prevent overlap with tag cloud */
.site-footer {
  margin-top: 2rem !important;
  clear: both;
}

/* Target the container wrapper around the footer specifically */
body > div.container:last-of-type {
  margin-top: 3rem !important;
  clear: both;
}

@media (max-width: 768px) {
  .site-footer {
    margin-top: 3rem !important;
  }
  
  body > div.container:last-of-type {
    margin-top: 4rem !important;
  }
  
  /* Constrain tag cloud height on small screens */
  #tags .tag-cloud {
    max-height: none !important;
    overflow-y: hidden !important;
  }
}

body.dark .footer-tag-cloud-section {
  border-top-color: rgba(255, 255, 255, 0.1);
}

.footer-tag-cloud {
  text-align: center !important;
  line-height: 1.6 !important;
  font-size: 0.8rem !important;
}

.footer-tag-cloud a {
  display: inline;
  margin: 0 0.25rem;
  white-space: nowrap;
}

.footer-tag-cloud a:hover,
.footer-tag-cloud a:focus {
  background-color: transparent !important;
}

.footer-tag-cloud a::after {
  content: attr(data-count);
  font-size: 0.6em;
  vertical-align: sub;
  opacity: 0.4;
  margin-left: 0.1em;
  font-weight: 400;
}

/* Hide the 's' tag */
#tags .tag-cloud a[data-tag="s"] {
  display: none;
}

/* Frequency count subscripts */
#tags .tag-cloud a::after {
  content: attr(data-count);
  font-size: 0.6em;
  vertical-align: sub;
  opacity: 0.5;
  margin-left: 0.15em;
  font-weight: 400;
}

/* Tag page heading links - match home page styling */
#top > div > div > h2 a {
  color: var(--text-tertiary) !important;
  text-decoration: none !important;
  
  &:hover {
    color: #059669 !important;
    text-decoration: underline !important;
    text-decoration-color: #22c55e !important;
    text-decoration-thickness: 2px !important;
    text-underline-offset: 3px !important;
  }
}

body.dark #top > div > div > h2 a {
  &:hover {
    color: #34d399 !important;
    text-decoration-color: #10b981 !important;
  }
}

/* Decrease margin between tag page entries */
#top > div > div > h2 {
  margin-bottom: 0.5rem !important;
  margin-top: 0 !important;
  font-weight: 700 !important;
  max-width: 850px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

#top > div > div > h2 a {
  font-weight: 700 !important;
}

#top > div > div {
  max-width: 850px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

/* Increase margin under universal wrapper */
#top > div.universal-wrapper.pt-3 {
  margin-bottom: -2.5rem !important;
  padding-bottom: 0rem !important;
}

/* Remove horizontal padding from universal-wrapper in mobile view */
@media (max-width: 991px) {
  #top > div.universal-wrapper.pt-3 {
    padding-left: 0.75rem !important;
    padding-right: 0.75rem !important;
  }
}

/* Additional reduction for publication page only */
body.page-publications #top > div.universal-wrapper.pt-3 {
  margin-bottom: -2.5rem !important;
  max-width: 760px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

/* Remove left and right margins in mobile view */
@media (max-width: 991px) {
  body.page-publications #top > div.universal-wrapper.pt-3 {
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
}

/* Increase margin above content section */
#top > div:nth-child(4) {
  margin-top: 1.5rem !important;
  max-width: 800px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

/* Reduce margin for publication page */
body.page-publications #top > div:nth-child(4) {
  margin-top: 0rem !important;
}

/* Increase margin under content section header */
#top > div:nth-child(4) > div > div {
  margin-bottom: 1.5rem !important;
}

/* Increase margin under h1 in universal wrapper */
#top > div.universal-wrapper.pt-3 > h1 {
  margin-bottom: 2rem !important;
  font-size: 2.75rem !important;
}

#top div.universal-wrapper h1 {
  margin-bottom: 1.5rem !important;
}

#top div div h2 {
  margin-bottom: 0.5rem !important;
  margin-top: 0 !important;
}

.home-section *,
.home-section .row,
.home-section .col-12,
.home-section .col-lg-8,
.home-section .col-lg-4,
section.home-section *,
section.home-section .row,
section.home-section .col-12,
section.home-section .col-lg-8,
section.home-section .col-lg-4 {
  scrollbar-width: none !important; /* Firefox */
  -ms-overflow-style: none !important; /* IE/Edge */
}

.home-section *::-webkit-scrollbar,
.home-section .row::-webkit-scrollbar,
.home-section .col-12::-webkit-scrollbar,
.home-section .col-lg-8::-webkit-scrollbar,
.home-section .col-lg-4::-webkit-scrollbar,
section.home-section *::-webkit-scrollbar,
section.home-section .row::-webkit-scrollbar,
section.home-section .col-12::-webkit-scrollbar,
section.home-section .col-lg-8::-webkit-scrollbar,
section.home-section .col-lg-4::-webkit-scrollbar {
  display: none !important; /* Chrome/Safari */
  width: 0 !important;
  height: 0 !important;
}

// Reduce article-container top margin
.article-container {
  margin-top: 0.5rem !important;
}

// Exception: Increase margin for article-container after featured image on presentation pages  
html body.page-wrapper #top > div.pub > div.article-header.featured-image-wrapper + div.article-container.pt-3 {
  margin-top: 6rem !important;
}

// Home page max-width
section.home-section .container {
  max-width: 1250px !important;
  padding-left: 20px !important;
  padding-right: 20px !important;
  margin: 0 auto !important;
}

// Set max-width for specific home sections to match article-container (760px)
#teaching-supervision .container,
#funding-awards .container,
#other-work .container,
#skills .container,
#multimedia .container,
#blog .container {
  max-width: 760px !important;
}

// Increase bottom padding in multimedia section
#multimedia {
  padding-bottom: 5rem !important;
}

// Set max-width for publications and applications sections (760px to match blog posts)
#publication .container,
#applications-and-dashboards .container,
#workshops .container,
#presentations .container,
#funding-awards .container,
#other-work .container,
#skills .container {
  max-width: 900px !important;
}

// Reduce bottom margin in section headings
#applications-and-dashboards > div > div > div.col-12.section-heading > h1 {
  margin-bottom: 0.25rem !important;
}

// Ensure consistent top padding for applications section
#applications-and-dashboards {
  padding-top: 0.8rem !important;
}

// Format page titles on post and presentation pages like home page
.page-heading h1 {
  font-size: 2.5rem !important;
  font-weight: 400 !important;
  margin-bottom: 0.25rem !important;
}

// Format titles in post and presentation lists
#top > div > div > div.media-body > h3 > a,
#top > div.universal-wrapper.pt-3 > p > a,
#presentation_list > div.col-lg-10 > div > div.media-body > h3 > a {
  font-size: 1.5rem !important;
  font-weight: 600 !important;
  color: #2c5282 !important;
  text-decoration: none !important;
  background-color: transparent !important;
  background-image: none !important;
  border-bottom: none !important;
  padding-bottom: 0 !important;
  transition: color 0.2s ease !important;
}

#top > div > div > div.media-body > h3 > a:hover,
#top > div.universal-wrapper.pt-3 > p > a:hover,
#presentation_list > div.col-lg-10 > div > div.media-body > h3 > a:hover {
  color: #1a365d !important;
  background-color: transparent !important;
  background-image: none !important;
}

body.dark #top > div > div > div.media-body > h3 > a,
body.dark #top > div.universal-wrapper.pt-3 > p > a,
body.dark #presentation_list > div.col-lg-10 > div > div.media-body > h3 > a {
  color: #63b3ed !important;
  background-color: transparent !important;
  background-image: none !important;
}

body.dark #top > div > div > div.media-body > h3 > a:hover,
body.dark #top > div.universal-wrapper.pt-3 > p > a:hover,
body.dark #presentation_list > div.col-lg-10 > div > div.media-body > h3 > a:hover {
  color: #90cdf4 !important;
  background-color: transparent !important;
  background-image: none !important;
}

// Increase bottom margin for presentation list h3 titles
#presentation_list > div.col-lg-10 > div > div.media-body > h3 {
  margin-bottom: 0.75rem !important;
}

// Increase font size of section heading subtitle
div > div > div.col-12.section-heading > p {
  font-size: 1.1rem !important;
}

// Apply consistent font properties to all section titles
.section-heading h1,
.home-section .section-heading h1,
#blog > div > div > div.col-12.section-heading > h1,
#applications-and-dashboards > div > div > div.col-12.section-heading > h1,
#publication > div > div > div.col-12.section-heading > h1,
div.col-12.section-heading > h1 {
  margin-top: 0.5rem !important;
  margin-bottom: 0.25rem !important;
  font-size: 2.25rem !important;
}

// Reduce bottom margin specifically for publication heading
#publication > div > div > div.col-12.section-heading > h1 {
  margin-bottom: 0.1rem !important;
}

// Increase top margin for blog section heading
#blog > div > div > div.col-12.section-heading > h1 {
  margin-top: 0.8rem !important;
}

// Increase top margin for applications-and-dashboards section heading
#applications-and-dashboards > div > div > div.col-12.section-heading > h1 {
  margin-top: 0.8rem !important;
}

// Increase top margin for publication section heading in mobile
@media (max-width: 991px) {
  #publication > div > div > div.col-12.section-heading > h1 {
    margin-top: 0.5rem !important;
    margin-bottom: 0.1rem !important;
    visibility: visible !important;
    display: block !important;
    opacity: 1 !important;
  }
  
  /* Ultra-specific override to ensure margin applies */
  body #publication > div > div > div.col-12.section-heading > h1 {
    margin-top: 4rem !important;
    margin-bottom: 0.5rem !important;
  }
}

// Increase top margin for Related podcasts headings
#related-podcasts > h3 {
  margin-top: 2rem !important;
}

// Reduce margin above stream-meta article-metadata
#top > div:nth-child(4) > div > div.media-body > div.stream-meta.article-metadata {
  margin-top: -0.3rem !important;
}

// Remove navbar's extra horizontal padding
.navbar {
  padding-left: 0 !important;
  padding-right: 0 !important;
}

// Navbar container max-width
.navbar > .container,
.navbar > .container-fluid,
#navbar-main > .container,
#navbar-main > .container-fluid {
  max-width: 1250px !important;
  padding-left: 20px !important;
  padding-right: 20px !important;
  margin: 0 auto !important;
}

/* In mobile view, reduce left margin/padding on navbar main div */
@media (max-width: 991px) {
  body #navbar-main > div,
  body #navbar-main > .container,
  body #navbar-main > .container-fluid {
    margin-left: 0 !important;
    padding-left: 10px !important;
  }
}

// Navbar hamburger menu icon - larger and moved up
#navbar-main > div > button {
  margin-right: 0.5rem !important;
}

#navbar-main > div > button > span > i {
  font-size: 1.4rem;
  position: relative;
  top: -2px;
  margin-left: -0.5rem !important;
}

/* In mobile view, increase left margin for hamburger icon */
@media (max-width: 991px) {
  #navbar-main > div > button > span > i {
    margin-left: -0.3rem !important;
  }
}

// Mobile-specific container fixes
@media (max-width: 991px) {
  .container,
  .container-fluid {
    padding-left: 0.4rem !important;
    padding-right: 0.4rem !important;
  }
  
  section.home-section {
    padding-left: 0.4rem !important;
    padding-right: 0.4rem !important;
  }
  
  section.home-section .container {
    padding-left: 0.4rem !important;
    padding-right: 0.4rem !important;
  }
  
  .row {
    margin-left: 0 !important;
    margin-right: 0 !important;
  }
  
  .col,
  [class*="col-"] {
    padding-left: 0.5rem !important;
    padding-right: 0.5rem !important;
  }
}

// Prevent white flash on dark theme load
html {
  // Immediate dark theme application (used by theme-init.js)
  &.dark-theme-loading {
    background-color: #0f172a !important;
    color: #e2e8f0 !important;
    
    body {
      background-color: #0f172a !important;
      color: #e2e8f0 !important;
    }
  }
}

// Smooth transition for theme switching
body {
  transition: background-color 0.3s ease, color 0.3s ease;
}

// General blockquote styling 
blockquote {
  padding: 0.7%;
  padding-left: 1.7%;
  margin-bottom: 1.5rem !important;
}

// Publication abstract spacing
.pub-abstract {
  margin-bottom: 1.5rem !important;
}

// Increase gap above Abstract heading in publication pages
.article-container > h3:first-child {
  margin-top: 6rem;
}

// Margin above article-metadata in publication pages
.pub .article-container.pt-3 .article-metadata {
  margin-top: 0.7rem !important;
  padding-bottom: 0 !important;
}

// Increase font size for article metadata
#top > article > div.article-container.pt-3 > div.article-metadata {
  font-size: 1rem !important;
}

#top > article > div.article-container.pt-3 > div.article-metadata > span.article-date {
  font-size: 1rem !important;
}

#top > article > div.article-container.pt-3 > div.article-metadata > span:nth-child(1) > span {
  font-size: 1rem !important;
}

#top > article > div.article-container.pt-3 > div.article-metadata > span > span > strong {
  font-size: 1rem !important;
}

// Reduce line height for publication metadata on /publication/ page
#publication > div > div > div > div > div.media-body > div.stream-meta.article-metadata {
  line-height: 1.4 !important;
}

#publication > div > div > div > div > div.media-body > div.stream-meta.article-metadata > div {
  line-height: 1.4 !important;
  font-size: 0.8rem !important;
  margin-top: 0.3rem !important;
}

#publication > div > div > div > div > div.media-body > div.stream-meta.article-metadata * {
  line-height: 1.4 !important;
}

// Remove reduced font size for abstracts to maintain consistency with other paragraphs
// #publication > div > div > div > div > div.media-body > div.article-style {
//   font-size: 0.85rem !important;
// }

// Increase font size for publication type/year headings on /publication/ page
// Exclude .li-cite-author spans which need different styling
#container-publications > div.grid-sizer.col-lg-12.isotope-item > div > span:not(.li-cite-author):not(.article-metadata) {
  font-size: 2rem !important;
  line-height: 1 !important;
  margin-right: 0 !important;
  padding-right: 0 !important;
}

// Reduce font size for the rest of the publication heading container
#container-publications > div.grid-sizer.col-lg-12.isotope-item > div {
  font-size: 1rem !important;
  margin-left: 1rem !important;
}

// Set font size for publication item containers
#container-publications .isotope-item[class*="pubtype-"] > div {
  font-size: 1rem !important;
}

// Style author field in publication list
#container-publications .li-cite-author {
  font-size: 1rem !important;
  line-height: 1.5 !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif !important;
}

#container-publications .article-metadata.li-cite-author {
  line-height: 1.5 !important;
  font-size: 1rem !important;
  display: inline !important;
}

#container-publications .article-metadata.li-cite-author * {
  line-height: 1.5 !important;
  font-size: 1rem !important;
}

#container-publications .article-metadata.li-cite-author > span {
  line-height: 1.5 !important;
  font-size: 1rem !important;
  margin: 0 !important;
  padding: 0 !important;
  display: inline !important;
}

#container-publications .article-metadata.li-cite-author > span > a {
  line-height: 1.5 !important;
  display: inline !important;
}

#container-publications .li-cite-author * {
  line-height: 1.5 !important;
}

#container-publications .li-cite-author span {
  margin-right: 0 !important;
  padding-right: 0 !important;
  margin-left: 0 !important;
  padding-left: 0 !important;
  line-height: 1.5 !important;
  font-size: 1rem !important;
  font-family: inherit !important;
  display: inline !important;
  max-height: 1.5em !important;
}

#container-publications .li-cite-author a {
  margin: 0 !important;
  padding: 0 !important;
}

.pub-list-item .li-cite-author {
  line-height: 1.5 !important;
}

.pub-list-item .li-cite-author span {
  margin-right: 0 !important;
  padding-right: 0 !important;
  line-height: 1.5 !important;
  font-size: 1rem !important;
}

// Target publication item authors with specific selector
#container-publications > div.isotope-item > div > span.li-cite-author {
  line-height: 1.5 !important;
}

// Force line-height on parent div containing authors
#container-publications > div.isotope-item > div {
  line-height: 1.5 !important;
  margin-bottom: 1.3rem !important;
  padding-left: 0 !important;
}

/* Increase left margin in desktop view */
@media (min-width: 992px) {
  #container-publications > div.isotope-item > div {
    margin-left: 3.2em !important;
    text-indent: -3.2em !important;
    padding-left: 3rem !important;
  }
}

/* Adjust publication item margins in mobile view */
@media (max-width: 991px) {
  #container-publications > div.isotope-item > div {
    margin-left: 2.3em !important;
    text-indent: -2.3em !important;
  }
  
  #container-publications > div.isotope-item > div > p {
    margin-left: -1em !important;
  }
}

// Remove hanging indent from button paragraph
#container-publications > div.isotope-item > div > p {
  margin-left: -1.8em !important;
  margin-top: 0.35rem !important;
  text-indent: 0 !important;
  padding-left: 0 !important;
}

// Reset text-indent for buttons to prevent leftward shift
#container-publications > div.isotope-item > div .btn-links,
#container-publications > div.isotope-item > div .btn-links .btn,
#container-publications > div.isotope-item > div .btn-links a {
  text-indent: 0 !important;
  font-size: 1.1rem !important;
  height: 2.5em !important;
  min-height: 2.5em !important;
  max-height: 2.5em !important;
}

// Hide report icons at the beginning of references (but not button icons)
#container-publications > div.isotope-item > div > i {
  display: none !important;
}

// Reduce icon margin in publication reference buttons
#container-publications > div.isotope-item > div .btn-links i {
  margin: 0 0.35em 0 0 !important;
  text-indent: 0 !important;
  display: inline !important;
}

// Fix ::before pseudo-element positioning on icons
#container-publications > div.isotope-item > div i::before {
  margin-left: 0 !important;
  text-indent: 0 !important;
}

// Set max-width for publication page container to match blog posts
#container-publications {
  max-width: 760px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

/* Remove container margins in mobile view */
@media (max-width: 991px) {
  #container-publications {
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 0.5rem !important;
    padding-right: 0.5rem !important;
  }
}

#container-publications > div.isotope-item[class*="pubtype-"] > div > span > span {
  line-height: 1.5 !important;
  margin-right: 0 !important;
  padding-right: 0 !important;
  margin-left: 0 !important;
  padding-left: 0 !important;
  font-size: 1rem !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif !important;
}

#container-publications > div.isotope-item > div > span {
  margin-right: 0 !important;
  padding-right: 0 !important;
}

#container-publications > div.isotope-item > div > span.li-cite-author > span {
  margin-right: 0 !important;
  padding-right: 0 !important;
  margin-left: 0 !important;
  padding-left: 0 !important;
}

// Set bottom margin for publication items
#container-publications > div > div {
  margin-bottom: 1.8rem !important;
}

// Alternative selector based on user's suggestion
#container-publications > div > div > span {
  line-height: 1.5 !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif !important;
}

#container-publications > div > div > span > span {
  margin-right: 0 !important;
  padding: 0 !important;
  line-height: 1.5 !important;
  font-size: 1rem !important;
  margin-left: -0.1em !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif !important;
  display: inline !important;
  vertical-align: baseline !important;
}

// Additional specific selectors for authors field with all pubtype variations
#container-publications > div.grid-sizer.col-lg-12.isotope-item > div > span > span {
  line-height: 1.5 !important;
  font-size: 1rem !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif !important;
  display: inline !important;
  vertical-align: baseline !important;
}

#container-publications > div[class*="pubtype-"] > div > span > span {
  line-height: 1.5 !important;
  font-size: 1rem !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif !important;
  display: inline !important;
  vertical-align: baseline !important;
}

#container-publications > div[class*="year-"] > div > span > span {
  line-height: 1.5 !important;
  font-size: 1rem !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif !important;
  display: inline !important;
  vertical-align: baseline !important;
}

// Target the span.li-cite-author specifically
#container-publications span.article-metadata.li-cite-author,
#container-publications span.article-metadata.li-cite-author *,
#container-publications span.article-metadata.li-cite-author > *,
#container-publications span.article-metadata.li-cite-author span,
#container-publications span.article-metadata.li-cite-author > span,
#container-publications span.li-cite-author,
#container-publications span.li-cite-author *,
#container-publications span.li-cite-author > *,
#container-publications .li-cite-author span,
#container-publications .li-cite-author > span,
#container-publications div > span.li-cite-author,
#container-publications div > span.li-cite-author > span {
  line-height: 1.5 !important;
  font-size: 1rem !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif !important;
  display: inline !important;
  vertical-align: baseline !important;
}

// Match strong elements in titles to authors font size
#container-publications .isotope-item[class*="pubtype-"] > div > span > span > strong {
  font-size: 1rem !important;
}

#container-publications > div > div > span > span > strong {
  font-size: 1rem !important;
}

#container-publications > div > div > a {
  font-size: 1rem !important;
}

// Set consistent margin under publication paragraphs
#container-publications .isotope-item[class*="pubtype-"] > div > p {
  font-size: 1.1rem !important;
  margin-bottom: 0.5rem !important;
}

// Remove underline from publication paragraph links
#container-publications > div > div > p > a {
  text-decoration: none !important;
}

// Reduce margin under form-row on publication page
#top > div:nth-child(4) > div > div > div.form-row.mb-4 {
  margin-bottom: 1.5rem !important;
  max-width: 760px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

// Reduce margins in open science popups
#open-science-popup > span > a:nth-child(1) {
  margin-top: 0 !important;
  margin-bottom: 0.3rem !important;
  font-size: 1.02rem !important;
}

#open-science-popup > span > a:nth-child(1) > i {
  vertical-align: middle !important;
}

#open-science-popup > img {
  margin-bottom: -0.2rem !important;
}

#open-science-popup > span > span {
  margin-top: 0.2rem !important;
  margin-bottom: 0.2rem !important;
}

// Light grey background for open science badges and popups
.btn-links a[title*="Open science"],
.btn-links a[title*="open science"] {
  background-color: #f5f5f5 !important;
  white-space: nowrap !important;
}

body.dark .btn-links a[title*="Open science"],
body.dark .btn-links a[title*="open science"] {
  background-color: #2a2a2a !important;
  white-space: nowrap !important;
}

// Keep publication type badge and open science badges properly grouped
// Use inline-block instead of flex to allow natural clustering
.publication-badges {
  display: inline-block !important;
  vertical-align: middle !important;
  line-height: 1.4 !important;
}

// Pub type badge and open science badges as inline-block
.pub-type-badge,
.open-science-badge {
  display: inline-block !important;
  vertical-align: middle !important;
  white-space: nowrap !important;
  margin-right: 0.4em !important;
  margin-bottom: 0.2em !important;
}

#open-science-popup {
  background-color: #ffffff !important;
}

// Override dark theme link hover color in open science popups (white background needs dark hover color)
body.dark #open-science-popup a:hover {
  color: #009688 !important;
}

// Reduce margin above separator in open science popups
#open-science-popup .popup-separator {
  margin-top: 4px !important;
}

// Increase font size for metadata on individual publication detail pages
#top > div.pub > div.article-container.pt-3 > div.article-metadata,
#top > div.pub > div.article-container.pt-3 > div.article-metadata * {
  font-size: 1.15rem !important;
  line-height: 1.5 !important;
}

// Keep article-categories at original smaller size
#top > div.pub > div.article-container.pt-3 > div.article-metadata > span.article-categories,
#top > div.pub > div.article-container.pt-3 > div.article-metadata > span.article-categories * {
  font-size: 0.8rem !important;
}

// Override font size for publication pages specifically
body.page-publication #top > div.pub > div.article-container.pt-3 > div.article-metadata,
body.page-publication #top > div.pub > div.article-container.pt-3 > div.article-metadata * {
  font-size: 2rem !important;
  color: red !important;
}

#top > div.pub > div.article-container.pt-3 > div.article-metadata {
  margin-bottom: 0.5rem !important;
  padding-bottom: 0.5rem !important;
}

// Move article categories to new line
#top > div.pub > div.article-container.pt-3 > div.article-metadata > span.article-categories {
  display: block !important;
  margin-top: 0.3rem !important;
  margin-bottom: -0.4rem !important;
  font-size: 0.8rem !important;
}

// Override for presentation pages: keep article-categories inline
body.page-wrapper #top > div.pub > div.article-container.pt-3 > div.article-metadata > span.article-categories {
  display: inline !important;
  margin-top: 0 !important;
  margin-bottom: 0 !important;
}

// Show middot divider before article-categories on presentation pages
body.page-wrapper #top > div.pub > div.article-container.pt-3 > div.article-metadata > span.middot-divider:has(+ span.article-categories) {
  display: inline !important;
}

#top > div.pub > div.article-container.pt-3 > div.article-metadata > span.article-categories * {
  font-size: 0.8rem !important;
}

// Publication pages: increase font size for categories
body.page-publication #top > div.pub > div.article-container.pt-3 > div.article-metadata > span.article-categories * {
  font-size: 2rem !important;
}

// Reduce font size of first metadata span
#top > div.pub > div.article-container.pt-3 > div.article-metadata > span:nth-child(1) > span {
  font-size: 0.85rem !important;
}

// Override ALL span > span to match general metadata size increase (must come after more specific rules)
#top > div.pub > div.article-container.pt-3 > div.article-metadata > span:nth-child(1) > span {
  font-size: 1.15rem !important;
}

#top > div.pub > div.article-container.pt-3 > div.article-metadata > span > span {
  font-size: 1.15rem !important;
}

// Publication pages: increase font size for first metadata span
body.page-publication #top > div.pub > div.article-container.pt-3 > div.article-metadata > span:nth-child(1) > span {
  font-size: 2rem !important;
}

// Hide middot dividers in publication metadata
#top > div.pub > div.article-container.pt-3 > div.article-metadata > span.middot-divider {
  display: none !important;
}

// Margin above publication badges
#top > div.pub > div.article-container.pt-3 > .btn-links {
  margin-top: 0.15rem !important;
  margin-bottom: 0.1rem !important;
}

// Move down all section images on home page
div > div > div > div > div.ml-3 > a > img {
  margin-top: 1.5rem !important;
}

// Fix presentation metadata padding and margin
#presentation_list > div.col-lg-10 > div > div.media-body > div.stream-meta.article-metadata > div > span {
  padding-top: 0.3rem !important;
  margin-bottom: 0.2rem !important;
  display: inline-block !important;
}

// Increase font size and reduce top margin for presentation metadata
#presentation_list > div.col-lg-10 > div > div.media-body > div.stream-meta.article-metadata {
  font-size: 1.1rem !important;
  margin-top: 0.1rem !important;
  line-height: 1.4 !important;
}

#presentation_list > div.col-lg-10 > div > div.media-body > div.stream-meta.article-metadata * {
  font-size: 1.1rem !important;
}

// Reduce right margin/padding in presentation list left column
#presentation_list > div.col-lg-2 {
  margin-right: 0 !important;
  padding-right: 0.5rem !important;
  max-width: 80px !important;
  flex: 0 0 80px !important;
}

// Reduce top margin for year headings in presentation list
#presentation_list > div.col-lg-2 > h3 {
  margin-top: 0.5rem !important;
}

// Adjust margins for presentation list container
#presentation_list {
  margin-left: 2rem !important;
  margin-right: -2rem !important;
}

// Remove right padding and margin from presentation list right column
#presentation_list > div.col-lg-10 {
  margin-right: 0 !important;
  padding-right: 0 !important;
}

// Add consistent bottom margin to presentation list items
#presentation_list > div.col-lg-10 > div {
  margin-bottom: 2rem !important;
}

// Reduce margin above presentation button links
#presentation_list > div.col-lg-10 > div > div.media-body > div.btn-links {
  margin-top: 0.6rem !important;
  font-size: 1.05rem !important;
}

#presentation_list > div.col-lg-10 > div > div.media-body > div.btn-links * {
  font-size: 1.05rem !important;
}

// Remove link underline in presentation buttons
#presentation_list > div.col-lg-10 > div > div.media-body > div.btn-links > a {
  text-decoration: none !important;
}

// Light font color in dark theme for presentation buttons
body.dark #presentation_list > div.col-lg-10 > div > div.media-body > div.btn-links {
  color: #e2e8f0 !important;
}

body.dark #presentation_list > div.col-lg-10 > div > div.media-body > div.btn-links > a {
  color: #e2e8f0 !important;
}

// Move down all section images on home page
div > div > div > div > div.ml-3 > a > img {
  margin-top: 1.5rem !important;
}

// Increase font size of stream metadata
div > div > div > div > div.media-body > div.stream-meta.article-metadata > div {
  font-size: 0.8rem !important;
  margin-top: 0.3rem !important;
}

div > div > div > div > div.media-body > div.stream-meta.article-metadata > div > span {
  font-size: 0.8rem !important;
}

div > div > div > div > div.media-body > div.stream-meta.article-metadata > div > span > span {
  font-size: 0.8rem !important;
}

div > div > div > div > div.media-body > div.stream-meta.article-metadata > div > span > span > strong {
  font-size: 0.8rem !important;
}

div > div > div > div > div.media-body > div.stream-meta.article-metadata > div > span.pub-publication {
  font-size: 0.8rem !important;
}

div > div > div > div > div.media-body > div.stream-meta.article-metadata > div > span.pub-publication > em {
  font-size: 0.8rem !important;
}

div > div > div > div > div.media-body > div.stream-meta.article-metadata > div > span.article-date {
  font-size: 0.8rem !important;
}

// Mobile navbar icon positioning
@media (max-width: 1199px) {
  .navbar-toggler {
    margin-left: -1.5rem !important;
  }
  
  .navbar-nav.ml-auto {
    margin-right: -1rem !important;
  }
}

// Mobile navbar icon positioning
@media (max-width: 1199px) {
  .navbar-toggler {
    margin-left: -1.5rem !important;
  }
  
  .navbar-nav.ml-auto {
    margin-right: -1.5rem !important;
  }
}

// Reduce top margin on featured image container
div:has(> img.featured-image) {
  margin-top: -5%;
}

@media (max-width: 991px) {
  .pub div:has(> img.featured-image) {
    margin-top: 0;
  }
  
  // Decrease top padding on featured-image-wrapper in tablet/mobile
  #top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 {
    padding-top: 0 !important;
    margin-top: 0.5rem !important;
  }
  
  // Increase article-metadata size in mobile view
  .article-metadata,
  .article-metadata * {
    font-size: 0.8rem !important;
  }
}

// Ensure immediate dark theme application only when dark class is present
body.dark {
  background-color: #0f172a;
  color: #e2e8f0;
}

// CSS Custom Properties for Light/Dark Theme Support
:root {
  // Light theme colors (default)
  --text-primary: #00032F;
  --text-secondary: darkgrey;
  --text-tertiary: #4F6C89;
  --text-quaternary: #24494F;
  --text-visited: purple;
  --text-hover: black;
  --text-active: #24494F;
  
  // Navigation colors (INVERTED - light theme uses dark theme colors)
  --nav-text: #cbd5e1;
  --nav-hover: #A5D9C5; // Custom mint green for hover underline (from dark mode)
  --nav-active: #06b6d4; // Bright cyan for active text - better contrast on light navbar
  --nav-link: #67e8f9; // Cyan (from dark theme)
  --nav-hover-text: #A5D9C5; // Custom mint green for hover text (from dark mode)
  
  // Background colors
  --bg-highlight: #EAFFE8;
  --bg-button: #F8F8F8;
  --bg-button-secondary: #F7F7F7;
  --bg-button-hover: #E6FFE3;
  --bg-tag: #F3F3F3;
  --bg-tag-visited: #F7F1FF;
  --bg-tag-hover: #E6FFE3;
  --bg-profile-gradient: #E6FFE3;
  --bg-warning: #F6F7E4;
  --bg-script-container: white;
  --bg-full-text: white;
  --bg-full-text-hover: #f0fdf4;
  --bg-cv: #fff7ec;
  --bg-cv-hover: #f0e6d2;
  
  // Border colors
  --border-color: lightgrey;
  --border-warning: #6B6F0F;
  --border-full-text: #4CAF50;
  --border-full-text-hover: #388e3c;
  --border-cv: #196F27;
  --border-cv-hover: #145a20;
  
  // Accent colors
  --accent-primary: #379E8A;
  --accent-secondary: #57a292;
  --accent-tertiary: #8AA3CD;
  --accent-quaternary: #96666f;
  --accent-visited-categories: #9E84B0;
  
  // Special backgrounds and gradients
  --gradient-light: linear-gradient(180deg, #ffffe2, #ffffeb, #fffff5, #fffff5, #fffff5, #fffff5, #BAF1B7);
  --gradient-section-border: linear-gradient(to right, #BADDD5, #BADDD5, #EAF7F3, #F2FBF8);
  --gradient-script: linear-gradient(135deg, #d7e3e0);
  --gradient-script-hover: linear-gradient(135deg, #d3f3e9, #a9e3c9);
  
  // Animation colors
  --anim-start: aquamarine;
  --anim-mid: #088F8F;
  --anim-end-1: #8FABA6;
  --anim-end-2: #8AA3CD;
  --anim-end-3: #96666f;
  
  // Utility colors
  --color-red: red;
  --color-white: white;
  --color-black: black;
  --text-warning: #4A4D10;
  --related-references: #787878;
  --scrollbar-thumb: #57a292;
  --scrollbar-track: #edf5f4;
}

// Dark theme color overrides
// =================================================================================
// Color Conversion System: Light  Dark Theme Mappings
// 
// Light Theme Color  Dark Theme Equivalent:
// #006400 (dark green)  #32cd32 (lime green) - Better visibility on dark backgrounds
// #5f9ea0 (dark aquamarine)  #5f9ea0 (same) - Already works well on dark
// #00ff00 (bright green)  #00ff00 (same) - High contrast works on both themes
// darkgrey  #94a3b8 (slate blue-grey) - Softer on dark backgrounds
// #79A990 (muted teal)  #67e8f9 (cyan) - Brighter for dark theme visibility
//
// Conversion Principles:
// 1. Dark colors  Lighter equivalents for dark backgrounds
// 2. Maintain color family relationships (green stays green)
// 3. Ensure adequate contrast ratios for accessibility
// 4. Preserve semantic meaning across themes
// =================================================================================

body.dark {
  --text-primary: #e2e8f0;
  --text-secondary: #94a3b8;
  --text-tertiary: #a0b3cc;
  --text-quaternary: #cbd5e1;
  --text-visited: #d8b4fe;
  --text-hover: #f1f5f9;
  --text-active: #cbd5e1;
  
  // Navigation colors for dark theme (INVERTED - uses light theme colors)
  --nav-text: #475569;
  --nav-hover: #00ff00; // Green for hover underline (from light theme)
  --nav-active: #0d9488; // Darker teal for active - better contrast on dark navbar
  --nav-link: #79A990; // Muted teal (from light theme)
  --nav-hover-text: #006400; // Dark green for hover text (from light theme)
  
  // Background colors for dark theme (converted for dark mode)
  --bg-highlight: rgba(72, 187, 120, 0.2); // Green highlight with low opacity for dark
  --bg-button: #374151;
  --bg-button-secondary: #4b5563;
  --bg-button-hover: rgba(72, 187, 120, 0.3); // Green hover background (converted from light theme)
  --bg-tag: #374151;
  --bg-tag-visited: #4c1d95;
  --bg-tag-hover: rgba(72, 187, 120, 0.25); // Subtle green hover (converted)
  --bg-profile-gradient: rgba(72, 187, 120, 0.2); // Green gradient for dark theme
  --bg-warning: #422006;
  --bg-script-container: #1f2937;
  --bg-full-text: #374151;
  --bg-full-text-hover: rgba(72, 187, 120, 0.15); // Subtle green hover (converted from light)
  --bg-cv: #422006;
  --bg-cv-hover: #451a03;
  
  // Border colors for dark theme (converted equivalents)
  --border-color: #4b5563;
  --border-warning: #a16207;
  --border-full-text: aquamarine; // High contrast accent
  --border-full-text-hover: #16a34a; // Darker green  brighter green conversion
  --border-cv: aquamarine; // High contrast accent  
  --border-cv-hover: #16a34a; // Darker green  brighter green conversion
  
  // Accent colors for dark theme
  --accent-primary: #22d3ee;
  --accent-secondary: #06b6d4;
  --accent-tertiary: #60a5fa;
  --accent-quaternary: #e998c2;
  --accent-visited-categories: #c084fc;
  
  // Special backgrounds and gradients for dark theme
  --gradient-light: linear-gradient(180deg, rgba(72, 187, 120, 0.12), rgba(72, 187, 120, 0.08), rgba(72, 187, 120, 0.05));
  --gradient-section-border: linear-gradient(to right, #374151, #4b5563, #6b7280);
  --gradient-script: linear-gradient(135deg, #374151);
  --gradient-script-hover: linear-gradient(135deg, rgba(72, 187, 120, 0.25), rgba(72, 187, 120, 0.15));
  
  // Animation colors for dark theme
  --anim-start: aquamarine;
  
  // Utility colors for dark theme
  --color-red: #ef4444;
  --color-white: #1f2937;
  --color-black: #f8fafc;
  --text-warning: #fbbf24;
  --related-references: #94a3b8;
  --scrollbar-thumb: #06b6d4;
  --scrollbar-track: #374151;
}

// General dark theme color overrides for custom colors and classes
body.dark {
  // Override common custom colors used in content
  * {
    // Override specific hex colors commonly used for TEXT
    &[style*="#665F5F"], &[style*="#665f5f"] {
      color: #94a3b8 !important;
    }
    &[style*="#333"], &[style*="#333333"] {
      color: #cbd5e1 !important;
    }
    &[style*="#666"], &[style*="#666666"] {
      color: #94a3b8 !important;
    }
    &[style*="#000"], &[style*="#000000"] {
      color: #f1f5f9 !important;
    }
    &[style*="color: black"] {
      color: #f1f5f9 !important;
    }
    &[style*="color: grey"], &[style*="color: gray"] {
      color: #94a3b8 !important;
    }
    &[style*="color: darkgrey"], &[style*="color: darkgray"] {
      color: #64748b !important;
    }
    
    // Override BACKGROUND colors for nesting elements
    &[style*="background-color: white"], &[style*="background-color: #ffffff"], &[style*="background-color: #fff"], &[style*="background: white"], &[style*="background: #ffffff"], &[style*="background: #fff"] {
      background-color: #1f2937 !important;
    }
    &[style*="background-color: #f"], &[style*="background: #f"] {
      background-color: #374151 !important;
    }
    &[style*="background-color: #e"], &[style*="background: #e"] {
      background-color: #4b5563 !important;
    }
    &[style*="background-color: #d"], &[style*="background: #d"] {
      background-color: #6b7280 !important;
    }
    &[style*="background-color: lightgray"], &[style*="background-color: lightgrey"], &[style*="background: lightgray"], &[style*="background: lightgrey"] {
      background-color: #4b5563 !important;
    }
    &[style*="background-color: gray"], &[style*="background-color: grey"], &[style*="background: gray"], &[style*="background: grey"] {
      background-color: #6b7280 !important;
    }
    
    // Override common light background colors
    &[style*="background-color: #F8F8F8"], &[style*="background: #F8F8F8"] {
      background-color: #374151 !important;
    }
    &[style*="background-color: #F0F0F0"], &[style*="background: #F0F0F0"] {
      background-color: #4b5563 !important;
    }
    &[style*="background-color: #EEEEEE"], &[style*="background: #EEEEEE"] {
      background-color: #4b5563 !important;
    }
    &[style*="background-color: #E0E0E0"], &[style*="background: #E0E0E0"] {
      background-color: #6b7280 !important;
    }
    
    // Override border colors for nesting elements
    &[style*="border-color: #"], &[style*="border: 1px solid #"] {
      border-color: #6b7280 !important;
    }
    &[style*="border-color: lightgray"], &[style*="border-color: lightgrey"] {
      border-color: #6b7280 !important;
    }
  }
  
  // Specific class overrides
  .course {
    color: #cbd5e1 !important;
  }
  
  .institution {
    color: #94a3b8 !important;
  }
  
  // Override any remaining dark colors
  [class*="text-dark"], .text-dark {
    color: #f1f5f9 !important;
  }
  
  [class*="text-black"], .text-black {
    color: #f1f5f9 !important;
  }
  
  [class*="text-grey"], .text-grey, [class*="text-gray"], .text-gray {
    color: #94a3b8 !important;
  }
  
  // Override background classes for nesting elements
  [class*="bg-white"], .bg-white {
    background-color: #1f2937 !important;
  }
  
  [class*="bg-light"], .bg-light {
    background-color: #374151 !important;
  }
  
  [class*="bg-gray"], .bg-gray, [class*="bg-grey"], .bg-grey {
    background-color: #4b5563 !important;
  }
  
  // Common Bootstrap and utility classes
  .card {
    background-color: #374151 !important;
    border-color: #6b7280 !important;
  }
  
  .table {
    background-color: #1f2937 !important;
    color: #e2e8f0 !important;
  }
  
  .table td, .table th {
    border-color: #6b7280 !important;
  }
  
  // Override any remaining problematic backgrounds
  div[style*="background"], span[style*="background"], p[style*="background"] {
    // Only override if it contains light colors
    &[style*="#f"], &[style*="#e"], &[style*="#d"], &[style*="white"] {
      background-color: #374151 !important;
    }
  }
  
  // Smart link color adaptation based on parent background
  // For dark backgrounds (now converted), use light links
  [style*="background-color: #1"], [style*="background-color: #2"], [style*="background-color: #3"], [style*="background-color: #4"],
  [style*="background: #1"], [style*="background: #2"], [style*="background: #3"], [style*="background: #4"],
  .bg-dark a, .bg-primary a, .bg-secondary a, .alert-dark a, [class*="bg-dark"] a,
  .card a, .table a {
    color: #bfdbfe !important;
    
    &:hover {
      color: #dbeafe !important;
      background-color: rgba(59, 130, 246, 0.2) !important;
    }
    
    &:visited {
      color: #c7d2fe !important;
    }
  }
  
  // For elements that still have light backgrounds (edge cases), use darker links  
  [style*="background-color: #f"], 
  [style*="background-color: #e"],
  [style*="background: #f"],
  [style*="background: #e"] {
    // Only apply if the background wasn't already converted
    &:not([style*="background-color: #374151"]):not([style*="background-color: #4b5563"]) {
      a {
        color: #1e40af !important;
        
        &:hover {
          color: #1d4ed8 !important;
          background-color: rgba(59, 130, 246, 0.1) !important;
        }
        
        &:visited {
          color: #6366f1 !important;
        }
      }
    }
  }
  
  // For colored alert boxes and special containers
  .alert a,
  .card a,
  .badge a,
  [class*="bg-"] a:not([class*="bg-transparent"]) {
    // High contrast links for any colored background
    color: #bfdbfe !important;
    text-decoration: underline;
    
    &:hover {
      color: #dbeafe !important;
      opacity: 0.9;
      text-decoration: none;
    }
    
    &:visited {
      color: #c7d2fe !important;
    }
  }
  
  // Additional conversions for common problematic elements
  // Code blocks and pre elements
  code, pre {
    background-color: #1e293b !important;
    color: #e2e8f0 !important;
    border-color: #6b7280 !important;
  }
  
  // Blockquotes and quotes
  blockquote {
    background-color: #374151 !important;
    border-left-color: #6b7280 !important;
    color: #e2e8f0 !important;
  }
  
  // Form elements
  input, textarea, select {
    background-color: #374151 !important;
    color: #e2e8f0 !important;
    border-color: #6b7280 !important;
  }
  
  // Bootstrap Alert components
  .alert {
    background-color: #374151 !important;
    color: #e2e8f0 !important;
    border-color: #6b7280 !important;
  }
  
  .alert-success {
    background-color: #065f46 !important;
    color: #d1fae5 !important;
    border-color: #10b981 !important;
  }
  
  .alert-info {
    background-color: #1e3a8a !important;
    color: #dbeafe !important;
    border-color: #3b82f6 !important;
  }
  
  .alert-warning {
    background-color: #92400e !important;
    color: #fef3c7 !important;
    border-color: #f59e0b !important;
  }
  
  .alert-danger {
    background-color: #991b1b !important;
    color: #fecaca !important;
    border-color: #ef4444 !important;
  }
  
  .alert-light {
    background-color: #374151 !important;
    color: #e2e8f0 !important;
    border-color: #6b7280 !important;
  }
  
  .alert-dark {
    background-color: #1f2937 !important;
    color: #f3f4f6 !important;
    border-color: #4b5563 !important;
  }
  
  // Alert links should be properly styled
  .alert a, .alert .alert-link {
    color: inherit !important;
    text-decoration: underline !important;
    font-weight: bold !important;
    
    &:hover {
      opacity: 0.8 !important;
      text-decoration: none !important;
    }
  }
  
  // Any remaining light-colored divs or spans with text
  div, span, p {
    // Override if they have inline styles with light backgrounds
    &[style*="background-color: #F"] {
      background-color: #374151 !important;
    }
    &[style*="background-color: #E"] {
      background-color: #4b5563 !important;
    }
    &[style*="background-color: #D"] {
      background-color: #6b7280 !important;
    }
  }
  
  // Enhanced link visibility for dark theme with green underlines
  // Only apply to content areas, exclude navigation, buttons, and UI elements
  .article-container p a:link, 
  .article-container ul a:link, 
  .article-container li a:link, 
  .article-container div a:link:not(.btn):not(.badge), 
  .article-container td a:link, 
  .article-style a:link,
  .pub-abstract a:link,
  .hanging-indent a:link,
  .related-references a:link,
  main p a:link,
  main ul a:link,
  main li a:link,
  main div a:link:not(.btn):not(.badge),
  section p a:link,
  section ul a:link, 
  section li a:link,
  section div a:link:not(.btn):not(.badge),
  a.dsq-brlink {
    text-decoration: underline;
    text-decoration-color: #bbf7d0;
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
  }

  .article-container h3 a:visited, 
  .article-container div a:visited:not(.btn):not(.badge), 
  .article-container p a:visited, 
  .article-container ul a:visited, 
  .article-container li a:visited, 
  .article-container td a:visited, 
  .article-style a:visited,
  .pub-abstract a:visited,
  .hanging-indent a:visited,
  .related-references a:visited,
  main p a:visited,
  main ul a:visited,
  main li a:visited,
  main div a:visited:not(.btn):not(.badge),
  section p a:visited,
  section ul a:visited, 
  section li a:visited,
  section div a:visited:not(.btn):not(.badge),
  a.dsq-brlink:visited, 
  a:visited > code {
    text-decoration: underline;
    text-decoration-color: #bbf7d0;
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
  }

  .article-container p a:hover, 
  .article-container ul a:hover, 
  .article-container li a:hover, 
  .article-container div a:hover:not(.btn):not(.badge), 
  .article-container td a:hover, 
  .article-style a:hover,
  .pub-abstract a:hover,
  .hanging-indent a:hover,
  .related-references a:hover,
  main p a:hover,
  main ul a:hover,
  main li a:hover,
  main div a:hover:not(.btn):not(.badge),
  section p a:hover,
  section ul a:hover, 
  section li a:hover,
  section div a:hover:not(.btn):not(.badge),
  a.dsq-brlink:hover, 
  .article-container h3 > a:hover, 
  a:hover > code {
    text-decoration: underline;
    text-decoration-color: #22c55e;
    text-decoration-thickness: 2px;
    text-underline-offset: 2px;
  }

  // Content area headings - remove green underlines since they're now excluded above
  // (These were previously styled but are now explicitly excluded)

  // Category links removed from green underlining - now handled by exclusion rules above

  // Tag cloud links - no green underlines, just normal hover behavior
  .tag-cloud > a:hover {
    text-decoration: none;
    color: var(--text-quaternary);
  }

  // Explicitly remove green underlines from navigation, buttons, and UI elements
  .navbar a, 
  .nav a, 
  .btn, 
  .badge,
  .btn-links a,
  .navbar-nav a,
  #navbar-main a,
  #navbar-content a,
  .section-heading a,
  .portrait-title a,
  .social-icon a,
  .btn-outline-primary,
  button,
  .js-dark-toggle a,
  h2 a,
  h3 a,
  h4 a,
  .cv-btn,
  .cv-btn a,
  .article-categories a,
  .tag-cloud a {
    text-decoration: none !important;
    text-decoration-color: transparent !important;
  }

  // Remove green underlines from button hover states too
  .navbar a:hover, 
  .nav a:hover, 
  .btn:hover, 
  .badge:hover,
  .btn-links a:hover,
  .navbar-nav a:hover:not(.js-dark-toggle),
  #navbar-main a:hover:not(.js-dark-toggle),
  #navbar-content a:hover,
  .section-heading a:hover,
  .portrait-title a:hover,
  .social-icon a:hover,
  .btn-outline-primary:hover,
  button:hover:not(.read-more-btn),
  .js-dark-toggle a:hover,
  h2 a:hover,
  h3 a:hover,
  h4 a:hover,
  .cv-btn:hover,
  .cv-btn a:hover,
  .article-categories a:hover,
  .tag-cloud a:hover {
    text-decoration: none !important;
    text-decoration-color: transparent !important;
  }

  // Add white background behind images in dark theme for better text visibility
  img {
    background-color: white;
    padding: 2px;
    border-radius: 4px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }

  // Exceptions for images that should not have white backgrounds
  .navbar img,
  .social-icon img,
  .portrait img,
  .navbar-brand img,
  .imageContainer img,
  .imageModal-content,
  [class*="logo"] img,
  [class*="icon"] img,
  .avatar img {
    background-color: transparent !important;
    padding: 0 !important;
    border-radius: 0 !important;
    box-shadow: none !important;
  }
  
  // Keep avatar-circle round - override the border-radius: 0 rule above
  .avatar.avatar-circle img,
  .avatar-circle img {
    border-radius: 50% !important;
  }
}


// On scroll and only in desktop view, highlight section headings, tags in articles, bio info (name, title, email, socials), and the tag cloud at the bottom of the site. This work depends on CSS code in custom.scss, and JS code in academic.js.

@media (min-width: 992px) {
  
  div.col-12.col-lg-4.section-heading, div.col-12.col-lg-4.section-heading > h1, div.article-container.pt-3 > div.btn-links.mb-3 > a:link, div.btn-links.mb-3 > button, button > h3, .portrait-title > h3, .social-icon, .tag-cloud a:link, #top > div.pub > div > a > button {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.03s ease-in-out;
  }
  

  div.col-12.col-lg-4.section-heading.visible, div.col-12.col-lg-4.section-heading > h1.visible {
    opacity: 1;
    transform: translateY(0);
    animation: color-transition1 2s forwards;
  }
  
  @keyframes color-transition1 {
    0% {
      color: var(--anim-start);
    }
    33% {
      color: var(--anim-mid);
    }
    66% {
      color: var(--anim-end-1);
    }
    100% {
      color: var(--text-secondary);
    }
  }
  
  
  div.article-container.pt-3 > div.btn-links.mb-3 > a:link.visible, button.visible, button > h3.visible, div.btn-links.mb-3 > button.visible, #top > div.pub > div > a > button.visible {
    opacity: 1;
    transform: translateY(0);
    animation: color-transition2 1.5s forwards;
  }
  
  @keyframes color-transition2 {
    0% {
      color: var(--anim-start);
    }
    33% {
      color: var(--anim-mid);
    }
    66% {
      color: var(--anim-end-1);
    }
    100% {
      color: var(--text-hover);
    }
  }
  
  
  .portrait-title > h3.visible, .social-icon.visible {
    opacity: 1;
    transform: translateY(0);
    animation: color-transition3 1.5s forwards;
  }
  
  @keyframes color-transition3 {
    0% {
      color: var(--anim-start);
    }
    33% {
      color: var(--anim-mid);
    }
    66% {
      color: var(--anim-end-1);
    }
    100% {
      color: var(--accent-tertiary);
    }
  }
  
  
  .tag-cloud > a:link.visible {
    opacity: 1;
    transform: translateY(0);
    animation: color-transition4 5s forwards;
  }
  
  @keyframes color-transition4 {
    0% {
      color: var(--anim-start);
    }
    33% {
      color: var(--anim-mid);
    }
    66% {
      color: var(--anim-end-1);
    }
    100% {
      color: var(--accent-quaternary);
    }
  }

}

// Mobile scroll animations - optimized for fast, responsive mobile performance
@media (max-width: 991px) {
  
  // Section headings: NO ANIMATION on mobile - instant visibility
  div.col-12.col-lg-4.section-heading, 
  div.col-12.col-lg-4.section-heading > h1 {
    opacity: 1 !important; // Always visible
    transform: none !important; // No transform effects
    transition: none !important; // No transitions
    animation: none !important; // No animations
    display: block !important; // Force display
    visibility: visible !important; // Force visibility
  }
  
  // Other elements: keep minimal animations for subtle effect
  div.article-container.pt-3 > div.btn-links.mb-3 > a:link, 
  div.btn-links.mb-3 > button, 
  button > h3, 
  .portrait-title > h3, 
  .social-icon,
  #top > div.pub > div > a > button {
    opacity: 0;
    transform: translateY(10px); // Reduced movement for snappy mobile animation
    transition: all 0.15s ease-out; // Much faster transition for immediate response
  }
  
  // Mobile button links animation - quick and snappy
  div.article-container.pt-3 > div.btn-links.mb-3 > a:link.visible, 
  button.visible, 
  button > h3.visible, 
  div.btn-links.mb-3 > button.visible, 
  #top > div.pub > div > a > button.visible {
    opacity: 1;
    transform: translateY(0);
    animation: mobile-color-transition2 0.4s forwards; // Very fast for immediate button visibility
  }
  
  @keyframes mobile-color-transition2 {
    0% {
      color: var(--anim-start);
    }
    50% {
      color: var(--anim-mid);
    }
    100% {
      color: var(--text-hover);
    }
  }
  
  // Mobile bio/profile elements animation - instant response
  .portrait-title > h3.visible, 
  .social-icon.visible {
    opacity: 1;
    transform: translateY(0);
    animation: mobile-color-transition3 0.4s forwards; // Fast profile element animation
  }
  
  @keyframes mobile-color-transition3 {
    0% {
      color: var(--anim-start);
    }
    50% {
      color: var(--anim-mid);
    }
    100% {
      color: var(--accent-tertiary);
    }
  }

}


// Profile subsections

#profile > div:nth-child(5) > div > ul {
  margin-bottom: 1.5rem !important;
}

#profile > div:nth-child(5) > div > ul > div> div > a:link, #profile > div:nth-child(5) > div > ul > div> div > a {
  margin-right: -10px;
}

#profile > div:nth-child(5) > div > ul > div> div > a:link, #profile > div:nth-child(5) > div > ul > div> div > a:visited {
  color: var(--text-secondary);
  background-color: transparent;
  display: block;
  padding-left: 0.5em;
  padding-right: 0.5em;
  background: linear-gradient(var(--bg-profile-gradient) 0 0) var(--p, 0) / var(--p, 0) no-repeat;
  transition: 0.4s, background-position 0s;
}

#profile > div:nth-child(5) > div > ul > div> div > a:hover {
  color: var(--text-hover);
}

.profile-subsection:hover {
  --p: 100%;
}

// Interests
#profile > div:nth-child(4) {
  padding-top: 0 !important;
  margin-top: -0.5rem !important;
}

#profile > div:nth-child(5) {
  padding-top: 0 !important;
  margin-top: -1rem !important;
}

#profile > div:nth-child(4) > div {
  color: var(--text-secondary);
}

// Center Interests and Subsections divs in bio section without centering text
#bio .col-lg-4 #profile > div:nth-child(4),
#bio .col-lg-4 #profile > div:nth-child(5) {
  display: flex !important;
  justify-content: center !important;
}

#bio .col-lg-4 #profile > div:nth-child(4) > div,
#bio .col-lg-4 #profile > div:nth-child(5) > div {
  text-align: left !important;
  width: fit-content !important;
}

// Center the Interests title
#bio .col-lg-4 #profile > div:nth-child(4) > h3 {
  text-align: center !important;
  width: 100% !important;
}

// unvisited link
p a:link, ul a:link, li a:link, .article-container a:link, td a:link, a.dsq-brlink, div.grid-sizer > div > a {
  color: var(--text-primary);
}

// visited link
h3 a:visited, div a:visited, p a:visited, ul a:visited, li a:visited, .article-container a:visited, td a:visited, a.dsq-brlink:visited, div.grid-sizer > div > a:visited, a:visited > code {
  color: var(--text-visited); 
  background-color: transparent;
}

// mouse over link
p a:hover:not(.view-complete-content-btn), ul a:hover:not(.view-complete-content-btn), li a:hover:not(.view-complete-content-btn), .article-container a:hover:not(.view-complete-content-btn), td a:hover:not(.view-complete-content-btn), a.dsq-brlink:hover, div.grid-sizer > div > a:hover:not(.view-complete-content-btn), #top > div.pub > div > div > div.col-md-10 > div > div.col-12.col-md-9 > a:hover:not(.view-complete-content-btn), h3 > a:hover:not(.view-complete-content-btn), #top a:hover:not(.view-complete-content-btn), a:hover > code {
  background-image: none; // necessary to override `p a:link` property
  color: var(--text-hover);
  background-color: var(--bg-highlight);
  text-decoration: none;
}

// Exception: no background highlight for links inside full-text-btn
.full-text-btn a:hover,
.full-text-btn h3 > a:hover,
.full-text-btn:hover a,
.full-text-btn:hover h3 > a {
  background-color: transparent !important;
  background-image: none !important;
  background: none !important;
}

// active link
h3 a:active, div a:active, p a:active, ul a:active, li a:active, .article-container a:active, td a:active, a.dsq-brlink:active {
  color: var(--text-active); 
}

// background colour for links (excluding view-complete-content buttons)
p a:link:not(.view-complete-content-btn), 
td a:link:not(.view-complete-content-btn), 
div.grid-sizer > div > a:not(.view-complete-content-btn), 
#top > div.pub > div > div > div.col-md-10 > div > div.col-12.col-md-9 > a:not(.view-complete-content-btn), 
h3 > a:not(.view-complete-content-btn), 
h4 > a:not(.view-complete-content-btn), 
h5 > a:not(.view-complete-content-btn), 
a > code {
  background-image: var(--gradient-light);
}

// Force remove background-image from view-complete-content buttons
a.view-complete-content-btn,
.view-complete-content-btn,
button.view-complete-content-btn {
  background: none !important;
  background-image: none !important;
  margin-top: 1.5rem !important;
  margin-bottom: -1rem !important;
}

/* Remove link highlight from general links in home 
and from bio portrait information. */

// Navigation bar

// Light theme navbar background (INVERTED - uses dark theme colors)
.navbar {
  background-color: #1e293b !important;
  border-bottom: none !important;
  box-shadow: none !important;
  height: 55px !important;
  min-height: 55px !important;
  max-height: 55px !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
  z-index: 1030 !important;
  position: fixed !important;
  overflow: visible !important;
  overflow-y: visible !important;
  overflow-x: visible !important;
  transition: transform 0.01s linear !important;
  width: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  pointer-events: none !important; /* Allow scroll events to pass through */
  font-size: #{"clamp(1.05rem, 0.5vw + 0.7rem, 1.1rem)"} !important; /* Responsive navbar font */
  color: #cbd5e1 !important;
}

// Light theme navbar text and icons (use light colors on dark navbar background)
.navbar-brand {
  color: #94a3b8 !important;
}

.navbar-nav .nav-link,
#navbar-main,
#navbar-content,
.navbar-collapse {
  color: #cbd5e1 !important;
}

// Light theme navbar icons
.navbar-nav .nav-link i,
.nav-icons .nav-link i {
  color: #cbd5e1 !important;
}

// Light theme: Remove background color from nav items on hover (desktop view)
@media (min-width: 992px) {
  .navbar .nav-link:hover,
  .navbar .nav-item:hover,
  .navbar-nav .nav-link:hover,
  #navbar-content > ul > li > a:hover,
  #navbar-main .nav-link:hover {
    background-color: transparent !important;
    background: none !important;
  }
}

// Re-enable pointer events for interactive elements
.navbar a,
.navbar button:not(.js-font-size-toggle):not(.js-theme-toggle),
.navbar .navbar-brand,
.navbar .navbar-toggler,
.navbar .nav-link:not(.js-font-size-toggle):not(.js-theme-toggle),
.navbar .dropdown-toggle,
.navbar-collapse,
.navbar-nav {
  pointer-events: auto !important;
  overflow: visible !important;
}

/* Mobile: Ensure icon buttons have no background */
@media (max-width: 991px) {
  .navbar button.js-font-size-toggle,
  .navbar button.js-theme-toggle {
    background: transparent !important;
    background-color: transparent !important;
    background-image: none !important;
    border: 0 !important;
    box-shadow: none !important;
    outline: 0 !important;
  }
}

// Prevent any scrolling within navbar and its children
.navbar,
.navbar *,
.navbar-collapse,
.navbar-collapse *,
.navbar-nav,
.navbar-nav * {
  overflow: visible !important;
  overflow-x: visible !important;
  overflow-y: visible !important;
  max-height: none !important;
}

// Hide scrollbar in navbar for webkit browsers
.navbar::-webkit-scrollbar {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

.navbar *, .navbar-collapse *, .navbar-nav * {
  scrollbar-width: none !important;
  -ms-overflow-style: none !important;
}

.navbar *::-webkit-scrollbar,
.navbar-collapse *::-webkit-scrollbar,
.navbar-nav *::-webkit-scrollbar {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

// Force mobile hamburger menu at 991px (override Bootstrap navbar-expand-lg)
// This triggers the mobile menu earlier to prevent title wrapping and navbar-brand occlusion
@media (max-width: 991px) {
  .navbar-expand-lg .navbar-toggler {
    display: flex !important;
  }
  
  .navbar-expand-lg .navbar-collapse {
    display: none !important;
    position: fixed !important;
  }
  
  .navbar-expand-lg .navbar-collapse.show,
  .navbar-expand-lg .navbar-collapse.collapsing {
    display: block !important;
  }
}

// Mobile-specific navbar adjustments
@media (max-width: 991px) {
  // Prevent all tooltips, popovers, and hover effects in navbar area
  .navbar,
  .navbar * {
    pointer-events: auto !important;
  }
  
  .navbar .tooltip,
  .navbar .popover,
  .navbar [data-toggle="tooltip"],
  .navbar [data-toggle="popover"],
  .navbar [title]:hover::after,
  .navbar [title]:hover::before,
  body .tooltip,
  body .popover {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
  }
  
  .navbar [data-toggle="tooltip"],
  .navbar [data-toggle="popover"] {
    pointer-events: none !important;
  }
  
  .navbar {
    height: 50px !important;
    min-height: 50px !important;
    max-height: 50px !important;
    padding-left: 0.5rem !important;
    padding-right: 0.5rem !important;
    padding-top: 8px !important;
    padding-bottom: 0 !important;
    overflow: visible !important;
    display: flex !important;
    align-items: center !important;
    transition: transform 0s linear !important;
  }
  
  .navbar > .container,
  .navbar > .container-fluid {
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    display: flex !important;
    align-items: center !important;
    height: 100% !important;
  }
  
  .navbar-nav,
  .navbar-nav-right {
    align-items: center !important;
    margin-bottom: 0 !important;
    height: 100% !important;
  }
  
  .navbar-collapse {
    position: fixed !important;
    top: 50px !important;
    left: 0 !important;
    right: auto !important;
    width: 40% !important;
    min-width: 160px !important;
    max-width: 220px !important;
    background-color: #1e293b !important;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3) !important;
    z-index: 1020 !important;
    padding: 0 !important;
    margin: 0 !important;
    transition: all 0.2s ease-in-out !important;
    opacity: 1 !important;
  }
  
  .navbar-collapse.show {
    width: 40% !important;
    min-width: 160px !important;
    max-width: 220px !important;
    margin-left: 0 !important;
  }
  
  .navbar-collapse .navbar-nav {
    text-align: left !important;
    width: 100% !important;
    display: block !important;
    margin-left: 0 !important;
    padding-left: 0 !important;
  }
  
  .navbar-collapse .navbar-nav .nav-item {
    padding-right: 0 !important;
    padding-left: 0 !important;
    text-align: left !important;
    display: block !important;
    width: 100% !important;
    margin-left: 0 !important;
  }
  
  .navbar-collapse .navbar-nav .nav-link {
    text-align: left !important;
    display: block !important;
    width: 100% !important;
    padding: 0.5rem 0.3rem 0.5rem 0.5rem !important;
    margin: 0 !important;
    color: #cbd5e1 !important;
  }
  
  .navbar-collapse #navbar-content {
    color: #cbd5e1 !important;
    text-align: left !important;
  }
  
  .navbar-collapse #navbar-content > ul {
    text-align: center !important;
    display: block !important;
    width: 100% !important;
    color: #cbd5e1 !important;
  }
  
  .navbar-collapse .navbar-nav .nav-link i,
  .navbar-collapse .nav-icons .nav-link i {
    color: #cbd5e1 !important;
  }
  
  .navbar-collapse:not(.show) {
    display: none !important;
  }
  
  .navbar-collapse.collapsing {
    opacity: 0 !important;
    transition: all 0.2s ease-in-out !important;
  }
  
  body.dark .navbar-collapse {
    background-color: #e2e8f0 !important;
    box-shadow: 0 4px 6px rgba(0,0,0,0.2) !important;
  }
  
  .navbar-nav {
    padding: 0.25rem 0 !important;
  }
  
  // Reduce padding for mobile menu items
  .navbar-collapse #navbar-content > ul > li {
    padding: 0 !important;
    margin: 0 !important;
  }
  
  .navbar-collapse #navbar-content > ul > li > a {
    padding: 0.35rem -0.1rem 0.35rem 0.1rem !important;
  }
  
  // Remove background color on hover for mobile menu items
  .navbar-collapse .nav-link:hover,
  .navbar-collapse .navbar-nav .nav-link:hover,
  .navbar-collapse #navbar-content > ul > li > a:hover {
    background-color: transparent !important;
    background: none !important;
  }
  
  .navbar-brand {
    font-size: 1.2rem !important;
    padding: 0 !important;
    line-height: 1 !important;
    margin: 0 auto !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    position: absolute !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
  }
  
  // Very narrow mobile viewports: shift brand left to prevent icon overlap
  @media (max-width: 400px) {
    .navbar-brand {
      left: 45% !important;
      transform: translate(-45%, -50%) !important;
    }
  }
  
  @media (max-width: 350px) {
    .navbar-brand {
      left: 42% !important;
      transform: translate(-42%, -50%) !important;
    }
  }
  
  .navbar-brand img {
    max-height: 40px !important;
    margin: 0 !important;
  }
  
  .navbar-toggler {
    padding: 0.25rem 0.75rem !important;
    margin: 0 !important;
    margin-left: 0.08rem !important;
    display: flex !important;
    align-items: center !important;
  }
  
  .navbar-toggler .navbar-toggler-icon {
    width: 28px !important;
    height: 28px !important;
  }
  
  // Align right-side icons at same vertical level as other navbar content
  .navbar-nav-right,
  .nav-icons {
    display: flex !important;
    align-items: center !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  // Add right margin to icon container
  ul.nav-icons.navbar-nav {
    margin-right: -1rem !important;
    gap: 2rem !important;
  }
  
  @media (max-width: 991px) {
    ul.nav-icons.navbar-nav {
      margin-right: -0.4rem !important;
    }
  }
  
  // Reduce gap on mobile
  @media (max-width: 991px) {
    ul.nav-icons.navbar-nav {
      gap: 0.3rem !important;
    }
  }
  
  .navbar-nav-right .nav-item,
  .nav-icons .nav-item {
    display: flex !important;
    align-items: center !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  // Add margin between icons only (not on outer edges)
  .navbar-nav-right .nav-item:not(:last-child),
  .nav-icons .nav-item:not(:last-child) {
    margin-right: #{"clamp(0.8rem, 1vw, 0.5rem)"} !important;
  }
  
  // Very narrow mobile viewports: reduce margin between icons
  @media (max-width: 400px) {
    .navbar-nav-right .nav-item:not(:last-child),
    .nav-icons .nav-item:not(:last-child) {
      margin-right: #{"clamp(0.5rem, 0.8vw, 0.3rem)"} !important;
    }
  }
  
  @media (max-width: 350px) {
    .navbar-nav-right .nav-item:not(:last-child),
    .nav-icons .nav-item:not(:last-child) {
      margin-right: #{"clamp(0.3rem, 0.6vw, 0.2rem)"} !important;
    }
  }
  
  .navbar-nav-right .nav-item:first-child,
  .nav-icons .nav-item:first-child {
    margin-left: 50px !important;
  }
  
  .navbar-nav-right .nav-link,
  .nav-icons .nav-link {
    padding: 0.25rem 0.02rem !important;
    line-height: 1 !important;
    margin: 0 !important;
    display: flex !important;
    align-items: center !important;
  }
  
  /* Increase spacing between font size and theme icons in desktop view */
  @media (min-width: 992px) {
    .nav-icons .nav-item:nth-child(2) {
      margin-left: 0.8rem !important;
    }
    
    .nav-icons .nav-link.js-theme-toggle {
      margin-left: 0.8rem !important;
    }
    
    #navbar-main > div > ul > li:nth-child(2) {
      margin-left: 0.8rem !important;
    }
  }
  
  // Further reduce padding for specific navbar icon links
  #navbar-main > div > ul > li:nth-child(3) > a,
  #navbar-main > div > ul > li.nav-item.dropdown > a,
  #navbar-main > div > ul > li:nth-child(1) > a {
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  // Reduce padding on the li elements themselves
  #navbar-main > div > ul > li:nth-child(1),
  #navbar-main > div > ul > li.nav-item.dropdown {
    padding-right: 0 !important;
    padding-left: 0 !important;
  }
  
  /* In mobile view, use negative margins to move icons rightward */
  @media (max-width: 991px) {
    #navbar-main > div > ul > li:nth-child(1) {
      margin-right: 0.5rem !important;
    }
    
    #navbar-main > div > ul {
      margin-right: -0.5rem !important;
    }
    
    /* Zero out button padding in mobile */
    #navbar-main > div > ul > li:nth-child(1) > button,
    #navbar-main > div > ul > li.nav-item.dropdown.theme-dropdown > button {
      padding-left: 0 !important;
      padding-right: 0 !important;
    }
  }
  
  /* Increase right margin on font size icon in desktop view */
  @media (min-width: 992px) {
    #navbar-main > div > ul > li:nth-child(1) {
      margin-right: 1.2rem !important;
    }
  }
  
  // Override any general nav-link padding for icon links
  #navbar-main > div > ul > li:nth-child(1) > a.nav-link,
  #navbar-main > div > ul > li.nav-item.dropdown > a.nav-link {
    padding: 0.25rem 0 !important;
  }
  
  // Remove margin from last icon
  #navbar-main > div > ul > li.nav-item:last-child {
    margin-right: 0 !important;
  }
  
  .navbar-nav-right i,
  .navbar-nav-right svg,
  .nav-icons i,
  .nav-icons svg {
    font-size: 1.2rem !important;
    line-height: 1 !important;
    margin: 0 !important;
  }
  
  .navbar-nav .nav-link:not(.js-search):not(.js-dark-toggle):not([class*="dropdown"]) {
    padding-left: 0.75rem !important;
    padding-right: 0.75rem !important;
  }
}

// Force remove padding from navbar icon links (outside media query to apply everywhere)
#navbar-main > div > ul > li:nth-child(1),
#navbar-main > div > ul > li.nav-item.dropdown,
#navbar-main > div > ul > li:nth-child(3) {
  padding-right: 0 !important;
  padding-left: 0 !important;
}

#navbar-main > div > ul > li:nth-child(1) > a,
#navbar-main > div > ul > li.nav-item.dropdown > a,
#navbar-main > div > ul > li:nth-child(3) > a,
#navbar-main > div > ul > li:nth-child(1) > a.nav-link,
#navbar-main > div > ul > li.nav-item.dropdown > a.nav-link,
#navbar-main > div > ul > li:nth-child(3) > a.nav-link {
  padding-left: 0 !important;
  padding-right: 0 !important;
}

// Prevent navbar from hiding on mobile when menu is expanded
@media (max-width: 991px) {
  .navbar.hide-navbar {
    transform: translateY(0) !important;
  }
  
  .navbar-collapse.show ~ .navbar.hide-navbar,
  body:has(.navbar-collapse.show) .navbar.hide-navbar {
    transform: translateY(0) !important;
  }
}

// Prevent navbar from hiding when font-size or theme dropdown is open
body:has(.font-size-menu.show) .navbar.hide-navbar,
body:has(.theme-menu.show) .navbar.hide-navbar {
  transform: translateY(0) !important;
}

.navbar.hide-navbar {
  transform: translateY(-100%) !important;
}

.navbar::after {
  display: none !important;
  content: none !important;
}

// Remove any top spacing on body element
body, #top {
  padding-top: 0 !important;
  margin-top: 0 !important;
}

body::before, #top::before {
  display: none !important;
  content: none !important;
}

// Add spacing for page content below fixed navbar
section.home-section:first-of-type {
  margin-top: 55px !important;
  padding-top: 1rem !important;
}

@media (max-width: 991px) {
  section.home-section:first-of-type {
    margin-top: 70px !important;
    padding-top: 1rem !important;
  }
}

@media (max-width: 768px) {
  section.home-section:first-of-type {
    margin-top: 15px !important;
  }
}

@media (max-height: 800px) {
  section.home-section:first-of-type {
    margin-top: 70px !important;
  }
}

// Add margin above page titles to prevent navbar occlusion
.article-container,
.universal-wrapper {
  padding-top: 50px !important;
}

@media (max-width: 991px) {
  .article-container,
  .universal-wrapper {
    padding-top: 40px !important;
  }
}

// Adjust margins for universal-wrapper and article-container on individual pages
#top > div.universal-wrapper.pt-3 {
  margin-top: 0.8rem !important;
  margin-bottom: -2.5rem !important;
  padding-bottom: 0rem !important;
}

#top > article > div.article-container.pt-3 {
  margin-top: 0.8rem !important;
  margin-bottom: -1rem !important;
}

// Decrease top padding in article and div nth-child elements
#top > article > div:nth-child(2) {
  padding-top: 1.25rem !important;
}

#top > div:nth-child(4) {
  padding-top: 0 !important;
}

// Reduce margin above first publication title on home page (desktop)
@media (min-width: 992px) {
  #publication > div > div > div:nth-child(2) > div:nth-child(1) > div.media-body > h3 {
    margin-top: -0.5rem !important;
  }
}

// Reduce bottom margin for first publication container
#publication > div > div > div:nth-child(2) > div:nth-child(1) {
  margin-bottom: 1rem !important;
}

// White link color for featured image header in light theme
#top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 > div > span > a,
.pub .article-header.featured-image-wrapper .article-header-caption a {
  color: white !important;
}

// Increase margin above featured-image-wrapper in pub pages
#top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 {
  margin-top: 1.5rem !important;
  margin-bottom: 3.5rem !important;
}

// Override for publication pages: reduce bottom margin
html body.page-publication #top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 {
  margin-bottom: 1rem !important;
}

// Increase bottom margin for featured-image div
#top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 > div {
  margin-bottom: 3rem !important;
}

// Override for publication pages: reduce bottom margin for featured-image wrapper
html body.page-publication #top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 {
  margin-bottom: 1rem !important;
}

// Override for publication pages: reduce bottom margin for featured-image div
html body.page-publication #top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 > div {
  margin-bottom: 0.5rem !important;
}

// Override margin-bottom for presentation pages
html body.page-wrapper #top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 {
  margin-bottom: 4rem !important;
}

// Alternative: Add top margin to element after featured image on presentation pages
html body.page-wrapper #top > div.pub > div.article-header.featured-image-wrapper + div.article-container.pt-3 {
  margin-top: 6rem !important;
}

// Reduce margin under featured image in pub pages (except presentation pages)
html body.page-publication #top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 > div > img {
  margin-bottom: 0 !important;
}

// Reduce margin under featured-image itself on publication pages
html body.page-publication .featured-image {
  margin-bottom: -3.5rem !important;
}

// Increase margin above and below featured image on presentation pages
.page-wrapper #top > div.pub > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 > div > img {
  margin-top: 0.25rem !important;
  margin-bottom: 6rem !important;
}

// Increase margin above featured-image-wrapper in article pages
#top > article > div.article-header.article-container.featured-image-wrapper.mt-4.mb-4 {
  margin-top: 2.5rem !important;
}

// Reduce margin above and increase margin below featured-image on post pages
article .featured-image {
  margin-top: 0 !important;
  margin-bottom: 2rem !important;
}

// Mobile view: decrease margins for portrait-title h3
@media (max-width: 991px) {
  #profile > div.portrait-title > h3:nth-child(3) {
    margin-top: 0 !important;
    margin-bottom: 0 !important;
  }

  #profile > div:nth-child(3) {
    padding-top: 0.5rem !important;
    margin-top: -0.5rem !important;
    margin-bottom: -0.8rem !important;
  }

  #profile > img {
    margin-bottom: 0.5rem !important;
  }
}

// Reduce margin under profile image
#profile > img {
  margin-bottom: -0.5rem !important;
  margin-left: 0.1rem !important;
}

// Reduce profile width in desktop view to remove empty space
@media (min-width: 992px) {
  #profile {
    max-width: none !important;
    width: 100% !important;
    margin-left: 0 !important;
    margin-right: -5rem !important;
    padding-right: 0 !important;
    padding-left: 0 !important;
  }
}

// Set maximum negative margin for wide viewports
@media (min-width: 1200px) {
  #profile {
    margin-right: -6rem !important;
  }
}

// Reduce margin above portrait-title
#profile > div.portrait-title {
  margin-top: 0 !important;
}

// Reduce top padding/margin in portrait-title h2
#profile > div.portrait-title > h2 {
  margin-top: 0 !important;
  padding-top: 0 !important;
  margin-bottom: 0.3rem !important;
}

#profile > div.portrait-title > h3:nth-child(2) {
  margin-top: -0.2rem !important;
  margin-bottom: 0.3rem !important;
}

#profile > div.portrait-title > h3:nth-child(3) {
  margin-top: 0.1rem !important;
  margin-bottom: 0 !important;
}

#bio > div > div > div.col-12.col-lg-8 > div:nth-child(1) > a {
  margin-bottom: 1rem !important;
}

#profile > div:nth-child(3) > div {
  margin-top: -1rem !important;
}

@media (min-width: 992px) {
  #profile > div:nth-child(3) {
    margin-top: 1.5rem !important;
  }
}

#profile > div:nth-child(4) > div > h3 {
  margin-bottom: 0.3rem !important;
}

@media (min-width: 992px) {
  #profile > div:nth-child(4) > div > h3 {
    margin-top: 1.5rem !important;
  }
}

#profile > div:nth-child(5) > div > h3 {
  margin-bottom: 0.3rem !important;
  margin-top: 0.3rem !important;
}

#profile > div:nth-child(4) {
  margin-bottom: 0.5rem !important;
}

#profile > div:nth-child(4) > div > ul {
  padding-left: 1.3rem !important;
}

#profile > div:nth-child(4) > div > ul > li {
  padding-left: 0 !important;
}

// Reduce top padding in profile
#profile {
  padding-top: 0 !important;
  padding-bottom: 0.2rem !important;
  margin-top: -1rem !important;
  margin-bottom: -1rem !important;
}

#bio > div > div > div.col-12.col-lg-8 > div:nth-child(1) {
  margin-bottom: 1.5rem !important;
}

#bio > div > div > div.col-12.col-lg-8 > div.row > div:nth-child(1) > h3 {
  margin-top: 0.5rem !important;
}

#bio > div > div > div.col-12.col-lg-8 > div.row > div:nth-child(2) > h3:nth-child(1) {
  margin-top: 0.5rem !important;
}

#bio > div > div > div.col-12.col-lg-8 > div.row > div:nth-child(2) > h3:nth-child(3) {
  margin-top: 0.5rem !important;
}

#bio > div > div > div.col-12.col-lg-8 > div.row > div > ul > li > div > p.course {
  font-size: 1.1rem !important;
}

#bio > div > div > div.col-12.col-lg-8 > div.row > div > ul > li > div > p {
  color: #00032F !important;
  font-size: 1.1rem !important;
}

body.dark #bio > div > div > div.col-12.col-lg-8 > div.row > div > ul > li > div > p {
  color: #e2e8f0 !important;
}

// Direct bio paragraphs should match the same font size and color
#bio > div > div > div.col-12.col-lg-8 > p {
  font-size: 1.1rem !important;
  color: #00032F !important;
}

body.dark #bio > div > div > div.col-12.col-lg-8 > p {
  color: #e2e8f0 !important;
}

// Reduce margins above h2-h6 headings in blog posts
article.article h2,
article.article h3,
article.article h4,
article.article h5,
article.article h6 {
  margin-top: 1rem !important;
}

// Equalize h2 and h3 top margins globally (override _root.scss defaults)
h2,
h3 {
  margin-top: 1rem !important;
}

#blog > div > div > div:nth-child(2) > div > div.media-body.is-expanded > a {
  margin-bottom: 0.5rem !important;
  margin-top: 0.8rem !important;
}

#applications-and-dashboards > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata {
  margin-top: 0.3rem !important;
  margin-bottom: 0.3rem !important;
}

#applications-and-dashboards > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div {
  margin-top: 0 !important;
  font-size: 0.95rem !important;
}

#applications-and-dashboards > div > div > div:nth-child(2) > div > div.media-body.is-expanded > a {
  margin-top: 1rem !important;
}

// Increase margin above article-metadata in individual pages
#top > div:nth-child(4) > div > div.media-body > div.stream-meta.article-metadata > div {
  margin-top: 0.5rem !important;
}

// Decrease top padding in article nth-child(3)
#top > article > div:nth-child(3) {
  padding-top: 0 !important;
}

// Reduce margin above h3 headings in pub pages
#top > div.pub > div > h3 {
  margin-top: -2rem !important;
}

.article-title,
.page-title,
h1.article-title {
  margin-top: 0.5rem !important;
}

// Dark theme navbar background (INVERTED - uses light colors, contrasting with #0f172a page background)
body.dark .navbar {
  background-color: #e2e8f0 !important;
  border-bottom: none !important;
  box-shadow: none !important;
  color: #0f172a !important;
}

body.dark .navbar::after {
  display: none !important;
  content: none !important;
}

// Dark theme navbar brand and text (use very dark colors on light navbar background)
body.dark .navbar-brand {
  color: #334155 !important;
}

body.dark .navbar-nav .nav-link,
body.dark #navbar-main,
body.dark #navbar-content,
body.dark .navbar-collapse {
  color: #0f172a !important;
}

// Dark theme navbar icons
body.dark .navbar-nav .nav-link i,
body.dark .nav-icons .nav-link i {
  color: #0f172a !important;
}

// Dark theme font size dropdown (light background to match light navbar)
body.dark .font-size-menu {
  background: #e2e8f0 !important;
  border-color: rgba(0,0,0,0.15) !important;
}

body.dark .font-size-menu .dropdown-item {
  color: #0f172a !important;
}

body.dark .font-size-menu .dropdown-item:hover {
  background-color: #cbd5e1 !important;
  color: #0f172a !important;
}

body.dark .theme-menu {
  background: #e2e8f0 !important;
  border-color: rgba(0,0,0,0.15) !important;
}

body.dark .theme-menu .dropdown-item {
  color: #0f172a !important;
}

body.dark .theme-menu .dropdown-item:hover {
  background-color: #cbd5e1 !important;
  color: #0f172a !important;
}

// Center navbar-content (menu items) in desktop view
@media (min-width: 992px) {
  #navbar-main > .container,
  #navbar-main.navbar > .container,
  .navbar#navbar-main > .container,
  .navbar > .container,
  .navbar > .container-fluid {
    max-width: 993px !important;
    margin-left: auto !important;
    margin-right: auto !important;
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding-left: 15px !important;
    padding-right: 15px !important;
  }
  
  .navbar-collapse {
    flex-grow: 1 !important;
    display: flex !important;
    justify-content: center !important;
  }
  
  #navbar-content {
    display: flex !important;
    justify-content: center !important;
    margin: 0 !important;
    padding-left: 0 !important;
    flex-grow: 1 !important;
    text-align: center !important;
  }
  
  #navbar-content > ul {
    display: flex !important;
    justify-content: center !important;
    flex-wrap: nowrap !important;
    white-space: nowrap !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  #navbar-content > ul > li {
    white-space: nowrap !important;
    margin: 0 #{"clamp(0.01rem, 1vw, 0.3rem)"} !important;
  }
  
  /* Reduce spacing between navbar icon items in desktop */
  #navbar-main > div > ul.nav-icons > li:nth-child(1) {
    margin-right: 0.5rem !important;
  }
  
  /* Style button.nav-link to match anchor.nav-link exactly */
  button.nav-link {
    background: none !important;
    background-color: transparent !important;
    border: none !important;
    padding: 0.4rem 0.05rem !important;
    color: inherit !important;
    font-size: 0.9rem !important;
    line-height: 1.5 !important;
    display: inline-flex !important;
    align-items: center !important;
    vertical-align: middle !important;
    cursor: pointer !important;
    margin: 0 !important;
    height: 100% !important;
  }
  
  button.nav-link:hover,
  button.nav-link:focus {
    color: var(--nav-active) !important;
    outline: none !important;
    background: none !important;
    background-color: transparent !important;
  }
  
  /* Remove button backgrounds in mobile navbar */
  @media (max-width: 991px) {
    /* Nuclear option - target everything */
    .navbar button,
    .navbar button *,
    .nav-icons button,
    .nav-icons button *,
    button.nav-link,
    .nav-icons button.nav-link,
    ul.nav-icons li button,
    ul.nav-icons li button.nav-link,
    .navbar button.nav-link,
    .navbar-nav button,
    .navbar-nav button.nav-link {
      background: none !important;
      background-color: transparent !important;
      background-image: none !important;
      box-shadow: none !important;
      border: none !important;
      outline: none !important;
      -webkit-box-shadow: none !important;
      -webkit-appearance: none !important;
      padding: 0.5rem !important;
    }
    
    /* Absolute override for icon buttons */
    body .navbar button.js-font-size-toggle,
    body .navbar button.js-theme-toggle,
    body .nav-icons button.js-font-size-toggle,
    body .nav-icons button.js-theme-toggle {
      background: transparent !important;
      background-color: transparent !important;
      background-image: none !important;
      border: 0 !important;
      box-shadow: none !important;
      outline: 0 !important;
      -webkit-box-shadow: none !important;
      -webkit-appearance: none !important;
    }
    
    /* All button states */
    button.nav-link:hover,
    button.nav-link:focus,
    button.nav-link:active,
    button.nav-link:visited,
    button.nav-link::before,
    button.nav-link::after,
    .nav-icons button:hover,
    .nav-icons button:focus,
    .nav-icons button:active,
    .nav-icons button.nav-link:hover,
    .nav-icons button.nav-link:focus,
    .nav-icons button.nav-link:active {
      background: none !important;
      background-color: transparent !important;
      background-image: none !important;
      box-shadow: none !important;
      border: none !important;
      outline: none !important;
      -webkit-box-shadow: none !important;
      -webkit-appearance: none !important;
    }
    
    .navbar-collapse button.nav-link,
    .navbar-nav button.nav-link,
    .navbar-collapse .nav-icons button.nav-link,
    .navbar-nav .nav-icons button.nav-link {
      background: none !important;
      background-color: transparent !important;
      background-image: none !important;
      box-shadow: none !important;
      outline: none !important;
      -webkit-box-shadow: none !important;
      -webkit-appearance: none !important;
    }
    
    /* Remove from parent li elements */
    .nav-icons li.nav-item,
    .nav-icons li.nav-item.dropdown,
    .nav-icons li,
    .nav-icons li * {
      background: none !important;
      background-color: transparent !important;
      box-shadow: none !important;
      -webkit-box-shadow: none !important;
    }
    
    /* Override Bootstrap btn class if present */
    button.btn,
    .navbar button.btn {
      background: none !important;
      background-color: transparent !important;
      border: none !important;
      box-shadow: none !important;
      outline: none !important;
      -webkit-appearance: none !important;
    }
  }
  
  /* Ensure dropdown containers don't have gap */
  .nav-item.dropdown {
    position: relative !important;
  }
  
  .font-size-menu,
  .theme-menu {
    margin-top: 0 !important;
  }
  
  #navbar-content > ul > li > a,
  .navbar-nav .nav-link {
    font-size: 0.9rem !important;
  }
  
  // Increase modal width in desktop view
  .modal-dialog {
    max-width: 60vw !important;
    width: 60vw !important;
    margin: 1.75rem auto !important;
  }
}

// For smaller desktop screens, increase modal width further
@media (min-width: 992px) and (max-width: 1200px) {
  .modal-dialog {
    max-width: 95vw !important;
    width: 95vw !important;
  }
}

// Reduce margin under modal header
.modal-header {
  margin-bottom: 0 !important;
  padding-bottom: 0.25rem !important;
}

.modal-body {
  padding-top: 0.25rem !important;
  padding-bottom: 0.25rem !important;
}

.modal-footer {
  margin-top: 0 !important;
  padding-top: 0 !important;
}



// Navbar brand hover styling for both light and dark themes
.navbar-brand:hover {
  color: #5f9ea0 !important; // Dark aquamarine
  transition: color 0.3s ease;
  background-color: transparent !important;
  background: none !important;
}

body.dark .navbar-brand:hover {
  color: #5f9ea0 !important; // Dark aquamarine
  background-color: transparent !important;
  background: none !important;
}

// Balance navbar-brand spacing at desktop widths
@media (min-width: 992px) {
  .navbar-brand {
    margin-right: auto !important;
    padding-right: 1rem !important;
    margin-top: 0.1rem !important;
  }
  
  // Place navbar icons with balanced spacing (desktop)
  @media (min-width: 992px) {
    #navbar-main > div > ul {
      margin-left: auto !important;
      margin-right: 0.3rem !important;
      padding: 0 !important;
      margin-top: 0.5rem !important;
    }
  }
  
  // Increase right margin on mobile
  @media (max-width: 991px) {
    #navbar-main > div > ul {
      margin-left: auto !important;
      margin-right: 1.5rem !important;
      padding: 0 !important;
      margin-top: 0.5rem !important;
    }
  }
  
  // Prevent icons from overlapping mobile brand
  #navbar-main > div > div.navbar-brand-mobile-wrapper.d-inline-flex.d-lg-none {
    margin-right: 1rem !important;
    flex-shrink: 0 !important;
  }
  
  // Ensure navbar container uses flexbox with max-width constraint and is centered
  #navbar-main > div,
  #navbar-main > .container {
    display: flex !important;
    max-width: 1300px !important;
    align-items: center !important;
    margin: 0 auto !important;
  }
  
  // Responsive right margin for navbar icons
  .navbar-nav.ml-auto .nav-item {
    margin-right: #{"clamp(0.15rem, 0.5vw, 0.2rem)"} !important;
    margin-left: #{"clamp(0.15rem, 0.5vw, 0.2rem)"} !important;
  }
}

// Ensure navbar elements have proper light background in dark theme
body.dark #navbar-main,
body.dark .navbar-toggler {
  background-color: #e2e8f0 !important;
}

// Make navbar toggler more visible in dark theme
body.dark .navbar-toggler {
  color: #0f172a !important;
}

// Additional specific rule for navbar-collapse to ensure light background in dark theme
body.dark .navbar-collapse,
body.dark .navbar-collapse *,
body.dark .navbar-collapse .nav-link,
body.dark .navbar-collapse .navbar-nav .nav-link {
  color: #0f172a !important;
  background-color: #e2e8f0 !important;
}

// Dark theme navbar toggler icon
body.dark .navbar-toggler-icon {
  filter: invert(0);
}

// Increase mobile menu icon size (Font Awesome fa-bars)
.navbar-toggler .fa-bars,
.navbar-toggler .fas.fa-bars,
.navbar-toggler i.fas {
  font-size: 28px !important;
  color: var(--nav-text) !important;
}

// Dark theme navbar toggler icon color
body.dark .navbar-toggler .fa-bars,
body.dark .navbar-toggler .fas.fa-bars,
body.dark .navbar-toggler i.fas {
  color: #0f172a !important;
}

#navbar-main > div > div.d-none.d-lg-inline-flex > a, #navbar-content > ul > li > a, #navbar-main > div > div.navbar-brand-mobile-wrapper.d-inline-flex.d-lg-none > a {
  color: var(--nav-text);
}

#navbar-main > div > div.d-none.d-lg-inline-flex > a {
  margin-left: 1rem !important;
}

#navbar-main > div > div.d-none.d-lg-inline-flex > a:hover, #navbar-content > ul > li > a:hover, #navbar-main > div > div.navbar-brand-mobile-wrapper.d-inline-flex.d-lg-none > a:hover {
  color: var(--nav-hover);
}

div.col-12.col-lg-4.section-heading > h1, #navbar-content > ul > li > a {
  color: var(--text-secondary);
}

.nav-link.active span {
  color: var(--nav-active);
}

#navbar-main a:link {
  color: var(--nav-link);
  background-color: transparent;
}

#navbar-content > ul > li > a:hover > span {
  color: var(--nav-hover);
  font-weight: normal !important; // Remove bold on hover
}

// Navigation Menu Styling Enhancements
// =================================================================================

// 0. Remove ALL existing underlines and borders from navigation elements
.navbar-nav .nav-link,
.navbar-nav .nav-link.active,
.navbar-nav .nav-link:hover,
.navbar-nav .nav-link.active span,
.navbar-nav .nav-link:hover span,
#navbar-content > ul > li > a,
#navbar-content > ul > li > a.active,
#navbar-content > ul > li > a:hover,
#navbar-content > ul > li > a.active > span,
#navbar-content > ul > li > a:hover > span,
#navbar-main .nav-link,
#navbar-main .nav-link.active,
#navbar-main .nav-link:hover,
.nav-link,
.nav-link.active,
.nav-link:hover {
  text-decoration: none !important;
  border-bottom: none !important;
  border-top: none !important;
  border-left: none !important;
  border-right: none !important;
  box-shadow: none !important;
  outline: none !important;
  position: relative; // Needed for ::after positioning
}

// 1. Remove bold font-weight from all navigation menu items
.navbar-nav .nav-link,
.navbar-nav .nav-link.active,
.navbar-nav .nav-link:hover,
.navbar-nav .nav-link.active span,
.navbar-nav .nav-link:hover span,
#navbar-content > ul > li > a,
#navbar-content > ul > li > a.active,
#navbar-content > ul > li > a:hover,
#navbar-content > ul > li > a.active > span,
#navbar-content > ul > li > a:hover > span,
#navbar-main .nav-link,
#navbar-main .nav-link.active,
#navbar-main .nav-link:hover {
  font-weight: normal !important;
}

// 2. Active menu item styling - dark aquamarine color with properly centered underline
.navbar-nav .nav-link.active,
#navbar-content > ul > li > a.active,
.nav-link.active {
  color: var(--nav-active) !important; // Dark aquamarine
  font-weight: normal !important;
  text-decoration: none !important;
}

// Fixed positioning for active underlines - centered under text
.navbar-nav .nav-link.active::after,
#navbar-content > ul > li > a.active::after,
.nav-link.active::after {
  content: '';
  position: absolute;
  bottom: -3px; // Positioned closer to words but not too close
  left: 50%; // Center the underline
  transform: translateX(-50%); // Center alignment
  width: 80%; // Slightly narrower than full width for better centering
  height: 1px;
  background-color: var(--nav-active);
  display: block;
}

// 3. Hover menu item styling - dark green color with properly centered underline
.navbar-nav .nav-link:hover:not(.active),
#navbar-content > ul > li > a:hover:not(.active),
.nav-link:hover:not(.active) {
  color: var(--nav-hover-text) !important; // Dark green for hover text
  font-weight: normal !important;
  text-decoration: none !important;
  transition: color 0.1s ease; // Fast transition to reduce lag
}

// Fixed positioning for hover underlines - centered under text
.navbar-nav .nav-link:hover:not(.active):not(.js-dark-toggle):not(.js-search)::after,
#navbar-content > ul > li > a:hover:not(.active)::after,
.nav-link:hover:not(.active):not(.js-dark-toggle):not(.js-search)::after {
  content: '';
  position: absolute;
  bottom: -3px; // Positioned closer to words but not too close
  left: 50%; // Center the underline
  transform: translateX(-50%); // Center alignment
  width: 80%; // Slightly narrower than full width for better centering
  height: 2px; // Slightly thicker for hover
  background-color: var(--nav-hover); // Green for hover underline
  display: block;
  transition: all 0.1s ease; // Fast transition to reduce lag
}

// 4. Ensure span elements inside links also get the right colors
.navbar-nav .nav-link.active span,
#navbar-content > ul > li > a.active > span,
.nav-link.active span {
  color: var(--nav-active) !important; // Dark aquamarine
}

.navbar-nav .nav-link:hover:not(.active) span,
#navbar-content > ul > li > a:hover:not(.active) > span,
.nav-link:hover:not(.active) span {
  color: var(--nav-hover-text) !important; // Dark green for hover text
  transition: color 0.1s ease; // Fast transition to reduce lag
}

// 5. Dark theme consistency with fast transitions
body.dark .navbar-nav .nav-link.active,
body.dark #navbar-content > ul > li > a.active,
body.dark .nav-link.active,
body.dark .navbar-nav .nav-link.active span,
body.dark #navbar-content > ul > li > a.active > span,
body.dark .nav-link.active span {
  color: var(--nav-active) !important;
  text-decoration: none !important;
}

body.dark .navbar-nav .nav-link:hover:not(.active),
body.dark #navbar-content > ul > li > a:hover:not(.active),
body.dark .nav-link:hover:not(.active),
body.dark .navbar-nav .nav-link:hover:not(.active) span,
body.dark #navbar-content > ul > li > a:hover:not(.active) > span,
body.dark .nav-link:hover:not(.active) span {
  color: var(--nav-hover-text) !important; // Dark green for hover text
  text-decoration: none !important;
  transition: color 0.1s ease; // Fast transition to reduce lag
}

#navbar-main > div > ul a:link {
  color: var(--text-secondary);
}

#top > div.pub > div.article-container.pt-3 > div.article-metadata > span.article-categories > a, #profile > div > div > ul > div > a:link, #top > article > div.article-container.pt-3 > div.article-metadata > span.article-categories > a:link, code {
  background-color: transparent;
}

.article-title > a, #profile > div.portrait-title > h3 > a {
  background-image: none; 
}

// unvisited link
h3 a:link {
  color: var(--text-tertiary);
}

// active link - use aquamarine for hover
h3 a:hover, div a:hover {
  color: #009688 !important; 
}

body.dark h3 a:hover, body.dark div a:hover {
  color: #5fe0d0 !important;
}

// category links
.article-categories a:link {
  color: var(--text-secondary);
}

// Fix article-categories cropping
.article-categories,
.article-categories a {
  line-height: 1.8 !important;
}

// visited category and tag cloud links
.article-categories a:visited, .tag-cloud > a:visited {
  color: var(--accent-visited-categories) !important;
}

// hovered category links
.article-categories a:hover {
  color: var(--text-quaternary) !important;
}

// hovered tag cloud links
.tag-cloud > a:hover {
  color: var(--text-quaternary) !important;
  text-decoration: none;
}

// Mobile-specific tag cloud styling with color transitions
@media (max-width: 999px) {
  // Mobile tag cloud elements setup for scroll animations (all states)
  .tag-cloud > a:link,
  .tag-cloud > a:visited {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.03s ease-in-out;
    text-decoration: none !important;
    // Override any general color rules for mobile - start transparent
    color: transparent;
  }
  
  // When visible (triggered by scroll), animate with color transition for unvisited links
  .tag-cloud > a:link.visible {
    opacity: 1;
    transform: translateY(0);
    animation: mobile-tag-color-transition 5s forwards;
    text-decoration: none !important;
  }
  
  // When visible (triggered by scroll), animate with color transition for visited links
  .tag-cloud > a:visited.visible {
    opacity: 1;
    transform: translateY(0);
    animation: mobile-tag-color-transition-visited 5s forwards;
    text-decoration: none !important;
  }
  
  // Mobile-specific color transition animation for unvisited links (matches desktop color-transition4)
  @keyframes mobile-tag-color-transition {
    0% {
      color: var(--anim-start);
    }
    33% {
      color: var(--anim-mid);
    }
    66% {
      color: var(--anim-end-1);
    }
    100% {
      color: var(--accent-quaternary);
    }
  }
  
  // Mobile-specific color transition animation for visited links
  @keyframes mobile-tag-color-transition-visited {
    0% {
      color: var(--anim-start);
    }
    33% {
      color: var(--anim-mid);
    }
    66% {
      color: var(--anim-end-1);
    }
    100% {
      color: var(--accent-visited-categories);
    }
  }
  
  // Hover effects for mobile tag cloud (all states) - override general hover rules
  .tag-cloud > a:link:hover,
  .tag-cloud > a:visited:hover {
    color: var(--text-quaternary) !important;
    transform: scale(1.1);
    transition: all 0.3s ease;
    text-decoration: none !important;
  }
  
  // Explicitly remove any underlines from mobile tag cloud in all themes
  .tag-cloud > a:link,
  .tag-cloud > a:visited,
  .tag-cloud > a:link.visible,
  .tag-cloud > a:visited.visible,
  .tag-cloud > a:link:hover,
  .tag-cloud > a:visited:hover {
    text-decoration: none !important;
    text-decoration-color: transparent !important;
  }
  
  // Additional dark theme specificity to override any green underline rules
  body.dark .tag-cloud > a:link,
  body.dark .tag-cloud > a:visited,
  body.dark .tag-cloud > a:link.visible,
  body.dark .tag-cloud > a:visited.visible,
  body.dark .tag-cloud > a:link:hover,
  body.dark .tag-cloud > a:visited:hover {
    text-decoration: none !important;
    text-decoration-color: transparent !important;
  }
}

// Hide tags in general home page, along with the preceding divider
:is(#publication, #applications-and-dashboards, #blog) span.article-categories, :is(#publication, #applications-and-dashboards, #blog) span.middot-divider:has(+ span.article-categories) {
  display: none;
}

// Reduce margin above button links in home page
:is(#publication, #applications-and-dashboards, #blog) .btn-links {
  margin-top: -14%;
}

// Increase top margin for publication btn-links on home page
#publication > div > div > div:nth-child(2) > div > div.media-body > div.btn-links {
  margin-top: -0.5rem !important;
}

// Reduce bottom margin for publication article-metadata on home page
#publication > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata {
  margin-top: 0.2rem !important;
  margin-bottom: -0.05rem !important;
}

// Reduce bottom margin for publication article-metadata div on home page
#publication > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div {
  margin-top: 2.5rem !important;
  padding-top: 0.25rem !important;
  padding-bottom: 0 !important;
  margin-bottom: -3.8rem !important;
  font-size: 0.92rem !important;
}

// Reduce bottom margin for publication items
#publication > div > div > div:nth-child(2) > div {
  margin-bottom: 1rem !important;
}

// Increase top margin for publication expanded link on home page
#publication > div > div > div.col-12 > div > div.media-body.is-expanded > a {
  margin-top: 0.5rem !important;
  margin-bottom: 0rem !important;
  display: block !important;
  text-align: center !important;
}

// Increase bottom margin for publication expanded article style on home page
#publication > div > div > div.col-12 > div > div.media-body.is-expanded > div.article-style {
  margin-bottom: 0.5rem !important;
}

// Reduce margins for publication expanded metadata on home page
#publication > div > div > div.col-12 > div > div.media-body.is-expanded > div.stream-meta.article-metadata > div {
  margin-top: 0.3rem !important;
  margin-bottom: 0.7rem !important;
}

// Increase bottom margin for publication media-body span on home page
#publication > div > div > div.col-12 > div > div.media-body > span {
  margin-top: 0.3rem !important;
  margin-bottom: 0.3rem !important;
}

// Decrease margins for bio section in mobile view
@media (max-width: 991px) {
  #bio > div > div > div.col-12.col-lg-8 > div:nth-child(1) {
    margin-top: -0.5rem !important;
    margin-bottom: 1rem !important;
  }
}

// Set consistent height for all buttons to prevent icon buttons from being taller
.btn-outline-primary,
.btn-sm,
.btn-links .btn,
.btn-links a,
.btn-links button {
  height: 2em !important;
  min-height: 2em !important;
  max-height: 2em !important;
  line-height: 1.5 !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  box-sizing: border-box !important;
  vertical-align: middle !important;
}

.btn-outline-primary i,
.btn-sm i,
.btn-links .btn i,
.btn-links a i,
.btn-links button i {
  font-size: 0.85em !important;
  line-height: 1 !important;
  margin: 0 0.4em 0 0 !important;
  vertical-align: middle !important;
}

@media (max-width: 991px) {
  :is(#publication, #applications-and-dashboards, #blog) .btn-links {
    margin-top: -4%;
  }
}

// Increase font size and margin for publication metadata
#publication > div > div > div > div > div.media-body > div.stream-meta.article-metadata > div {
  font-size: 120% !important;
  margin-bottom: 1.2rem !important;
}

// Reduce top margin only when abstract is collapsed
#publication > div > div > div.col-12 > div > div.media-body:not(.is-expanded) > div.stream-meta.article-metadata > div {
  margin-top: 0 !important;
}

// Adjust btn-links margins on individual pages: reduce margin below and increase margin above
article #top > div.pub > div.article-container.pt-3 > div.btn-links.mb-3 {
  margin-bottom: 0.2rem !important;
  margin-top: 0.3rem !important;
}

// Reduce margin under btn-links in individual pages (different selector)
#top > article > div.article-container.pt-3 > div.btn-links.mb-3 {
  margin-bottom: 0.2rem !important;
  margin-top: 0.3rem !important;
}

// Enforce max-width throughout bio main content
#bio > div > div > div.col-12.col-lg-8,
#bio > div > div > div.col-12.col-lg-8 > *,
#bio > div > div > div.col-12.col-lg-8 > p {
  max-width: 100% !important;
  overflow-wrap: break-word !important;
  word-wrap: break-word !important;
}

// Ensure consistent font size for all home page section paragraphs
#multimedia > div > div > div > div > p:nth-child(2),
#teaching-supervision > div > div > div > p,
#bio > div > div > div.col-12.col-lg-8 > p,
#bio > div > div > div.col-12.col-lg-8 > div.row > div > ul > li > div > p,
div > div > div > table > tbody > tr > td,
:is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body > div.article-style,
:is(#publication, #applications-and-dashboards, #blog) > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div,
:is(#publication, #applications-and-dashboards, #blog) > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div > span,
:is(#publication, #applications-and-dashboards, #blog) .stream-meta.article-metadata,
:is(#publication, #applications-and-dashboards, #blog) .stream-meta.article-metadata * {
  font-size: #{"clamp(15px, 0.9vw + 0.2rem, 16px)"} !important;
}

// Collapsible abstracts on home page - collapsed by default, expandable on click
// Applied to publication, applications-and-dashboards, and blog sections
:is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body > div.article-style {
  max-height: 3.6em !important; // Show ~2-3 lines initially
  overflow: hidden !important;
  position: relative !important;
  transition: max-height 0.3s ease !important;
  cursor: pointer !important; // Make entire area clickable
  margin-bottom: -0.5rem !important; // Reduced margin under collapsed abstract
  
  // Add prominent fade gradient at bottom to indicate more content
  &::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2em; // Taller fade area for better visibility
    background: linear-gradient(to bottom, transparent 0%, rgba(255, 255, 255, 0.7) 40%, rgba(255, 255, 255, 0.95) 70%, rgba(255, 255, 255, 1) 100%);
    pointer-events: none;
  }
  
  // Add "Expand summary" button at bottom center - overlays the text
  // Reduced padding with compact styling
  // Hidden by default, shown on hover
  &::before {
    content: ' Expand summary ';
    position: absolute;
    bottom: 6px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.8em;
    padding: 0px 8px;
    background-color: #555;
    color: #fff;
    border: 1px solid #444;
    border-radius: 3px;
    z-index: 1;
    white-space: nowrap;
    opacity: 0;
    transition: all 0.2s ease;
    pointer-events: none;
  }
  
  // Arrow indicators on sides of Expand button
  // Hidden by default, shown on hover
  .expand-arrow {
    position: absolute;
    bottom: 4px;
    font-size: 0.7em;
    color: #888;
    z-index: 1;
    pointer-events: none;
    opacity: 0;
    transition: all 0.2s ease;
    line-height: 1;
  }
  
  .expand-arrow-left {
    right: calc(50% + 50px);
  }
  
  .expand-arrow-right {
    left: calc(50% + 50px);
  }
  
  // Hover effect for the entire abstract - show button and arrows
  &:hover::before {
    opacity: 1;
    background-color: #444;
    color: #fff;
    transform: translateX(-50%) scale(1.03);
  }
  
  &:hover .expand-arrow {
    opacity: 1;
    color: #555;
  }
}

// Dark theme: invert Expand button colours
body.dark :is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body > div.article-style::before {
  background-color: #ddd;
  color: #333;
  border: 1px solid #ccc;
}

body.dark :is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body > div.article-style:hover::before {
  background-color: #ccc;
  color: #222;
}

// Dark theme: arrow colors (white for visibility)
body.dark :is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body > div.article-style .expand-arrow {
  color: #fff;
}

body.dark :is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body > div.article-style:hover .expand-arrow {
  color: #eee;
}

// Specific gradient for applications-and-dashboards section (even section with different background)
#applications-and-dashboards > div > div > div.col-12 > div > div.media-body > div.article-style::after {
  background: linear-gradient(to bottom, transparent 0%, rgba(247, 250, 252, 0.7) 40%, rgba(247, 250, 252, 0.95) 70%, rgba(247, 250, 252, 1) 100%);
}

// Remove fade gradient and button when expanded
:is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body.is-expanded > div.article-style::after,
:is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body.is-expanded > div.article-style::before {
  display: none;
}

// Hide arrows when expanded
:is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body.is-expanded > div.article-style .expand-arrow {
  display: none;
}

// Dark theme fade gradient - more visible with stronger opacity gradient
body.dark :is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body > div.article-style::after {
  background: linear-gradient(to bottom, transparent 0%, rgba(31, 41, 55, 0.7) 40%, rgba(31, 41, 55, 0.95) 70%, rgba(31, 41, 55, 1) 100%);
}

// When expanded, show full content and remove padding
:is(#publication, #applications-and-dashboards, #blog) > div > div > div.col-12 > div > div.media-body.is-expanded > div.article-style {
  max-height: none !important;
  padding-bottom: 0;
  cursor: default !important;
}

// Reduce metadata margin
#publication > div > div > div.col-12 > div > div.media-body > div.stream-meta.article-metadata > div {
  margin-bottom: 0.9rem !important;
}

// "View complete content" button that appears after abstract expansion
// Light theme: dark text on light background, reverses on hover
a.view-complete-content-btn,
.view-complete-content-btn,
button.view-complete-content-btn,
a[class*="view-complete-content-btn"],
.home-section a.view-complete-content-btn {
  display: inline-block !important;
  margin-top: 0.8rem !important;
  margin-bottom: 0.2rem !important;
  padding: 4px 12px !important;
  font-size: 14px !important;
  font-weight: 500 !important;
  color: #ffffff !important;
  background-color: #2c3e50 !important;
  background-image: none !important;
  border: 2px solid #2c3e50 !important;
  border-radius: 4px !important;
  text-decoration: none !important;
  transition: all 0.3s ease !important;
  
  i {
    margin-right: 5px !important;
    color: #ffffff !important;
  }
  
  &:hover {
    color: #2c3e50 !important;
    background-color: #ecf0f1 !important;
    background-image: none !important;
    border: 2px solid #95a5a6 !important;
    transform: translateY(-2px) !important;
    
    i {
      color: #2c3e50 !important;
    }
  }
}

// Dark theme: light text on dark background, reverses on hover
body.dark a.view-complete-content-btn,
body.dark .view-complete-content-btn,
body.dark button.view-complete-content-btn,
body.dark a[class*="view-complete-content-btn"],
.dark a.view-complete-content-btn,
.dark .view-complete-content-btn,
.dark button.view-complete-content-btn,
body.dark .home-section a.view-complete-content-btn {
  color: #ecf0f1 !important;
  background-color: #34495e !important;
  background-image: none !important;
  border: 2px solid #7f8c8d !important;
  
  i {
    color: #ecf0f1 !important;
  }
  
  &:hover {
    color: #2c3e50 !important;
    background-color: #bdc3c7 !important;
    background-image: none !important;
    border: 2px solid #95a5a6 !important;
    
    i {
      color: #2c3e50 !important;
    }
  }
}

// Document Viewer Styles
.document-viewer-container {
  position: relative;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  transition: box-shadow 0.3s ease;
  margin: 20px auto;
  padding: 0;
  border: 1px solid var(--border-color);
  border-radius: 5px;
  overflow: hidden;
  
  // Responsive width for different screen sizes
  @media (max-width: 768px) {
    // Mobile: 90% width
    width: 90%;
    max-width: 90%;
    margin: 15px auto;
  }
  
  @media (min-width: 769px) {
    // Desktop: 100% width
    width: 100%;
    max-width: 100%;
    margin: 20px auto;
  }
  
  &:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  
  iframe {
    display: block;
  }
}

// Enhanced toolbar for document viewer
.document-viewer-toolbar {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 10;
  background-color: var(--bg-button);
  border: 1px solid var(--border-color);
  border-radius: 25px;
  padding: 5px 10px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  transition: all 0.2s ease;
  
  &:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }
}

.toolbar-buttons {
  display: flex;
  gap: 5px;
  align-items: center;
}

.doc-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  background-color: transparent;
  color: var(--text-hover) !important;
  border: none;
  border-radius: 50%;
  text-decoration: none !important;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 1em;
  
  i {
    font-size: 1em;
  }
  
  &:hover {
    background-color: var(--bg-button-hover) !important;
    transform: scale(1.15);
  }
  
  &:active {
    transform: scale(1.05);
  }
  
  &:focus {
    outline: 2px solid var(--accent-primary);
    outline-offset: 2px;
  }
}

// Separator between button groups
.doc-btn:nth-child(2)::after {
  content: '';
  position: absolute;
  right: -8px;
  top: 50%;
  transform: translateY(-50%);
  width: 1px;
  height: 20px;
  background-color: var(--border-color);
}

// Dark theme adjustments for document viewer
body.dark .document-viewer-container {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  
  &:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);
  }
}

body.dark .document-viewer-toolbar {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
  
  &:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.7);
  }
}

// Change size of article metadata

// Global article metadata rules (apply to all pages)
.article-metadata {
  margin-bottom: 0.4rem !important;
}

.article-metadata > div {
  margin-top: -0.4rem !important;
  margin-bottom: -0.3rem !important;
}

// Reduce margin under article-metadata in web applications and blog sections
#applications-and-dashboards .article-metadata > div,
#blog .article-metadata > div {
  margin-bottom: -0.3rem !important;
}

// Reduce top margin for blog stream-meta container
#blog > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata {
  margin-top: 0 !important;
}

// Decrease top margin for blog metadata on home page
#blog > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div {
  margin-top: -0.2rem !important;
}

// Reduce top padding for blog article metadata
#blog > div > div > div > div > div.media-body > div.stream-meta.article-metadata {
  padding-top: 0.2rem !important;
}

// HOME SECTION SPECIFIC RULES - MUST COME AFTER GLOBAL RULES
.home-section .article-metadata {
  margin-top: 0.3rem !important;
  margin-bottom: initial !important; // Reset to allow media queries to work
}

.home-section .article-metadata > div {
  margin-top: 0 !important;
  margin-bottom: initial !important; // Reset to allow media queries to work
}

// Increase font size for article date on home page
#blog > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div > span.article-date {
  font-size: 112% !important;
}

// Increase font size and decrease top margin for metadata spans on home page
#blog > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div > span {
  font-size: 0.85rem !important;
  margin-top: -0.2rem !important;
}

// Smaller screens - larger font size, minimal margin (MUST BE LAST)
@media (max-width: 600px) {
  .home-section .article-metadata {
    font-size: 0.95rem !important;
  }
  
  #blog .stream-meta.article-metadata,
  #blog .stream-meta.article-metadata * {
    font-size: 0.8rem !important;
  }
  
  #applications-and-dashboards .stream-meta.article-metadata,
  #applications-and-dashboards .stream-meta.article-metadata *,
  #applications-and-dashboards .stream-meta.article-metadata span {
    font-size: 0.8rem !important;
  }
  
  .home-section .article-metadata,
  .home-section .article-metadata *,
  .home-section .article-metadata > div {
    margin-bottom: 0rem !important;
    color: rgba(0,0,0,0.54) !important;
  }
  
  body.dark .home-section .article-metadata,
  body.dark .home-section .article-metadata *,
  body.dark .home-section .article-metadata > div {
    color: rgba(255,255,255,0.54) !important;
  }
}

// Larger screens - smaller font size, significantly increased margin (MUST BE LAST)
@media (min-width: 601px) {
  .home-section .article-metadata {
    font-size: 0.7rem !important;
  }
  
  .home-section .article-metadata,
  .home-section .article-metadata *,
  .home-section .article-metadata > div {
    margin-bottom: 0.7rem !important;
    color: rgba(0,0,0,0.54) !important;
  }
  
  body.dark .home-section .article-metadata,
  body.dark .home-section .article-metadata *,
  body.dark .home-section .article-metadata > div {
    color: rgba(255,255,255,0.54) !important;
  }
}

// Format post titles on home page: keep link color but remove background and borders
#blog h3 a,
#blog h3 a:link,
#blog h3 a:visited,
#blog .media-body h3 a,
#blog .media-body h3 a:link,
#blog .media-body h3 a:visited,
#blog div.media-body > h3 > a,
#blog div.media-body > h3 > a:link,
#blog div.media-body > h3 > a:visited,
#publication h3 a,
#publication h3 a:link,
#publication h3 a:visited,
#publication .media-body h3 a,
#publication .media-body h3 a:link,
#publication .media-body h3 a:visited,
#publication div.media-body > h3 > a,
#publication div.media-body > h3 > a:link,
#publication div.media-body > h3 > a:visited,
#applications-and-dashboards h3 a,
#applications-and-dashboards h3 a:link,
#applications-and-dashboards h3 a:visited,
#applications-and-dashboards .media-body h3 a,
#applications-and-dashboards .media-body h3 a:link,
#applications-and-dashboards .media-body h3 a:visited,
#applications-and-dashboards div.media-body > h3 > a,
#applications-and-dashboards div.media-body > h3 > a:link,
#applications-and-dashboards div.media-body > h3 > a:visited,
.home-section h3 a,
.home-section h3 a:link,
.home-section h3 a:visited,
.home-section .media-body h3 a,
.home-section .media-body h3 a:link,
.home-section .media-body h3 a:visited {
  background: none !important;
  background-image: none !important;
  background-color: transparent !important;
  text-decoration: none !important;
  border-bottom: none !important;
}

#blog h3 a:hover,
#blog h3 a:active,
#blog .media-body h3 a:hover,
#blog .media-body h3 a:active,
#blog div.media-body > h3 > a:hover,
#blog div.media-body > h3 > a:active,
#publication h3 a:hover,
#publication h3 a:active,
#publication .media-body h3 a:hover,
#publication .media-body h3 a:active,
#publication div.media-body > h3 > a:hover,
#publication div.media-body > h3 > a:active,
#applications-and-dashboards h3 a:hover,
#applications-and-dashboards h3 a:active,
#applications-and-dashboards .media-body h3 a:hover,
#applications-and-dashboards .media-body h3 a:active,
#applications-and-dashboards div.media-body > h3 > a:hover,
#applications-and-dashboards div.media-body > h3 > a:active,
.home-section h3 a:hover,
.home-section h3 a:active,
.home-section .media-body h3 a:hover,
.home-section .media-body h3 a:active {
  background: none !important;
  background-image: none !important;
  background-color: transparent !important;
  text-decoration: none !important;
  border-bottom: none !important;
}

/* Increase font size for home page h3 headings with links */
#blog div.media-body > h3 > a,
#publication div.media-body > h3 > a,
#applications-and-dashboards div.media-body > h3 > a,
.home-section div.media-body > h3 > a {
  font-size: 1.3rem !important;
  line-height: 1.5 !important;
}

article .article-metadata {
  margin-bottom: 2px !important;
}

#publication > div > div > div.col-12 > div > div.media-body > div.stream-meta.article-metadata > div {
  font-size: 115%;
}

// Increase font size for blog metadata first span
#blog > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div > span:nth-child(1) > span {
  font-size: 120% !important;
}

// Equate font size of first span to match publication name span
#publication .article-metadata > div > span:first-child span {
  font-size: 100%;
}

#top > div.pub > div.article-container.pt-3 > div.article-metadata {
  font-size: 90%;
  margin-bottom: 0.1rem !important;
}

// Override for publication pages - larger font
body.page-publication #top > div.pub > div.article-container.pt-3 > div.article-metadata {
  font-size: 2rem !important;
}

#top div.media-body > div.article-style {
  font-size: 90%;
}

// Change size of article categories
#top > div.pub > div.article-container.pt-3 > div.article-metadata > span.article-categories {
  font-size: 80%;
}

// Override for publication pages - larger categories font
body.page-publication #top > div.pub > div.article-container.pt-3 > div.article-metadata > span.article-categories {
  font-size: 2rem !important;
}


// Remove 's' tag from tag cloud
a[href$="/tags/s/"] {
  display: none;
}


// Increase padding under h3 headings
h3 {
  padding-bottom: 0.3%;
}

// Reduce margin between paragraphs
p {
  margin-bottom: 2%;
}

// Reduce padding between list items
ul > li {
  margin-bottom: -0.5%;
}


// STICKY TABLE HEADERS - DISABLED

// Sticky table headers disabled due to layout conflicts
// Uncomment and adjust if needed in the future
/*
table th, table thead th {
  position: sticky;
  top: 0;
  z-index: 10;
  background-color: var(--color-white);
  border-bottom: 2px solid var(--border-color);
}

body.dark table th, body.dark table thead th {
  background-color: #1f2937;
  border-bottom-color: #6b7280;
}

@media (min-width: 1000px) {
  table th, table thead th {
    top: 70px;
  }
}
*/


// LINKS

#publication > div > div > div.col-12 > div > div.media-body > div.btn-links > a, div.article-container.pt-3 > div.btn-links.mb-3 > a:link, #publication > div > div > div.col-12 > * > div.media-body > div.btn-links > a:link, .btn-links a:link, #top > div.pub > div > a > button:link, #publication > div > div > div.col-12 > * > div.media-body > div.btn-links > button:link, div.grid-sizer > div > p > button, div.grid-sizer > div > p > a:link, #top > div.pub > div.article-container.pt-3 > div.btn-links.mb-3 > button, #publication > div > div > div.col-12 > div > div.media-body > div.btn-links > button {
  background-image: none;
  color: var(--text-hover); 
  background-color: var(--bg-button) !important;
  border-color: var(--border-color);
}

div.article-container.pt-3 > div.btn-links.mb-3 > a:visited, #publication > div > div > div.col-12 > * > div.media-body > div.btn-links > a:visited, .btn-links a:visited, #top > div.pub > div > a > button:visited, #publication > div > div > div.col-12 > * > div.media-body > div.btn-links > button:visited, #top > div.pub > div.article-container.pt-3 > div.btn-links.mb-3 > button:visited, div.grid-sizer > div > p > button:visited, div.grid-sizer > div > p > a:visited, #publication > div > div > div.col-12 > div > div.media-body > div.btn-links > button:visited {
  background-image: none;
  color: var(--text-visited);
  font-weight: bold;
  background-color: var(--bg-button-secondary);
  border-color: var(--text-visited);
}

#publication > div > div > div.col-12 > div > div.media-body > div.btn-links > a:hover, div.article-container.pt-3 > div.btn-links.mb-3 > a:hover, #top > div.pub > div.article-container.pt-3 > div.btn-links.mb-3 > a:hover, #publication > div > div > div.col-12 > * > div.media-body > div.btn-links > a:hover, .btn-links a:hover, div.grid-sizer > div > p > button:hover, div.grid-sizer > div > p > a:hover, div.media-body > h3 > a:hover, #publication > div > div > div.col-12 > div > div.media-body > div.btn-links > button:hover, #top > div.pub > div.article-container.pt-3 > div.btn-links.mb-3 > button:hover {
  background-image: none;
  color: var(--text-hover); 
  background-color: var(--bg-button-hover) !important;
  border-color: var(--border-color);
}

// unvisited tag and category links
// main tags container
#top > div.pub > div > div.article-tags, #top > article > div > div.article-tags, .article-tags {
  text-align: center;
  line-height: 2;
  display: block;
}

// main tag links
#top > div.pub > div > div.article-tags > a:link, #top > article > div > div.article-tags > a:link, .article-tags a:link {
  display: inline-block;
  color: inherit;
  background-color: transparent;
  background: transparent;
  padding: 0;
  margin: 0 0.4rem 0.3rem 0.4rem;
  border: none;
  border-radius: 0;
  font-weight: 600;
  font-size: 1rem;
  outline: none;
  box-shadow: none;
  text-decoration: none;
}

// ancillary tag links within main container
#top > div.pub > div > div.article-tags > a.ancillary-tag:link, 
#top > article > div > div.article-tags > a.ancillary-tag:link, 
.article-tags a.ancillary-tag:link {
  font-weight: 400;
  font-size: 0.85rem;
  opacity: 0.6;
}

#top > div.pub > div > div.article-tags > a.ancillary-tag:visited, 
#top > article > div > div.article-tags > a.ancillary-tag:visited, 
.article-tags a.ancillary-tag:visited {
  font-weight: 400;
  opacity: 0.6;
}

#top > div.pub > div > div.article-tags > a.ancillary-tag:hover, 
#top > article > div > div.article-tags > a.ancillary-tag:hover, 
.article-tags a.ancillary-tag:hover {
  font-weight: 400;
  opacity: 0.85;
}

// visited tag and category links
#top > div.pub > div > div.article-tags > a:visited, #top > article > div > div.article-tags > a:visited, .article-tags a:visited {
  color: inherit;
  background-color: transparent;
  background: transparent;
}

// Pagination styling
.pagination {
  overflow: visible !important;
  margin-bottom: 2rem !important;
  gap: 1rem !important;
}

.pagination .page-item {
  overflow: visible !important;
  
  .page-link {
    overflow: visible !important;
    border-radius: 0.375rem !important;
    text-decoration: none !important;
    
    &:hover {
      text-decoration: none !important;
    }
  }
}

.pagination .page-link.pagination-next {
  text-decoration: none !important;
  box-shadow: 0 0 0 1px rgba(0,0,0,0.1) !important;
  border: 1px solid rgba(0,0,0,0.1) !important;
}

// Dark theme pagination
[data-theme="dark"] {
  .pagination .page-link.pagination-next {
    color: #fff !important;
    box-shadow: 0 0 0 1px rgba(255,255,255,0.2) !important;
    border: 1px solid rgba(255,255,255,0.2) !important;
  }
}

// hovered tag and category links
// Note: Hover colors are now controlled by JavaScript in article-ancillary-tags.js
// to maintain thematic colors per tag category
#top > div.pub > div > div.article-tags > a:hover, #top > article > div > div.article-tags > a:hover, .article-tags a:hover {
  color: inherit;
  background-color: transparent;
  background: transparent;
  // Removed fixed green outline - now handled by JS with thematic colors
}

// ancillary tags container
#top > div.pub > div > div.article-tags-ancillary, #top > article > div > div.article-tags-ancillary, .article-tags-ancillary {
  text-align: center;
  line-height: 2;
  margin: 0.75rem 0 0 0;
  padding: 0.75rem 0 0 0;
  border-top: 1px solid rgba(0,0,0,0.12);
  max-width: none;
  width: auto;
  display: block;
}

// ancillary tag links
#top > div.pub > div > div.article-tags-ancillary > a:link, #top > article > div > div.article-tags-ancillary > a:link, .article-tags-ancillary a:link {
  display: inline-block;
  color: var(--text-secondary) !important;
  background-color: transparent;
  background: transparent;
  padding: 0;
  margin: 0 0.35rem 0.3rem 0.35rem;
  border: none;
  border-radius: 0;
  font-weight: 400;
  font-size: 0.9rem;
  opacity: 0.55;
  outline: none;
  box-shadow: none;
  text-decoration: none;
}

// visited ancillary tag links
#top > div.pub > div > div.article-tags-ancillary > a:visited, #top > article > div > div.article-tags-ancillary > a:visited, .article-tags-ancillary a:visited {
  color: inherit;
  background-color: transparent;
  background: transparent;
}

// hovered ancillary tag links
#top > div.pub > div > div.article-tags-ancillary > a:hover, #top > article > div > div.article-tags-ancillary > a:hover, .article-tags-ancillary a:hover {
  color: inherit;
  background-color: transparent;
  background: transparent;
  opacity: 0.85;
  outline: 1px dashed var(--primary);
  outline-offset: 2px;
  border-radius: 0.3em;
}

// Dark theme: make ancillary tags lighter on hover for better visibility
.dark .article-tags a.ancillary-tag:hover,
.dark .article-tags-ancillary a:hover {
  color: #e0e0e0 !important;
  opacity: 1 !important;
}


// Social icons on the left-hand side of the bio section
#profile > div > div > span > span > a > i:hover {
  color: var(--accent-primary) !important;
  background-color: transparent;
  background-image: none;
}

// Icons on the body of the bio section
#bio > div > div > div.col-12 > div > div > ul > li > i {
  color: var(--border-color);
  background-color: transparent;
  background-image: none;
}

// Folder icon for categories
span.article-categories > i {
  color: var(--border-color);
  background-color: transparent;
  background-image: none;
}

// Icons

i, #fn1 > p > a.footnote-back {
  background-color: transparent;
  background-image: none;
}

div.col-12.col-lg-4.section-heading > h1 > span > a > i {
  color: var(--border-color);
  background-image: none;
}

a > i:hover, #profile > div > div > span > span > a:hover, #navbar-main > div > button > span > i:hover, :is(#navbar-main, #publication, #applications-and-dashboards, #blog) :is(a:has(i):not(.view-complete-content-btn), i:hover, button:hover:not(.view-complete-content-btn)), #navbar-main > div > button:hover, #navbar-main > div > button > span:hover {
  color: var(--accent-primary);
  background-color: transparent !important;
  background-image: none !important;
}

// Buttons, full text buttons, dashboard/application button
button:hover:not(.read-more-btn), #top > div.pub > div > a > button:hover, #top > div.pub > div > div.article-style > a > button:hover, #top > article > div > div.article-style > a > button:hover {
  background-color: var(--bg-button-hover) !important;
}

// Keyboard buttons
kbd {
  outline: 0;
  vertical-align: baseline;
  background: transparent;
  border-style: solid;
  border-width: 1px 3px 4px;
  -moz-border-radius: 3px;
  -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px #fff inset;
  -webkit-border-radius: 3px;
  -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px #fff inset;
  background-color: #f7f7f7;
  border: 1px solid #ccc;
  border-radius: 3px;
  box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px #fff inset;
  color: #333;
  display: inline-block;
  font-family: monospace, sans-serif;
  font-size: 95%;
  line-height: 1.2;
  margin: 0 0.1em;
  padding: 0.09em 0.4em 0.11em 0.4em;
  text-shadow: 0 1px 0 #fff;
}


// Bootstrap warning alert messages
div.alert.alert-warning {
  color: var(--text-warning);
  background-color: var(--bg-warning);
  border-color: var(--border-warning);
}

// links in the footer of code chunks from emgithub
div.emgithub-file.emgithub-file-dark > div.file-data.hljs-style-a11y-dark > div > pre > code > table > tbody > tr > td.hljs-ln-line.hljs-ln-code, div.emgithub-file.emgithub-file-dark > div.file-data.hljs-style-a11y-dark > div > pre > code > table > tbody > tr > td.hljs-ln-line.hljs-ln-numbers, div.emgithub-file.emgithub-file-dark > div.file-meta.file-meta-dark, div.emgithub-file.emgithub-file-dark > div.file-meta.file-meta-dark > a {
  background: none;
  margin: 5px 0px;
}

// link to main GitHub code
div.emgithub-file.emgithub-file-dark > div.file-meta.file-meta-dark > a:nth-child(2) {
  font-size: 130%;
  margin-right: 4px;
  background: #3f3f3f;
  border-radius: 10px;
  padding: 5px 9px;
  color: #dfffe0;
}

// link to raw GitHub code
div.emgithub-file.emgithub-file-dark > div.file-meta.file-meta-dark > a:nth-child(1) {
  font-size: 130%;
  background: #3f3f3f;
  border-radius: 10px;
  padding: 3px 9px;
  color: #fff0ea;
  margin-top: -3px;
}

// link buttons
div.emgithub-file.emgithub-file-dark > div.file-meta.file-meta-dark > a:nth-child(1):hover, div.emgithub-file.emgithub-file-dark > div.file-meta.file-meta-dark > a:nth-child(2):hover {
  font-size: 130%;
  background-image: linear-gradient(180deg, #FEFFE5, #FFFFF3, #FFFFF3, #FFFFF3, #FFFFF3, #FFFFF3, #FFFFF3, #FFFFF3, #FEFFE5);
  color: black;
}

// repair colour of certain code words 
div.emgithub-file.emgithub-file-dark > div.file-data.hljs-style-a11y-dark > div > pre > code > table > tbody > * > td.hljs-ln-line.hljs-ln-code > span > span {
  color: white;
}

// add margin under emgithub code chunks
.emgithub-container {
  margin-bottom: 6%;
}

// remove love icon from emgithub chunk footnote
div.emgithub-file.emgithub-file-dark > div.file-meta.file-meta-dark > span {
  display: none;
}

/* Hide the rotating animation shown when emgithub won't load up, 
and instead, display a message. */

// Hide the rotating animation
div.lds-ring > div:nth-child(4) {
  display: none;
}

// Ensure the parent container is positioned correctly
div.lds-ring {
  position: relative; /* Needed to position the pseudo-element */
}

// Create a pseudo-element to display the message
div.lds-ring:after {
  content: ' Please wait or reload page to view this snippet.';
  display: inline-block; /* Allows the text to be centered */
  font-size: 1.2em;
  color: var(--color-red);
  margin-top: 20px; /* Adjust as needed for positioning */
  white-space: nowrap; /* Prevents the text from wrapping */
  box-sizing: border-box; /* Ensures padding and border are included in width */
  position: absolute; /* Absolute positioning within the parent */
  top: 50%; /* Vertically center within the parent */
  left: 50%; /* Horizontally center starting from the left */
  transform: translate(-50%, -50%); /* Adjust the element to be centered */
  text-align: center; /* Centers the text within the element */
  width: fit-content; /* Adjust the width to the text content */
}


// Hanging indentation for references
#reference, #references, .hanging-indent {
  text-indent: -2em; 
  margin-left: 2em;
}

// Related references heading
h3#related-references {
  margin-top: 2rem;
}

// Related references 

.related-references {
  color: var(--related-references);
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
  border-style: solid; 
  border-width: 0.2px;
  border-left-color: var(--anim-start);
  border-left-width: thin;
  border-top: none;
  border-right: none;
  border-bottom: none;
  overflow: auto; 
  font-size: 90%; 
  height: 700px; 
  overflow-wrap: normal; 
  margin-top: 1em; 
  margin-left: -0.7em; 
  margin-bottom: 3em;
  padding-right: 0.4em; 
  padding-left: 0.7em;
}


// scroll bar for textarea
textarea {
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
}


// margin after code snippets
pre {
  margin-bottom: 5%;
}


// in desktop view only
@media (min-width: 1000px) {
  
  // Ensure parent containers allow sticky to work
  .home-section,
  .home-section > .container,
  .home-section > .container > .row {
    overflow: visible !important;
    overflow-x: visible !important;
    overflow-y: visible !important;
  }
  
  // make sidebar headings sticky
  .section-heading, #bio > div > div > div.col-12.col-lg-4 {
    margin: 0 !important;
    height: auto !important;
    overflow-y: visible !important;
    position: -webkit-sticky !important;
    position: sticky !important; 
    top: 70px !important;
    align-self: flex-start !important;
    margin-bottom: 0 !important;
    padding-top: 0 !important;
    z-index: 10 !important;
  }
  
  div.col-12.col-lg-4.section-heading > h1 {
    border-bottom: none !important;
    border-image-source: none !important;
    border-image-slice: 0 !important;
  }
  
  // remove Experience from profile subsections in mobile only
  @media (max-width: 991px) {
    #profile > div:nth-child(5) > div > ul > div:nth-child(1) {
      display: none;
    }
  }
}


/* Enable gallery with modal windows for images */

.image-gallery {
    display: flex;
    flex-wrap: wrap; /* Allows wrapping of images to the next line */
    justify-content: space-between; /* Adds space between columns */
    max-width: 100%;
    margin: 0 auto;
    margin-top: -4%;
}

.imageContainer {
    position: relative; /* Relative positioning for overlay */
    width: 48%; /* Each image container takes up 45% of the width */
    margin-bottom: -4%; /* Reduced margin above the container */
}

.imageContainer img {
    width: 100%; 
    border-radius: 4px;
    cursor: pointer;
    display: block;
}

.expand-icon {
    position: absolute; /* Position icon inside the image */
    top: 50px;
    right: 10px;
    font-size: 24px; /* Adjust icon size */
    color: rgba(255, 255, 255, 0.7); /* Semi-transparent white color */
    pointer-events: none; /* Clicks pass through to image */
    z-index: 1; /* Ensure icon is below the modal content */
}

/* Modal Styling */
.imageModal {
    display: none;
    position: fixed;
    z-index: 2;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    overflow: hidden;
}

.imageModal-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
    overflow: auto; /* Allow scrolling for tall images */
}

.imageModal-content-wrapper {
    display: flex;
    justify-content: center;
    align-items: flex-start; /* Align image to start at the top */
    max-width: 100%; /* Ensure full width usage */
    max-height: 100%; /* Ensure full height usage */
    overflow: hidden; /* Prevents content overflow */
    position: relative;
    padding-top: 20px; /* Add padding to create space from the top */
    box-sizing: border-box; /* Ensure padding doesn't add to total height */
}

.imageModal-content {
    width: auto; /* Ensure the image maintains its aspect ratio */
    height: auto; /* Ensure the image maintains its aspect ratio */
    max-width: calc(100% - 20px); /* Image should not exceed the screen's width, accounting for margin */
    max-height: calc(100vh - 40px); /* Image should not exceed the screen's height, accounting for top margin */
    object-fit: contain; /* Ensures image is fully visible within the modal */
    display: block;
    margin: auto 10px; /* Add a 10px margin to the sides, auto for vertical centering */
    position: relative; /* Use relative positioning to create top spacing */
    top: 10px; /* Ensure top margin is visible */
}


/* Navigation Arrows */
.prev, .next {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    font-size: 32px; /* Increased arrow size */
    background-color: rgba(255, 255, 255, 0.8); /* Light background color */
    color: #333; /* Dark color for arrows */
    padding: 15px; /* Increased padding to enlarge the ovals */
    cursor: pointer;
    border-radius: 50%; /* Make it an oval */
    z-index: 2;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5); /* Add a subtle shadow for depth */
    border: none; /* Remove any border */
}

.prev {
    left: 10px; /* Adjusted positioning */
}

.next {
    right: 10px; /* Adjusted positioning */
}

/* On hover: darken the background color and lighten the arrows */
.prev:hover, .next:hover {
    background-color: rgba(200, 200, 200, 0.8);
    color: #000; /* Even darker color on hover */
}

.imageClose {
    position: absolute;
    top: 20px;
    right: 35px;
    color: white;
    font-size: 40px;
    font-weight: bold;
    transition: 0.3s;
    cursor: pointer;
    z-index: 5; /* Ensure close button is on top of everything */
}

.imageClose:hover, .imageClose:focus {
    color: #bbb;
    text-decoration: none;
    cursor: pointer;
}

.imageModal-text {
    position: absolute;
    text-align: right;
    top: 90px; /* Move text higher to ensure visibility */
    right: 20px;
    color: white;
    background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent black background for better visibility */
    font-size: 20px;
    padding: 5px; /* Add padding for better text visibility */
    padding-right: 25px; /* Add padding for better text visibility */
    z-index: 4; /* Higher z-index to appear above the modal content */
}

@media only screen and (max-width: 700px) {
    .imageModal-content {
        width: 100%; /* Full width for small screens */
        height: auto; /* Maintain aspect ratio */
    }

    /* Adjust grid to be single column on small screens */
    .imageContainer {
        width: 100%; /* Full width on smaller screens */
    }
    
    .imageModal-text {
        font-size: 70%;
    }
}


// Remove Disqus heart icon and count
#favorite-button > div {
  visibility: hidden;
}


// External script toggling

.script-container {
  padding: 0px 1px;
  background: var(--bg-script-container);
  border-radius: 10px;
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.1);
  margin-bottom: 5%;
}

.toggle-script {
  background: var(--gradient-script);
  color: var(--text-hover);
  border: none;
  padding: 8px 16px;
  font-size: 20px;
  cursor: pointer;
  border-radius: 25px;
  transition: all 0.3s ease;
  outline: none;
}

.toggle-script:hover {
  background: var(--gradient-script-hover);
  transform: scale(1.05);
}

.toggle-script:active {
  transform: scale(0.95);
}


// Full text button

.full-text-btn {
  background-color: var(--bg-full-text);
  color: var(--text-hover);
  border: 2px solid var(--border-full-text);
  border-radius: 12px;
  width: 100%;
  padding: 6px 0;
  margin: 0 auto 5%;
  font-size: 1.4em;
  font-weight: 400;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Arial, sans-serif;
  cursor: pointer;
  transition: background 0.2s, border-color 0.2s, box-shadow 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}
.full-text-btn:hover,
.full-text-btn:focus {
  background-color: var(--bg-full-text-hover);
  border-color: var(--border-full-text-hover);
  box-shadow: 0 0 0 2px var(--bg-button-hover);
  border-radius: 12px; /* Ensures corners stay rounded */
}
.full-text-btn .full-text {
  margin: 0 !important;
  padding: 0 !important;
  font-size: 1em;
  font-weight: 400 !important;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Arial, sans-serif !important;
  line-height: 1.5 !important;
  letter-spacing: normal !important;
}
.full-text-btn .full-text i {
  margin-right: 8px;
  color: #dc2626;
}
// Prevent h3 hover styles from affecting button text
.full-text-btn:hover .full-text,
.full-text-btn:focus .full-text,
.full-text-btn:hover a,
.full-text-btn:focus a,
.full-text-btn a:hover,
.full-text-btn a:focus {
  color: var(--text-hover) !important;
  text-decoration: none !important;
  background: none !important;
  background-color: transparent !important;
  background-image: none !important;
  box-shadow: none !important;
  border: none !important;
}
// Same for dark mode
body.dark .full-text-btn:hover .full-text,
body.dark .full-text-btn:focus .full-text,
body.dark .full-text-btn:hover a,
body.dark .full-text-btn:focus a,
body.dark .full-text-btn a:hover,
body.dark .full-text-btn a:focus,
.dark .full-text-btn:hover .full-text,
.dark .full-text-btn:focus .full-text,
.dark .full-text-btn:hover a,
.dark .full-text-btn:focus a,
.dark .full-text-btn a:hover,
.dark .full-text-btn a:focus {
  color: var(--text-hover) !important;
  text-decoration: none !important;
  background: none !important;
  background-color: transparent !important;
  background-image: none !important;
  box-shadow: none !important;
  border: none !important;
}


// CV button

// Add top margin only to the first btn-links container (which contains CV button)
.pub > .container > .article-container > .btn-links.mb-3:first-of-type,
.article-container > .btn-links.mb-3:first-of-type {
  margin-top: 8% !important;
}

.cv-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--bg-cv);
  color: var(--text-hover);
  border: 2px solid var(--border-cv);
  border-radius: 12px;
  width: 100%;
  padding: 8px 0 10px 0;
  font-size: 1.4em; 
  font-weight: 400;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Arial, sans-serif;
  text-decoration: none;
  transition: background 0.2s, border-color 0.2s, box-shadow 0.2s;
  margin: 1rem auto 0.25rem;
  cursor: pointer;
}
.cv-btn:hover,
.cv-btn:focus {
  background-color: var(--bg-cv-hover);
  border-color: var(--border-cv-hover);
  box-shadow: 0 0 0 2px var(--bg-button-hover);
  border-radius: 12px; /* Ensures corners stay rounded */
}
.cv-btn i {
  color: var(--text-secondary);
  margin-right: 8px;
}


// Multimedia section collapsible summaries - matches the pub-abstract collapsed style
// Collapsed by default, expandable on click with fade gradient and hover button

.multimedia-summary {
  max-height: 6.8em !important; // Show ~5 lines initially
  overflow: hidden !important;
  position: relative !important;
  transition: max-height 0.3s ease !important;
  cursor: pointer !important; // Make entire area clickable
  margin-bottom: 0.6rem !important;
  
  // Add prominent fade gradient at bottom to indicate more content
  &::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 1.5em; // Taller fade area for better visibility
    background: linear-gradient(to bottom, transparent 0%, rgba(247, 247, 247, 0.7) 40%, rgba(247, 247, 247, 0.95) 70%, rgba(247, 247, 247, 1) 100%);
    pointer-events: none;
    transition: opacity 0.3s ease;
  }
  
  // Add "Expand summary" button at bottom center - overlays the text
  // Hidden by default, shown on hover
  &::before {
    content: ' Expand summary ';
    position: absolute;
    bottom: 6px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.8em;
    padding: 0px 8px;
    background-color: #555;
    color: #fff;
    border: 1px solid #444;
    border-radius: 3px;
    z-index: 1;
    white-space: nowrap;
    opacity: 0;
    transition: all 0.2s ease;
    pointer-events: none;
  }
  
  // Hover effect - show button
  &:hover::before {
    opacity: 1;
    background-color: #444;
    color: #fff;
    transform: translateX(-50%) scale(1.03);
  }
}

// When expanded, remove constraints and hide fade/button
.multimedia-summary.is-expanded {
  max-height: none !important;
  cursor: default !important;
  margin-bottom: 0.3rem !important;
  
  &::after {
    opacity: 0;
    pointer-events: none;
  }
  
  &::before {
    display: none;
  }
}

// Dark theme adjustments for multimedia summary
body.dark .multimedia-summary {
  &::after {
    background: linear-gradient(to bottom, transparent 0%, rgba(30, 30, 30, 0.7) 40%, rgba(30, 30, 30, 0.95) 70%, rgba(30, 30, 30, 1) 100%);
  }
  
  &::before {
    background-color: #ddd;
    color: #333;
    border: 1px solid #ccc;
  }
  
  &:hover::before {
    background-color: #ccc;
  }
}

// Add margin under section headings 
.section-heading.visible {
  margin-bottom: 4%;
}

/* Enhanced Navigation Highlighting System */

// Ensure navigation links have proper styling for highlighting
.navbar-nav .nav-link {
  transition: all 0.3s ease;
  position: relative;
}

// Active navigation item highlighting - Light theme
.navbar-nav .nav-link.active {
  color: aquamarine !important;
  font-weight: bold !important;
  position: relative;
}

.navbar-nav .nav-link.active::after {
  content: '';
  position: absolute;
  bottom: 2px;
  left: 50%;
  transform: translateX(-50%);
  width: 80%;
  height: 1px;
  background: aquamarine;
  border-radius: 1px;
}

// Hover states for navigation
.navbar-nav .nav-link:hover:not(.active) {
  color: var(--nav-hover) !important;
  transform: translateY(-1px);
}

// Dark theme navigation highlighting
.dark .navbar-nav .nav-link.active,
.dark .navbar-nav .nav-item .nav-link.active,
body.dark .navbar-nav .nav-link.active,
body.dark .navbar-nav .nav-item .nav-link.active {
  color: aquamarine !important;
  font-weight: normal !important; // Remove bold in dark theme
}

// Additional specificity to override bold styling in dark theme
body.dark .navbar-nav .nav-link.active,
body.dark .nav-link.active {
  font-weight: normal !important;
}

// Nuclear option - extremely specific selector for dark theme
html body.dark .navbar-nav .nav-link.active,
html body.dark #navbar-main .navbar-nav .nav-link.active,
html body.dark .navbar-collapse .navbar-nav .nav-link.active {
  font-weight: 300 !important; // Use lighter weight to ensure no bold
}

.dark .navbar-nav .nav-link.active::after,
.dark .navbar-nav .nav-item .nav-link.active::after,
body.dark .navbar-nav .nav-link.active::after,
body.dark .navbar-nav .nav-item .nav-link.active::after {
  background: aquamarine !important;
}

.dark .navbar-nav .nav-link:hover:not(.active) {
  color: var(--nav-hover) !important;
}

// Smooth scroll behavior for better section detection
html {
  scroll-behavior: smooth;
}

// Section offset to account for fixed navbar
section[id] {
  scroll-margin-top: 60px; // Adjust for navbar height
}

// Mobile responsive navigation highlighting
@media (max-width: 768px) {
  .navbar-nav .nav-link.active::after {
    width: 100%;
    left: 0;
    transform: none;
  }
  
  section[id] {
    scroll-margin-top: 60px; // Adjusted for mobile navbar height
  }
  
  // Reduce font size of article-metadata on home page in mobile view
  .home-section .article-metadata {
    font-size: 65% !important;
  }
  
  // Remove underlines from navigation menu items in mobile view
  .navbar-nav .nav-link,
  .navbar-nav .nav-link.active,
  .navbar-nav .nav-item .nav-link,
  .navbar-nav .nav-item .nav-link.active,
  #navbar-main .navbar-nav .nav-link,
  #navbar-main .navbar-nav .nav-link.active {
    text-decoration: none !important;
  }
  
  .navbar-nav .nav-link.active::after,
  .navbar-nav .nav-item .nav-link.active::after,
  #navbar-main .navbar-nav .nav-link.active::after {
    display: none !important;
  }
  
  // Fix mobile dropdown positioning - hang under toggle icon on left side
  .navbar-collapse {
    width: auto !important;
    max-width: 250px !important;
    left: 15px !important;           // Position from left (under toggle)
    right: auto !important;          // Remove right positioning
    border-radius: 8px !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
  }
}

/* CRITICAL FIXES - Maximum specificity overrides */

// 1. Fix avatar circle shape in all themes - NUCLEAR OPTION
img[class*="avatar-circle"],
*[class*="avatar-circle"] img,
*[class*="avatar"] img[class*="circle"],
html body div .avatar.avatar-circle img,
html body div .avatar-circle img,
html body .portrait .avatar.avatar-circle img,
html body .portrait .avatar-circle img,
body div .avatar.avatar-circle img,
body div .avatar-circle img,
.avatar.avatar-circle img,
.avatar-circle img {
  border-radius: 50% !important;
  -webkit-border-radius: 50% !important;
  -moz-border-radius: 50% !important;
  clip-path: circle(50%) !important;
  -webkit-clip-path: circle(50%) !important;
  shape-outside: circle(50%) !important;
  overflow: hidden !important;
  width: auto !important;
  height: auto !important;
  max-width: 100% !important;
  max-height: 100% !important;
  transform: translateX(-50%) scale(0.8) !important;
  -webkit-transform: translateX(-50%) scale(0.8) !important;
  -moz-transform: translateX(-50%) scale(0.8) !important;
  -ms-transform: translateX(-50%) scale(0.8) !important;
  transform-origin: center center !important;
  -webkit-transform-origin: center center !important;
  -moz-transform-origin: center center !important;
  -ms-transform-origin: center center !important;
  border: none !important;
  border: 0 !important;
  outline: none !important;
  box-shadow: none !important;
  -webkit-box-shadow: none !important;
  -moz-box-shadow: none !important;
  position: relative !important;
  left: 51% !important;
}

// Remove borders from avatar containers too
.avatar.avatar-circle,
.avatar-circle,
*[class*="avatar-circle"],
*[class*="avatar"],
.portrait .avatar.avatar-circle,
.portrait .avatar-circle,
div.avatar.avatar-circle,
div.avatar-circle {
  border: none !important;
  border: 0 !important;
  outline: none !important;
  box-shadow: none !important;
  -webkit-box-shadow: none !important;
  -moz-box-shadow: none !important;
  background: transparent !important;
  padding: 0 !important;
  margin: 0 !important;
}

// Remove any ::before or ::after pseudo-elements that might create borders
.avatar.avatar-circle::before,
.avatar.avatar-circle::after,
.avatar-circle::before,
.avatar-circle::after,
*[class*="avatar-circle"]::before,
*[class*="avatar-circle"]::after {
  display: none !important;
  content: none !important;
  border: none !important;
  box-shadow: none !important;
}

// 2. Fix navigation active color with ULTIMATE specificity
html body.dark #navbar-main .navbar-nav .nav-item .nav-link.active,
html body.dark .navbar .navbar-nav .nav-item .nav-link.active,
html body.dark .navbar .navbar-nav .nav-link.active,
html body.dark nav .navbar-nav .nav-link.active,
html:not(.light) body.dark .navbar-nav .nav-link.active,
.dark html body .navbar-nav .nav-link.active {
  color: aquamarine !important;
  font-weight: 600 !important;
  text-shadow: 0 0 2px aquamarine !important;
}

html body.dark #navbar-main .navbar-nav .nav-item .nav-link.active::after,
html body.dark .navbar .navbar-nav .nav-item .nav-link.active::after,
html body.dark .navbar .navbar-nav .nav-link.active::after,
html body.dark nav .navbar-nav .nav-link.active::after,
html:not(.light) body.dark .navbar-nav .nav-link.active::after,
.dark html body .navbar-nav .nav-link.active::after {
  background: aquamarine !important;
  box-shadow: 0 0 3px aquamarine !important;
}

// 3. Aquamarine to dark grey gradient for section headings in dark theme
html body.dark div.col-12.col-lg-4.section-heading > h1,
html body.dark .section-heading > h1,
body.dark div.col-12.col-lg-4.section-heading > h1,
body.dark .section-heading > h1 {
  border-image-source: linear-gradient(to right, aquamarine, #2d2d2d) !important;
  border-image-slice: 1 !important;
  border-bottom: 0.4px solid !important;
}

////////////////////////////
// Search Results Styling
////////////////////////////

// Style search result titles with elegant colors
#search > div > section.section-search-results h3,
.section-search-results h3,
.search-results h3,
#search .section-search-results h3 a,
.section-search-results h3 a,
.search-results h3 a {
  color: #4a5568 !important; // Elegant dark grey for light theme
  font-weight: 600;
  transition: color 0.3s ease;
  text-decoration: none !important;
}

#search > div > section.section-search-results h3:hover,
.section-search-results h3:hover,
.search-results h3:hover {
  color: #2d3748 !important; // Darker elegant grey on hover for light theme
}

// Dark theme search result titles
body.dark #search > div > section.section-search-results h3,
body.dark .section-search-results h3,
body.dark .search-results h3,
body.dark #search .section-search-results h3 a,
body.dark .section-search-results h3 a,
body.dark .search-results h3 a {
  color: #a0aec0 !important; // Soft warm grey for dark theme
}

body.dark #search > div > section.section-search-results h3:hover,
body.dark .section-search-results h3:hover,
body.dark .search-results h3:hover,
body.dark #search .section-search-results h3 a:hover,
body.dark .section-search-results h3 a:hover,
body.dark .search-results h3 a:hover {
  color: #cbd5e0 !important; // Lighter warm grey on hover for dark theme
}

// Remove default blue color from search result links
#search > div > section.section-search-results a,
.section-search-results a,
.search-results a {
  text-decoration: none !important;
}

#search > div > section.section-search-results a h3,
.section-search-results a h3,
.search-results a h3 {
  color: inherit !important; // Use the colors defined above
}

////////////////////////////
// Navigation Icon Colors (Search & Theme Toggle)
////////////////////////////

// Default grey color for search icon and theme toggle
.navbar-nav .nav-link.js-search,
.navbar-nav .nav-link.js-dark-toggle {
  color: var(--nav-text) !important; // Use default grey
}

// Keep current hover colors for search icon and theme toggle
.navbar-nav .nav-link.js-search:hover {
  color: var(--nav-hover-text) !important; // Current hover color
}

.navbar-nav .nav-link.js-dark-toggle:hover {
  color: var(--nav-hover-text) !important; // Current hover color
}

// Dark theme
body.dark .navbar-nav .nav-link.js-search,
body.dark .navbar-nav .nav-link.js-dark-toggle {
  color: var(--nav-text) !important; // Use default grey
}

body.dark .navbar-nav .nav-link.js-search:hover,
body.dark .navbar-nav .nav-link.js-dark-toggle:hover {
  color: var(--nav-hover-text) !important; // Current hover color
}

////////////////////////////
// Search Close Icon Styling
////////////////////////////

// Remove background color and add dark aquamarine icon color on hover (light theme)
#search > div > section.search-header > div.row.no-gutters.justify-content-between.mb-3 > div.col-6.col-search-close > a > i:hover,
.search-header .col-search-close a i:hover {
  background-color: transparent !important;
  color: #5f9ea0 !important; // Dark aquamarine for light theme
  transition: color 0.3s ease;
}

// Ensure no background color is applied
#search > div > section.search-header > div.row.no-gutters.justify-content-between.mb-3 > div.col-6.col-search-close > a:hover,
.search-header .col-search-close a:hover {
  background-color: transparent !important;
}

// Dark theme search close icon (regular aquamarine)
body.dark #search > div > section.search-header > div.row.no-gutters.justify-content-between.mb-3 > div.col-6.col-search-close > a > i:hover,
body.dark .search-header .col-search-close a i:hover {
  background-color: transparent !important;
  color: aquamarine !important;
}

////////////////////////////
// NUCLEAR OPTIONS - FINAL OVERRIDES
////////////////////////////

/* NUCLEAR OVERRIDE FOR SEARCH RESULTS - Must be at end of file */
html body #search div.section-search-results h3,
html body #search div.section-search-results h3 a,
html body .section-search-results h3,
html body .section-search-results h3 a,
html body .search-results h3,
html body .search-results h3 a {
  color: #4a5568 !important; /* Elegant dark grey for light theme */
}

html body.dark #search div.section-search-results h3,
html body.dark #search div.section-search-results h3 a,
html body.dark .section-search-results h3,
html body.dark .section-search-results h3 a,
html body.dark .search-results h3,
html body.dark .search-results h3 a {
  color: #a0aec0 !important; /* Soft warm grey for dark theme */
}

/* NUCLEAR OVERRIDE FOR ACTIVE MENU BOLD - Must be at end of file */
html body.dark #navbar-main .navbar-nav .nav-link.active,
html body.dark .navbar-collapse .navbar-nav .nav-link.active,
html body.dark .navbar-nav .nav-link.active {
  font-weight: 300 !important; /* Light weight to ensure no bold */
}

/* Additional Bootstrap and theme overrides for dark theme */
.dark .nav-link.active,
.dark .navbar-nav .nav-link.active,
.dark .navbar-light .navbar-nav .nav-link.active,
body.dark .nav-link.active,
body.dark .navbar-nav .nav-link.active,
body.dark .navbar-light .navbar-nav .nav-link.active {
  font-weight: 300 !important;
}

/* Force override any inherited bold styling */
html body.dark * .nav-link.active {
  font-weight: 300 !important;
}

/* NUCLEAR SEARCH RESULT TITLE STYLING - Override blue defaults */
html body .search-hit h1,
html body .search-hit h2,
html body .search-hit h3,
html body .search-hit h4,
html body .search-hit h5,
html body .search-hit h6,
html body .search-results .search-hit h1,
html body .search-results .search-hit h2,
html body .search-results .search-hit h3,
html body .search-results .search-hit h4,
html body .search-results .search-hit h5,
html body .search-results .search-hit h6,
html body #search-results .search-hit h1,
html body #search-results .search-hit h2,
html body #search-results .search-hit h3,
html body #search-results .search-hit h4,
html body #search-results .search-hit h5,
html body #search-results .search-hit h6 {
  color: #009688 !important; /* Force aquamarine */
}

/* Target any link in search results */
html body .search-hit a,
html body .search-results .search-hit a,
html body #search-results .search-hit a,
html body .search-hit a h1,
html body .search-hit a h2,
html body .search-hit a h3,
html body .search-hit a h4,
html body .search-hit a h5,
html body .search-hit a h6 {
  color: #009688 !important; /* Force aquamarine */
  text-decoration: none !important;
}

/* Dark theme version for search results */
html body.dark .search-hit h1,
html body.dark .search-hit h2,
html body.dark .search-hit h3,
html body.dark .search-hit h4,
html body.dark .search-hit h5,
html body.dark .search-hit h6,
html body.dark .search-hit a,
html body.dark .search-hit a h1,
html body.dark .search-hit a h2,
html body.dark .search-hit a h3,
html body.dark .search-hit a h4,
html body.dark .search-hit a h5,
html body.dark .search-hit a h6 {
  color: #64ffda !important; /* Force light aquamarine for dark theme */
  text-decoration: none !important;
}

// Make navbar thinner in desktop view by reducing bottom spacing
@media (min-width: 992px) {
  .navbar {
    height: 70px; // Adjusted to accommodate internal padding (60px + 5px top + 5px bottom)
    padding-top: 5px; // Decrease top margin a tiny bit
    padding-bottom: 5px; // Adjust bottom margin accordingly
  }
  
  .navbar-nav .nav-item {
    margin-bottom: 0; // Remove any bottom margin from nav items
    margin-top: 0; // Remove extra margin to align with logo
  }
  
  .navbar-nav .nav-link {
    padding-top: 10px; // Increase top padding slightly
    padding-bottom: 2px; // Decrease margin between titles and underlining bars
  }
  
  .navbar-brand {
    padding-top: 5px; // Match navbar top padding for alignment
    padding-bottom: 2px; // Reduce bottom padding for logo
  }
  
  .navbar-brand img {
    max-height: 40px; // Adjust logo height for thinner navbar
  }
  
  // Make active and hover underline bars thinner
  .navbar-nav .nav-link::after,
  .navbar-nav .nav-link:hover::after,
  .navbar-nav .nav-link.active::after {
    height: 1px !important; // Make underline bars thinner (default is usually 2-3px)
  }
  
  .navbar-nav .nav-link {
    border-bottom-width: 1px !important; // Alternative method for underlines
  }
  
  .navbar-nav .nav-link:hover,
  .navbar-nav .nav-link.active {
    border-bottom-width: 1px !important; // Ensure hover and active states are also thin
  }
  
  // Fix scroll offset for proper section highlighting
  html {
    scroll-padding-top: 60px; // Match navbar height for proper scroll positioning
  }
  
  // Remove glow effects from navbar in dark theme
  html body.dark .navbar-nav .nav-link,
  html body.dark .navbar-nav .nav-link:hover,
  html body.dark .navbar-nav .nav-link.active,
  html body.dark .navbar-nav .nav-link:focus {
    text-shadow: none !important; // Remove text glow/shadow
    box-shadow: none !important; // Remove any box shadow
  }
  
  html body.dark .navbar-nav .nav-link::after,
  html body.dark .navbar-nav .nav-link:hover::after,
  html body.dark .navbar-nav .nav-link.active::after {
    box-shadow: none !important; // Remove glow from underline bars
    text-shadow: none !important; // Remove any shadow effects
  }
  
  // Dark theme specific: Make ONLY active item underline thinner and darker
  html.dark body.dark .navbar-nav .nav-link.active::after,
  html.dark body.dark #navbar-content > ul > li > a.active::after,
  html.dark body.dark .nav-link.active::after,
  body.dark .navbar-nav .nav-link.active::after,
  body.dark #navbar-content > ul > li > a.active::after,
  body.dark .nav-link.active::after {
    height: 0.3px !important; // Make it even thinner
    background: none !important; // Remove existing background
    background-color: transparent !important; // Make background transparent
    background-image: none !important; // Remove any background image
    border: none !important; // Remove any border
    border-bottom: 0.3px solid #1f6a61 !important; // Darker aquamarine underline
    box-shadow: none !important; // Remove any glow/shadow effects
    text-shadow: none !important; // Remove text glow
    --nav-active: #1f6a61 !important; // Override the CSS variable locally
  }
  
  // Remove glow from active navbar text in dark theme
  html.dark body.dark .navbar-nav .nav-link.active,
  html.dark body.dark #navbar-content > ul > li > a.active,
  html.dark body.dark .nav-link.active,
  body.dark .navbar-nav .nav-link.active,
  body.dark #navbar-content > ul > li > a.active,
  body.dark .nav-link.active {
    box-shadow: none !important; // Remove glow from text
    text-shadow: none !important; // Remove text glow
  }
}

// Mobile and tablet toggle menu width adjustments
@media (max-width: 991px) {
  .navbar-collapse {
    max-width: calc(100% - 40px) !important; // Leave 20px margin on each side
    width: fit-content !important; // Use minimum necessary width
    min-width: 280px !important; // Ensure minimum usable width
  }
  
  // Only apply alignment when menu is actually collapsed and shown
  .navbar-collapse.show {
    margin-left: 0 !important; // Align with toggle icon
    margin-right: auto !important;
  }
  
  // Ensure navbar nav doesn't interfere when menu is shown
  .navbar-collapse.show .navbar-nav {
    margin-left: 0 !important;
    padding-left: 0 !important;
  }
}

// Tablet-specific adjustments (768px to 991px)
@media (min-width: 768px) and (max-width: 991px) {
  .navbar-collapse {
    max-width: 400px !important; // Limit width on tablets
    margin-left: 0 !important; // Align with toggle icon
    margin-right: auto !important;
  }
}

// Mobile-specific adjustments (below 768px)
@media (max-width: 767px) {
  .navbar-collapse {
    max-width: calc(100% - 30px) !important; // Leave 15px margin on each side
    margin-left: 0 !important; // Align with toggle icon
    margin-right: auto !important;
    min-width: 260px !important; // Smaller minimum width for mobile
  }
}

// Desktop: Smart word wrapping for section headings with moderate font size and reduced subtitle
@media (min-width: 992px) {
  // Adjust two-column layout: narrower left column (headings), wider right column (content)
  .home-section .col-lg-4 {
    flex: 0 0 30% !important;
    max-width: 30% !important;
  }
  
  .home-section .col-lg-8 {
    flex: 0 0 70% !important;
    max-width: 70% !important;
  }
  
  // Exception for bio section: keep original proportions
  #bio .col-lg-4 {
    flex: 0 0 33.333333% !important;
    max-width: 33.333333% !important;
  }
  
  #bio .col-lg-8 {
    flex: 0 0 66.666667% !important;
    max-width: 66.666667% !important;
  }
  
  // Add spacing within sections using padding on the container, not the section itself
  .home-section .container {
    padding-top: 1rem !important;
    padding-bottom: 1rem !important;
  }
  
  .section-heading h1,
  .section-heading h2, 
  .section-heading h3 {
    white-space: normal !important;
    word-break: keep-all !important;
    overflow-wrap: normal !important;
    hyphens: none !important;
    overflow: visible !important;
    line-height: 1.2 !important;
    max-width: 100% !important;
    padding-right: 1.5rem !important;
    margin: 0 !important;
    padding-top: 0 !important;
    padding-bottom: 0.5rem !important;
    margin-bottom: 1rem !important;
    font-size: 1.35em !important;
  }
  
  // Reduce subtitle size under section headings
  .section-heading p {
    font-size: 1.1rem !important;
  }
  
  .section-heading {
    overflow: visible !important;
    word-break: keep-all !important;
    padding-right: 1.5rem !important;
    margin-top: 0 !important;
    padding-top: 0 !important;
  }
}


// Create class to disable automatic bullet list formatting

.no-bullets {
  list-style-type: none;
  padding-left: 0; /* Optional: Removes the default list indentation */
}

// Collapsed code chunks styling - center the Expand/Collapse button
details summary {
  cursor: pointer !important;
  margin-bottom: 1rem !important;
  text-align: center !important;
  display: block !important;
  list-style: none !important;
  width: 100% !important;
  
  &::-webkit-details-marker {
    display: none !important;
  }
}

details[open] summary {
  margin-bottom: 0.5rem; // Slightly less margin when expanded
}

// Left-align only summary elements that contain code blocks (pre elements)
details:has(pre) summary {
  text-align: left !important;
}

// Add arrows to code block Expand/Collapse buttons
details:has(pre) summary::before {
  content: '';
  margin-right: 0.5em;
}

details:has(pre)[open] summary::before {
  content: '';
}

// Add margin above h2 headings
h2 {
  margin-top: 2rem;
}

// Lighten h1, h2, h3 headings on dark theme home page
body.dark h1,
body.dark h2,
body.dark h3 {
  color: #f0f0f0 !important;
}

// Force single column for publications widget compact view
#publication .col-12 {
  display: flex !important;
  flex-direction: column !important;
}

// Hide heading and border on desktop (min-width: 769px)
@media (min-width: 769px) {
  #publication .section-heading {
    border-bottom: none !important;
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }

  #publication .section-heading h1,
  #publication .section-heading h2,
  #publication .section-heading h3,
  #publication .col-12.section-heading,
  #publication .col-12.section-heading h1,
  div#publication .section-heading,
  div#publication .section-heading::after,
  div#publication .section-heading::before {
    display: none !important;
    border: none !important;
    border-bottom: none !important;
    border-image: none !important;
    border-image-source: none !important;
    background: none !important;
    background-image: none !important;
  }

  #publication .section-heading::after,
  #publication .col-12.section-heading::after {
    display: none !important;
    content: none !important;
    background: none !important;
    border: none !important;
  }
}

// Show heading without border on mobile (max-width: 768px)
@media (max-width: 768px) {
  #publication .section-heading h1,
  #publication .col-12.section-heading h1,
  div#publication .section-heading h1 {
    display: block !important;
    color: var(--text-secondary) !important;
    font-size: 2.25rem !important;
    margin: 0 0 10px 0 !important;
    padding-bottom: 10px !important;
  }
}

.col-12 .media.stream-item {
  display: flex !important;
  width: 100% !important;
  margin-bottom: 2rem !important;
}

// Reduce margin above first publication
.col-12 .media.stream-item:first-child {
  margin-top: 0 !important;
}

// Ensure media-body takes full width
.col-12 .media-body {
  flex: 1 !important;
}

// GitHub workflow button styling
.github-workflow-button {
  display: inline-block !important;
  padding: 0.75em 1.5em !important;
  background-color: #1565C0 !important;
  color: #ffffff !important;
  text-decoration: none !important;
  border-radius: 6px !important;
  font-weight: 600 !important;
  transition: all 0.3s !important;
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3) !important;
  border: 2px solid #0d47a1 !important;
  
  &:hover, &:focus, &:visited {
    background-color: #0d47a1 !important;
    color: #ffffff !important;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4) !important;
    transform: translateY(-2px) !important;
    text-decoration: none !important;
  }
}

// Dark theme - button should stay the same
body.dark .github-workflow-button {
  background-color: #1565C0 !important;
  color: #ffffff !important;
  border-color: #0d47a1 !important;
  
  &:hover, &:focus, &:visited {
    background-color: #0d47a1 !important;
    color: #ffffff !important;
  }
}

// Increase padding for pre elements with class 'text'
pre.text {
  padding: 0.8em !important;
}

// Image captions
p.caption {
  margin-top: 2%;
}

// Table captions
table caption {
  color: inherit;
}

// Multimedia section video sizing - maintain 16:9 aspect ratio
// Desktop: 50% width, centered
#multimedia > div > div > div > div[style*="position: relative"][style*="padding-top"] {
  width: 50% !important;
  padding-top: 28.125% !important; // 50% * 56.25% = 28.125% for 16:9 ratio
  margin-left: auto !important;
  margin-right: auto !important;
  margin-top: 10px !important;
  margin-bottom: 2rem !important;
}

// OSF iframe at bottom - centered (wider due to different aspect ratio)
#multimedia > div > div > div > iframe[src*="osf.io"] {
  display: block !important;
  width: 70% !important;
  height: 240px !important;
  margin-left: auto !important;
  margin-right: auto !important;
  text-align: center !important;
}

// Multimedia thumbnail image - match video sizing
.multimedia-thumbnail {
  width: 50%;
  margin-left: auto;
  margin-right: auto;
  
  img {
    width: 100%;
    height: auto;
    display: block;
  }
}

// Mobile: 90% width, centered
@media (max-width: 991px) {
  #profile > div:nth-child(3) > div {
    margin-top: 0.5rem !important;
    margin-bottom: 1rem !important;
  }

  #multimedia > div > div > div > div[style*="position: relative"][style*="padding-top"] {
    width: 90% !important;
    padding-top: 50.625% !important; // 90% * 56.25% = 50.625% for 16:9 ratio
    margin-left: auto !important;
    margin-right: auto !important;
    margin-top: 10px !important;
    margin-bottom: 2rem !important;
  }
  
  #multimedia > div > div > div > iframe[src*="osf.io"] {
    width: 90% !important;
  }
  
  .multimedia-thumbnail {
    width: 90%;
  }
}

/* Increase top padding in bio section */
#bio {
  padding-top: 3rem !important;
}

/* Ensure equal left and right padding in bio section columns */
#bio > div > div > div.col-12.col-lg-8 {
  padding-left: 15px !important;
  padding-right: 15px !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
}

@media (min-width: 992px) {
  #bio > div > div > div.col-12.col-lg-8 {
    max-width: 720px !important;
  }
  
  #bio > div > div > div.col-12.col-lg-8 > div.row {
    max-width: 800px !important;
    margin-right: 0 !important;
    padding-right: 0 !important;
  }
  
  #bio > div > div > div.col-12.col-lg-8 > div.row > div {
    padding-right: 0 !important;
    margin-right: 0 !important;
  }
  
  #profile > div:nth-child(5) > div > ul > div:nth-child(1) > div {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  #profile > div:nth-child(5) > div > ul > div:nth-child(1) > div > a {
    display: inline !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
}

#bio > div > div > div.col-12.col-lg-4 {
  padding-left: 0 !important;
  padding-right: 0 !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
}

@media (min-width: 1200px) {
  #bio > div > div > div.col-12.col-lg-4 {
    padding-left: 6rem !important;
  }
}

/* Ensure bio section row has no extra margins */
#bio > div > div {
  margin-left: 0 !important;
  margin-right: 0 !important;
}

/* Increase margin above publication filter controls */
.universal-wrapper .form-row.mb-4 {
  margin-top: 2rem !important;
}

/* Reduce margin above publication page container */
#top > div.container {
  margin-top: 0rem !important;
  padding-top: -1rem !important;
}

/* Remove left and right padding from container in mobile view on publications page */
@media (max-width: 991px) {
  body.page-publications #top > div.container {
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
}

/* Reduce margins around publication page title and align with search field */
#top > div.universal-wrapper.pt-3 > h1 {
  margin-top: 0.5rem !important;
  margin-bottom: 0.5rem !important;
  max-width: 760px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

/* Match paragraph alignment to h1 and add spacing */
#top > div.universal-wrapper.pt-3 > p {
  margin-left: auto !important;
  margin-right: auto !important;
  max-width: 760px !important;
  margin-top: 0 !important;
  margin-bottom: 1.5rem !important;
}

/* Increase bottom margin for paragraph on presentation page */
body.page-collection #top > div.universal-wrapper.pt-3 > p {
  margin-bottom: 2rem !important;
}

/* In mobile view, align heading left to match search field */
@media (max-width: 991px) {
  #top > div.universal-wrapper.pt-3 > h1 {
    margin-left: 0.75rem !important;
    margin-right: 0 !important;
    margin-top: 0 !important;
  }
  
  #top > div.universal-wrapper.pt-3 > p {
    margin-left: 0.75rem !important;
  }
  
  /* Reduce top margin for publication section heading in mobile */
  #publication > div > div > div.col-12.section-heading > h1 {
    margin-top: 0.15rem !important;
    visibility: visible !important;
    display: block !important;
    opacity: 1 !important;
  }
}

/* Expand search input in publication filters */
.universal-wrapper .form-row.mb-4 > div:nth-child(1) {
  flex: 0 1 auto !important;
  max-width: 320px !important;
  min-width: 150px !important;
}

/* Adjust publication metadata and button link font sizes */
#publication > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div {
  font-size: 0.8rem !important;
}

#publication > div > div > div:nth-child(2) > div > div.media-body > div.stream-meta.article-metadata > div > span:nth-child(1) > span {
  font-size: 0.9rem !important;
}

#publication > div > div > div:nth-child(2) > div > div.media-body > div.btn-links {
  font-size: 1.25rem !important;
}

/* Ultra-specific override to ensure font size applies */
body #publication > div > div > div:nth-child(2) > div > div.media-body > div.btn-links {
  font-size: 0.8rem !important;
  line-height: 1.3 !important;
}

body #publication > div > div > div:nth-child(2) > div > div.media-body > div.btn-links a,
body #publication > div > div > div:nth-child(2) > div > div.media-body > div.btn-links button {
  font-size: 0.8rem !important;
  line-height: 1.3 !important;
}

/* In mobile view, increase button links font size */
@media (max-width: 991px) {
  #publication > div > div > div:nth-child(2) > div > div.media-body > div.btn-links {
    font-size: 1.3rem !important;
  }
  
  body #publication > div > div > div:nth-child(2) > div > div.media-body > div.btn-links {
    font-size: 0.8rem !important;
    line-height: 1.3 !important;
  }
  
  body #publication > div > div > div:nth-child(2) > div > div.media-body > div.btn-links a,
  body #publication > div > div > div:nth-child(2) > div > div.media-body > div.btn-links button {
    font-size: 0.8rem !important;
    line-height: 1.3 !important;
  }
}

/* Remove left padding from search field in mobile view */
@media (max-width: 991px) {
  .universal-wrapper .form-row.mb-4 > div:nth-child(1) {
    padding-left: 0.75rem !important;
  }
}

.universal-wrapper .form-row.mb-4 .filter-search {
  width: 100% !important;
}

/* Reduce padding in filter dropdowns */
.universal-wrapper .form-row.mb-4 .pub-filters {
  padding-right: 0.5rem !important;
  min-width: 100px !important;
}

.universal-wrapper .form-row.mb-4 > div:nth-child(2),
.universal-wrapper .form-row.mb-4 > div:nth-child(3) {
  flex: 0 0 auto !important;
  padding-right: 0.25rem !important;
}

/* Search modal improvements - sticky elements with body scrollbar */

/* Change search from fixed modal to full-page overlay using body scroll */
.search-results {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: auto !important;
  min-height: 100vh !important;
  overflow: visible !important;
  z-index: 1031;
}

/* Allow body to scroll when search is open, but hide other content */
.searching {
  overflow: auto !important;
  position: static !important;
}

/* Hide all page content when search is open */
.searching > *:not(.search-results) {
  display: none !important;
}

/* Container with max-width and reduced top padding */
#search > div {
  max-width: 850px !important;
  margin: 0 auto 2rem auto !important;
  padding-top: 1rem !important;
  padding-bottom: 0 !important;
}

/* Make search header sticky to viewport */
#search > div > section.search-header {
  position: -webkit-sticky !important;
  position: sticky !important;
  top: 0 !important;
  z-index: 10 !important;
  background-color: #fff;
  padding: 0 !important;
  margin: 0 0 0.5rem 0 !important;
}

.dark #search > div > section.search-header {
  background-color: #282a36;
}

/* Reduce bottom padding in the row */
#search > div > section.search-header > div.row.no-gutters.justify-content-between.mb-3 {
  margin-bottom: 0.5rem !important;
}

/* Remove padding from search results section */
.section-search-results {
  padding: 0;
  margin: 0;
}

#search-hits {
  padding: 0;
  margin: 0 0 3rem 0;
}

/* Make the results count sticky to viewport */
#search-hits > p.search-results-count {
  position: -webkit-sticky !important;
  position: sticky !important;
  top: 3.5rem !important;
  background-color: #fff;
  z-index: 9;
  padding: 0.5rem 0;
  margin: 0 0 1rem 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.dark #search-hits > p.search-results-count {
  background-color: #282a36;
  border-bottom-color: rgba(255, 255, 255, 0.1);
}

// FORCE universal wrapper margin reduction - must be at end to override all other rules
html body #top > div.universal-wrapper.pt-3 {
  margin-bottom: -2.5rem !important;
}

// Increase margin under remark slides
body > div.remark-slides-area > div.remark-slide-container.has-continuation.remark-visible {
  margin-bottom: 2rem !important;
}

// Reduce margin above publication page content
#top > div.pub > div > div > div.col-md-10 > div {
  margin-top: 0 !important;
}

// Reduce top padding in article-container on presentation pages
body.page-wrapper .article-container {
  padding-top: 0.25rem !important;
}

// Decrease margin above first child in third div on presentation pages
#top > div.pub > div:nth-child(3) > div:nth-child(1) {
  margin-top: -1.5rem !important;
}

// Reduce top padding in third div on publication pages
#top > div.pub > div:nth-child(3) {
  padding-top: 0 !important;
  margin-top: -1.6rem !important;
}

// Reduce top padding in presentation page content
#top > div.pub > div:nth-child(2) {
  padding-top: 0.5rem !important;
}

// Increase margin above second child h3 on presentation pages
#top > div.pub > div:nth-child(2) > h3 {
  margin-top: 1rem !important;
}

// Increase margin above abstract heading on presentation pages
#abstract > h3 {
  margin-top: 2rem !important;
}

// Increase margin above third child h3 on presentation pages
#top > div.pub > div:nth-child(3) > h3 {
  margin-top: 1rem !important;
}

// Increase margin above btn-links on presentation pages
body.page-wrapper #top > div.pub > div.article-container.pt-3 > div.btn-links.mb-3 {
  margin-top: 1rem !important;
}

// Reduce margin under button in presentation page
#top > div.pub > div:nth-child(3) > div.article-style > a > button {
  margin-bottom: -1rem !important;
}

// Increase margin above featured image on presentation pages
.featured-image {
  margin-top: 1rem !important;
}

// Reduce margin above featured-image on applications-and-dashboards pages
.page-applications-and-dashboards .featured-image {
  margin-top: 0.25rem !important;
}

// Reduce height of mobile spacer on presentation pages
.d-md-none.space-below {
  height: 0 !important;
  margin-bottom: 0 !important;
  padding-bottom: 0 !important;
}

// Increase margin above publication section first child
#top > div:nth-child(4) > div:nth-child(1) {
  margin-top: 3rem !important;
}

// Increase margin above publication filter form
#top > div:nth-child(4) > div > div > div.form-row.mb-4 {
  margin-top: -1.5rem !important;
}

// Post page specific styles: increase article-metadata font size and reduce stream-item margin
.article-metadata,
.article-metadata * {
  font-size: 15px !important;
}

.media.stream-item {
  margin-bottom: 0.5rem !important;
}

// Desktop view: enforce max-width for entire page on tags/categories/presentation pages
@media (min-width: 992px) {
  body.page-collection #top .container {
    max-width: 750px !important;
    margin-left: auto !important;
    margin-right: auto !important;
  }
  
  body.page-taxonomy #top .container {
    max-width: none !important;
    margin-left: 8rem !important;
    margin-right: auto !important;
  }
  
  // Enforce max-width on taxonomy page content divs
  body.page-taxonomy #top > div:not(.container) {
    max-width: 750px !important;
  }
  
  body.page-taxonomy #top > div > div {
    max-width: 750px !important;
  }
  
  // Make taxonomy page titles bold - removed duplicate
  
  // Move content further in on tags and categories pages
  body.page-taxonomy #top > div.universal-wrapper.pt-3 > h1,
  body.page-taxonomy #top > div.universal-wrapper.pt-3 > p {
    margin-left: 0 !important;
  }
  
  body.page-taxonomy #top > div > div > h2 {
    margin-left: 0 !important;
  }
}

// Decrease spacing above superscript in article paragraphs
#top > article > div > div.article-style > p > sup {
  line-height: 0 !important;
  vertical-align: super !important;
  position: relative !important;
  top: -0.3em !important;
}

// Increase table header font size to match website font size
div > div > div > table > thead > tr > th {
  font-size: 1rem !important;
}

// Reduce bottom margin in teaching-supervision table
#teaching-supervision > div > div > div > table {
  margin-bottom: -1rem !important;
}

// Increase bottom margin in teaching-supervision heading
#teaching-supervision > div > div > div > h1 {
  margin-bottom: 1.5rem !important;
}