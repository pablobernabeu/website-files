{{ if not .IsHome }}
{{/* Only show tag cloud on individual pages, not the home page */}}
{{ $taxonomy := "tags" }}
{{ $fontSmall := 0.7 }}
{{ $fontBig := 1.0 }}
{{ $items_count := 30 }}

{{/* Query */}}
{{ $tags := first $items_count (index site.Taxonomies $taxonomy).ByCount }}
{{ $count := len $tags }}

{{ if ne $count 0 }}
<div class="footer-tag-cloud-section">
  <div class="container" style="max-width: 1000px;">
    <h4 style="text-align: center; margin-bottom: 1rem; opacity: 0.6; font-size: 0.9rem;">Common Topics</h4>
    
    {{ $fontDelta := sub $fontBig $fontSmall }}
    {{ $max := add (len (index $tags 0).Pages) 1 }}
    {{ $min := len (index ($tags).Reverse 0).Pages }}
    {{ $delta := sub $max $min }}

    <div class="tag-cloud footer-tag-cloud">
      {{ range $name, $term := (sort $tags ".Page.Title" "asc") }}
        {{ if ne .Page.Title "s" }}
          {{ $tagCount := len $term.Pages }}
          {{ $weight := div (sub (math.Log $tagCount) (math.Log $min)) (sub (math.Log $max) (math.Log $min)) }}
          {{ $fontSize := add $fontSmall (mul (sub $fontBig $fontSmall) $weight) }}
          <a href="{{ .Page.RelPermalink }}" style="font-size:{{ $fontSize }}rem" data-count="{{ $tagCount }}" data-tag="{{ .Page.Title }}">{{ .Page.Title | markdownify | emojify }}</a>
        {{ end }}
      {{ end }}
    </div>
  </div>
</div>

{{/* Load footer tag cloud highlighter script on individual pages */}}
<script src="{{ "js/footer-tag-cloud-highlight.js" | relURL }}"></script>

{{ end }}
{{ end }}

<footer class="site-footer">
  {{ if or (site.GetPage "terms.md") (site.GetPage "privacy.md") }}
  <p class="powered-by">
    {{ with site.GetPage "privacy.md" }}
      {{ printf "<a href=\"%s\">%s</a>" .RelPermalink .Title | safeHTML }}
    {{ end }}
    {{ with site.GetPage "terms.md" }}
      {{ if site.GetPage "privacy.md" }} &middot; {{ end }}
      {{ printf "<a href=\"%s\">%s</a>" .RelPermalink .Title | safeHTML }}
    {{ end }}
  </p>
  {{ end }}
  <p class="powered-by">
    {{ with site.Copyright }}{{ replace . "{year}" now.Year | markdownify}} &middot; {{ end }}

    Website powered by the <a href="https://themes.gohugo.io/themes/starter-hugo-academic" rel="noopener">Academic theme</a> for <a href="https://gohugo.io" rel="noopener">Hugo</a> and by <a href='https://github.com/rstudio/blogdown' rel="noopener">blogdown</a>.

    {{ if not (in (slice "docs" "updates") .Type) }}
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top" style="background-image:none;">
        <span class="button_icon" style="background-image:none;">
          <i class="fas fa-chevron-up fa-2x" style="background-image:none;"></i>
        </span>
      </a>
    </span>
    {{ end }}
  </p>
</footer>
