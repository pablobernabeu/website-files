{{ $page := . }} {{ $featured := (.Resources.ByType "image").GetMatch
"*featured*" }} {{ $anchor := $page.Params.image.focal_point | default "Smart"
}} {{/* Set default titles for node pages */}} {{ $title := .Title | markdownify
}} {{ if and (not $title) .IsNode }} {{ if eq .Type "post" }} {{ $title = i18n
"posts" }} {{ else if eq .Type "presentation" }} {{ $title = i18n
"presentations" }} {{ else if eq .Type "publication" }} {{ $title = i18n
"publications" }} {{end}} {{end}} {{/* Header image */}} {{ if and
.Params.header.image (not (and $featured (not .Params.image.preview_only))) }}
<div class="article-header">
  {{ $img_src := urls.Parse .Params.header.image }} {{ if $img_src.Scheme }}
  <img src="{{ .Params.header.image }}" class="article-banner" alt="" />
  {{ else }} <img src="{{ (printf "/img/%s" .Params.header.image) | relURL }}"
  class="article-banner" alt=""> {{ end }} {{ with .Params.header.caption }}
  <span class="article-header-caption">{{ . | markdownify | emojify }}</span>
  {{ end }}
</div>
{{end}} {{/* Featured image layout */}} {{ if and $featured (not
.Params.image.preview_only) }} {{/* Fit image within max size. */}} {{ $image :=
$featured }} {{/* Determine image placement. */}} {{ $placement :=
.Params.image.placement | default 1 }}{{/* Default to full column width. */}} {{
$image_container := "" }} {{ if eq $placement 2}} {{ $image_container =
"container" }} {{ if gt $featured.Width 1200 }} {{ $image = $featured.Resize
"1200x" }} {{ end }} {{else if eq $placement 3}} {{ $image_container =
"container-fluid" }} {{ $image := $featured.Fit "2560x2560" }} {{else}} {{
$image_container = "article-container" }} {{ if gt $featured.Width 720 }} {{
$image = $featured.Resize "720x" }} {{ end }} {{end}}

<div class="article-container pt-3">
  <h1>{{ $title | markdownify }}</h1>

  {{ with $page.Params.subtitle | markdownify }}
  <p class="page-subtitle">{{ . | markdownify | emojify }}</p>
  {{end}} {{ if eq $page.Type "publication" }} {{ $pub_types := slice
  "pub_uncat" "pub_conf" "pub_journal" "pub_preprint" "pub_report" "pub_book"
  "pub_book_section" "pub_thesis" "pub_patent" "pub_software" }} {{ $pub_icons
  := slice "fa-file" "fa-users" "fa-file-text" "fa-briefcase" "fa-briefcase"
  "fa-book" "fa-book" "fa-graduation-cap" "fa-lightbulb-o" "fa-code" }} {{
  $pub_classes := slice "pub-type-uncat" "pub-type-conf" "pub-type-journal"
  "pub-type-preprint" "pub-type-report" "pub-type-book" "pub-type-book-section"
  "pub-type-thesis" "pub-type-patent" "pub-type-software" }} {{ range $index,
  $type := $page.Params.publication_types }} {{ $pub_type := index $pub_types
  (int $type) }} {{ $pub_icon := index $pub_icons (int $type) }} {{ $pub_class
  := index $pub_classes (int $type) }}
  <span class="pub-type-badge {{ $pub_class }}">
    <i class="fa {{ $pub_icon }}"></i> {{ i18n $pub_type }}
  </span>
  {{ end }} {{ end }} {{ partial "page_metadata" (dict "page" $page "is_list" 0
  "share" true) }} {{ partial "page_links_div.html" $page }}
</div>

{{/* Featured image */}}
<div
  class="article-header {{$image_container}} featured-image-wrapper mt-4 mb-4"
  style="max-width: {{$image.Width}}px; max-height: {{$image.Height}}px;"
>
  <div style="position: relative">
    <img src="{{ $image.RelPermalink }}" alt="" class="featured-image" />
    {{ with $.Params.image.caption }}<span class="article-header-caption"
      >{{ . | markdownify | emojify }}</span
    >
    {{ end }}
  </div>
</div>
{{else}} {{/* Case when page has no image */}} {{/* Wider container for nodes
*/}} {{ $ctnr := "article-container" }} {{ if $page.IsNode }} {{ $ctnr =
"universal-wrapper" }} {{end}}

<div class="{{$ctnr}} pt-3">
  <h1>{{ $title | markdownify }}</h1>

  {{ with $page.Params.subtitle | markdownify }}
  <p class="page-subtitle">{{ . | markdownify | emojify }}</p>
  {{end}} {{ if eq $page.Type "publication" }} {{ $pub_types := slice
  "pub_uncat" "pub_conf" "pub_journal" "pub_preprint" "pub_report" "pub_book"
  "pub_book_section" "pub_thesis" "pub_patent" "pub_software" }} {{ $pub_icons
  := slice "fa-file" "fa-users" "fa-file-text" "fa-briefcase" "fa-briefcase"
  "fa-book" "fa-book" "fa-graduation-cap" "fa-lightbulb-o" "fa-code" }} {{
  $pub_classes := slice "pub-type-uncat" "pub-type-conf" "pub-type-journal"
  "pub-type-preprint" "pub-type-report" "pub-type-book" "pub-type-book-section"
  "pub-type-thesis" "pub-type-patent" "pub-type-software" }} {{ range $index,
  $type := $page.Params.publication_types }} {{ $pub_type := index $pub_types
  (int $type) }} {{ $pub_icon := index $pub_icons (int $type) }} {{ $pub_class
  := index $pub_classes (int $type) }}
  <span class="pub-type-badge {{ $pub_class }}">
    <i class="fa {{ $pub_icon }}"></i> {{ i18n $pub_type }}
  </span>
  {{ end }} {{ end }} {{ if not .IsNode }} {{ partial "page_metadata" (dict
  "page" $page "is_list" 0 "share" true) }} {{ partial "page_links_div.html"
  $page }} {{end}}
</div>
{{end}}
